% Apéndice: Código Fuente del API Gateway
% Sistema de Control de Ascensores - TFG

\appendix
\chapter{Código Fuente del API Gateway}

\section{Introducción}

Este apéndice contiene la documentación completa del código fuente del API Gateway del sistema de control de ascensores. El API Gateway actúa como intermediario entre los controladores CAN de ascensores y el servidor central, implementando un puente CoAP-CAN con gestión de estado local.

\section{Estructuras de Datos}

\subsection{Estructura api\_request\_details\_for\_json\_t}
\doxysection{api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t Struct Reference}
\label{structapi__request__details__for__json__t}\index{api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}}


Detalles específicos de solicitud para serialización JSON.  




{\ttfamily \#include $<$elevator\+\_\+state\+\_\+manager.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
int \textbf{ origin\+\_\+floor\+\_\+fc}
\begin{DoxyCompactList}\small\item\em Piso origen de la llamada. \end{DoxyCompactList}\item 
\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} \textbf{ direction\+\_\+fc}
\begin{DoxyCompactList}\small\item\em Dirección solicitada. \end{DoxyCompactList}\item 
char \textbf{ requesting\+\_\+elevator\+\_\+id\+\_\+cr} [ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]
\begin{DoxyCompactList}\small\item\em ID del ascensor solicitante. \end{DoxyCompactList}\item 
int \textbf{ target\+\_\+floor\+\_\+cr}
\begin{DoxyCompactList}\small\item\em Piso destino solicitado. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Detalles específicos de solicitud para serialización JSON. 

Estructura que contiene información específica del tipo de solicitud para incluir en el payload JSON enviado al servidor central. 

\doxysubsection{Field Documentation}
\label{structapi__request__details__for__json__t_a755ca73e0c1100a922b1807430bab380} 
\index{api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}!direction\_fc@{direction\_fc}}
\index{direction\_fc@{direction\_fc}!api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}}
\doxysubsubsection{direction\_fc}
{\footnotesize\ttfamily \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t\+::direction\+\_\+fc}



Dirección solicitada. 

\label{structapi__request__details__for__json__t_aa6deb8d9a249b48418e6c8fe363d2a97} 
\index{api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}!origin\_floor\_fc@{origin\_floor\_fc}}
\index{origin\_floor\_fc@{origin\_floor\_fc}!api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}}
\doxysubsubsection{origin\_floor\_fc}
{\footnotesize\ttfamily int api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t\+::origin\+\_\+floor\+\_\+fc}



Piso origen de la llamada. 

\label{structapi__request__details__for__json__t_a7bbe3dd6e1f18a3d33353f5583a290e3} 
\index{api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}!requesting\_elevator\_id\_cr@{requesting\_elevator\_id\_cr}}
\index{requesting\_elevator\_id\_cr@{requesting\_elevator\_id\_cr}!api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}}
\doxysubsubsection{requesting\_elevator\_id\_cr}
{\footnotesize\ttfamily char api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t\+::requesting\+\_\+elevator\+\_\+id\+\_\+cr[ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]}



ID del ascensor solicitante. 

\label{structapi__request__details__for__json__t_ac591aee00a7f6cc6098a23343fb913a7} 
\index{api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}!target\_floor\_cr@{target\_floor\_cr}}
\index{target\_floor\_cr@{target\_floor\_cr}!api\_request\_details\_for\_json\_t@{api\_request\_details\_for\_json\_t}}
\doxysubsubsection{target\_floor\_cr}
{\footnotesize\ttfamily int api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t\+::target\+\_\+floor\+\_\+cr}



Piso destino solicitado. 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ elevator\+\_\+state\+\_\+manager.\+h}\end{DoxyCompactItemize}

\subsection{Estructura api\_request\_tracker\_t}
\doxysection{api\+\_\+request\+\_\+tracker\+\_\+t Struct Reference}
\label{structapi__request__tracker__t}\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}}


Tracks information from an original client (elevator) request OR a gateway-\/originated request.  




{\ttfamily \#include $<$api\+\_\+handlers.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
coap\+\_\+session\+\_\+t $\ast$ \textbf{ original\+\_\+elevator\+\_\+session}
\item 
coap\+\_\+binary\+\_\+t \textbf{ original\+\_\+token}
\item 
coap\+\_\+mid\+\_\+t \textbf{ original\+\_\+mid}
\item 
char $\ast$ \textbf{ log\+\_\+tag}
\item 
\textbf{ gw\+\_\+request\+\_\+type\+\_\+t} \textbf{ request\+\_\+type}
\item 
int \textbf{ origin\+\_\+floor}
\item 
int \textbf{ target\+\_\+floor\+\_\+for\+\_\+task}
\item 
char \textbf{ requesting\+\_\+elevator\+\_\+id\+\_\+cabin} [ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]
\item 
\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} \textbf{ requested\+\_\+direction\+\_\+floor}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Tracks information from an original client (elevator) request OR a gateway-\/originated request. 

Structure to track client requests forwarded to the central server.

This structure is used to maintain state across the two-\/stage request process\+:
\begin{DoxyEnumerate}
\item Event (simulated client or internal) -\/$>$ Gateway
\item Gateway -\/$>$ Central Server It allows the Gateway to correctly respond to the original client (if any) or update its internal state after receiving a response from the Central Server.
\end{DoxyEnumerate}

This structure holds information about an original client request that the API Gateway has forwarded to the central server. It is used to correlate the server\textquotesingle{}s response back to the original client session and to manage state or context related to the request. 

\doxysubsection{Field Documentation}
\label{structapi__request__tracker__t_a7dedbf9877ab11f2146a8e0c6c473338} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!log\_tag@{log\_tag}}
\index{log\_tag@{log\_tag}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{log\_tag}
{\footnotesize\ttfamily char $\ast$ api\+\_\+request\+\_\+tracker\+\_\+t\+::log\+\_\+tag}

Tag for logging (e.\+g., "{}\+Floor\+Call"{}, duplicated).

Tag for logging purposes (dynamically allocated). \label{structapi__request__tracker__t_a9d4a410aec38df7b2d83047536dfb752} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!origin\_floor@{origin\_floor}}
\index{origin\_floor@{origin\_floor}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{origin\_floor}
{\footnotesize\ttfamily int api\+\_\+request\+\_\+tracker\+\_\+t\+::origin\+\_\+floor}

Piso origen (para GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+FLOOR\+\_\+\+CALL).

For floor calls\+: the floor where the call originated. \label{structapi__request__tracker__t_a9885efb27daf04678758e409ef77019c} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!original\_elevator\_session@{original\_elevator\_session}}
\index{original\_elevator\_session@{original\_elevator\_session}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{original\_elevator\_session}
{\footnotesize\ttfamily coap\+\_\+session\+\_\+t $\ast$ api\+\_\+request\+\_\+tracker\+\_\+t\+::original\+\_\+elevator\+\_\+session}

The Co\+AP session with the original elevator client (NULL if gateway-\/originated internal event).

Session of the original elevator client. \label{structapi__request__tracker__t_abe0bf810ed9964f982d1f5e3a4b497e8} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!original\_mid@{original\_mid}}
\index{original\_mid@{original\_mid}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{original\_mid}
{\footnotesize\ttfamily coap\+\_\+mid\+\_\+t api\+\_\+request\+\_\+tracker\+\_\+t\+::original\+\_\+mid}

The Co\+AP Message ID from the original client\textquotesingle{}s request.

Co\+AP Message ID of the original request. \label{structapi__request__tracker__t_a7e5317a8b95d407c149ccdd60cd372fc} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!original\_token@{original\_token}}
\index{original\_token@{original\_token}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{original\_token}
{\footnotesize\ttfamily coap\+\_\+binary\+\_\+t api\+\_\+request\+\_\+tracker\+\_\+t\+::original\+\_\+token}

The Co\+AP token from the original client\textquotesingle{}s request (duplicated).

Co\+AP token of the original request (dynamically allocated). \label{structapi__request__tracker__t_aa0ae033ab8b943e54859a6893ca8219b} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!request\_type@{request\_type}}
\index{request\_type@{request\_type}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{request\_type}
{\footnotesize\ttfamily \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} api\+\_\+request\+\_\+tracker\+\_\+t\+::request\+\_\+type}

Tipo de solicitud gestionada por el gateway.

Type of the original request. \label{structapi__request__tracker__t_ad3eec01d02700d0e57b8b8d3b3ad4056} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!requested\_direction\_floor@{requested\_direction\_floor}}
\index{requested\_direction\_floor@{requested\_direction\_floor}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{requested\_direction\_floor}
{\footnotesize\ttfamily \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} api\+\_\+request\+\_\+tracker\+\_\+t\+::requested\+\_\+direction\+\_\+floor}

Dirección solicitada (para GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+FLOOR\+\_\+\+CALL).

For floor calls\+: UP/\+DOWN. \label{structapi__request__tracker__t_a5a5ed9757a5cd16ffca9beed256e9d02} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!requesting\_elevator\_id\_cabin@{requesting\_elevator\_id\_cabin}}
\index{requesting\_elevator\_id\_cabin@{requesting\_elevator\_id\_cabin}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{requesting\_elevator\_id\_cabin}
{\footnotesize\ttfamily char api\+\_\+request\+\_\+tracker\+\_\+t\+::requesting\+\_\+elevator\+\_\+id\+\_\+cabin}

ID del ascensor (para GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+CABIN\+\_\+\+REQUEST).

For cabin requests\+: ID of the elevator. \label{structapi__request__tracker__t_a1bd9169adbdf0519f73f673f00c90ef0} 
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!target\_floor\_for\_task@{target\_floor\_for\_task}}
\index{target\_floor\_for\_task@{target\_floor\_for\_task}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\doxysubsubsection{target\_floor\_for\_task}
{\footnotesize\ttfamily int api\+\_\+request\+\_\+tracker\+\_\+t\+::target\+\_\+floor\+\_\+for\+\_\+task}

Piso destino para la tarea a asignar (puede ser piso\+\_\+origen para floor\+\_\+call o destino\+\_\+cabina para cabin\+\_\+request).

The floor the assigned elevator should go to. 

The documentation for this struct was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/\textbf{ api\+\_\+handlers.\+h}\item 
include/api\+\_\+gateway/\textbf{ api\+\_\+handlers.\+h}\end{DoxyCompactItemize}

\subsection{Estructura can\_origin\_tracker\_t}
\doxysection{can\+\_\+origin\+\_\+tracker\+\_\+t Struct Reference}
\label{structcan__origin__tracker__t}\index{can\_origin\_tracker\_t@{can\_origin\_tracker\_t}}


Tracker para correlacionar solicitudes CAN con respuestas Co\+AP.  




{\ttfamily \#include $<$can\+\_\+bridge.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
coap\+\_\+binary\+\_\+t \textbf{ coap\+\_\+token}
\begin{DoxyCompactList}\small\item\em Token de la solicitud Co\+AP enviada al servidor central. \end{DoxyCompactList}\item 
uint32\+\_\+t \textbf{ original\+\_\+can\+\_\+id}
\begin{DoxyCompactList}\small\item\em ID del frame CAN original que originó la solicitud. \end{DoxyCompactList}\item 
\textbf{ gw\+\_\+request\+\_\+type\+\_\+t} \textbf{ request\+\_\+type}
\begin{DoxyCompactList}\small\item\em Tipo de solicitud original (floor call, cabin request) \end{DoxyCompactList}\item 
int \textbf{ target\+\_\+floor\+\_\+for\+\_\+task}
\begin{DoxyCompactList}\small\item\em Piso destino de la tarea asignada. \end{DoxyCompactList}\item 
int \textbf{ call\+\_\+reference\+\_\+floor}
\begin{DoxyCompactList}\small\item\em Piso origen de la llamada (para floor calls) \end{DoxyCompactList}\item 
char \textbf{ requesting\+\_\+elevator\+\_\+id\+\_\+if\+\_\+cabin} [ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]
\begin{DoxyCompactList}\small\item\em ID del ascensor si fue cabin request. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Tracker para correlacionar solicitudes CAN con respuestas Co\+AP. 

Estructura utilizada para asociar un token Co\+AP de una solicitud enviada al servidor central con la información original del frame CAN que la originó. Permite correlacionar respuestas para enviar confirmaciones apropiadas vía CAN. 

\doxysubsection{Field Documentation}
\label{structcan__origin__tracker__t_a12cab7216a9ad7e701d5d34b6257c179} 
\index{can\_origin\_tracker\_t@{can\_origin\_tracker\_t}!call\_reference\_floor@{call\_reference\_floor}}
\index{call\_reference\_floor@{call\_reference\_floor}!can\_origin\_tracker\_t@{can\_origin\_tracker\_t}}
\doxysubsubsection{call\_reference\_floor}
{\footnotesize\ttfamily int can\+\_\+origin\+\_\+tracker\+\_\+t\+::call\+\_\+reference\+\_\+floor}



Piso origen de la llamada (para floor calls) 

\label{structcan__origin__tracker__t_a71fae8a9747dd2111516c79178c67562} 
\index{can\_origin\_tracker\_t@{can\_origin\_tracker\_t}!coap\_token@{coap\_token}}
\index{coap\_token@{coap\_token}!can\_origin\_tracker\_t@{can\_origin\_tracker\_t}}
\doxysubsubsection{coap\_token}
{\footnotesize\ttfamily coap\+\_\+binary\+\_\+t can\+\_\+origin\+\_\+tracker\+\_\+t\+::coap\+\_\+token}



Token de la solicitud Co\+AP enviada al servidor central. 

\label{structcan__origin__tracker__t_aa73a054e696a24931ba16ea543fbdd2f} 
\index{can\_origin\_tracker\_t@{can\_origin\_tracker\_t}!original\_can\_id@{original\_can\_id}}
\index{original\_can\_id@{original\_can\_id}!can\_origin\_tracker\_t@{can\_origin\_tracker\_t}}
\doxysubsubsection{original\_can\_id}
{\footnotesize\ttfamily uint32\+\_\+t can\+\_\+origin\+\_\+tracker\+\_\+t\+::original\+\_\+can\+\_\+id}



ID del frame CAN original que originó la solicitud. 

\label{structcan__origin__tracker__t_aa62b425f082bbe1eb9f9c02f08427064} 
\index{can\_origin\_tracker\_t@{can\_origin\_tracker\_t}!request\_type@{request\_type}}
\index{request\_type@{request\_type}!can\_origin\_tracker\_t@{can\_origin\_tracker\_t}}
\doxysubsubsection{request\_type}
{\footnotesize\ttfamily \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} can\+\_\+origin\+\_\+tracker\+\_\+t\+::request\+\_\+type}



Tipo de solicitud original (floor call, cabin request) 

\label{structcan__origin__tracker__t_aec30cc82e2e764d7da2337c6d1a287ac} 
\index{can\_origin\_tracker\_t@{can\_origin\_tracker\_t}!requesting\_elevator\_id\_if\_cabin@{requesting\_elevator\_id\_if\_cabin}}
\index{requesting\_elevator\_id\_if\_cabin@{requesting\_elevator\_id\_if\_cabin}!can\_origin\_tracker\_t@{can\_origin\_tracker\_t}}
\doxysubsubsection{requesting\_elevator\_id\_if\_cabin}
{\footnotesize\ttfamily char can\+\_\+origin\+\_\+tracker\+\_\+t\+::requesting\+\_\+elevator\+\_\+id\+\_\+if\+\_\+cabin[ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]}



ID del ascensor si fue cabin request. 

\label{structcan__origin__tracker__t_a48cfc39dc425d95712a52651e4d9e35e} 
\index{can\_origin\_tracker\_t@{can\_origin\_tracker\_t}!target\_floor\_for\_task@{target\_floor\_for\_task}}
\index{target\_floor\_for\_task@{target\_floor\_for\_task}!can\_origin\_tracker\_t@{can\_origin\_tracker\_t}}
\doxysubsubsection{target\_floor\_for\_task}
{\footnotesize\ttfamily int can\+\_\+origin\+\_\+tracker\+\_\+t\+::target\+\_\+floor\+\_\+for\+\_\+task}



Piso destino de la tarea asignada. 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ can\+\_\+bridge.\+h}\end{DoxyCompactItemize}

\subsection{Estructura central\_request\_entry\_t}
\doxysection{central\+\_\+request\+\_\+entry\+\_\+t Struct Reference}
\label{structcentral__request__entry__t}\index{central\_request\_entry\_t@{central\_request\_entry\_t}}


Entrada de tracker para solicitudes al servidor central.  


\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
coap\+\_\+bin\+\_\+const\+\_\+t \textbf{ token}
\begin{DoxyCompactList}\small\item\em Token de la solicitud enviada AL SERVIDOR CENTRAL. \end{DoxyCompactList}\item 
\textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} $\ast$ \textbf{ tracker\+\_\+data}
\begin{DoxyCompactList}\small\item\em Datos del tracker original (sesión del ascensor, token original, etc.) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Entrada de tracker para solicitudes al servidor central. 

Estructura que asocia un token de solicitud enviada al servidor central con los datos del tracker original que contiene información de la solicitud inicial del ascensor. 

\doxysubsection{Field Documentation}
\label{structcentral__request__entry__t_a9474ef22121d12f2fb36f5a04a51e13e} 
\index{central\_request\_entry\_t@{central\_request\_entry\_t}!token@{token}}
\index{token@{token}!central\_request\_entry\_t@{central\_request\_entry\_t}}
\doxysubsubsection{token}
{\footnotesize\ttfamily coap\+\_\+bin\+\_\+const\+\_\+t central\+\_\+request\+\_\+entry\+\_\+t\+::token}



Token de la solicitud enviada AL SERVIDOR CENTRAL. 

\label{structcentral__request__entry__t_a57b3f1998fabe30576895678aaaecbf1} 
\index{central\_request\_entry\_t@{central\_request\_entry\_t}!tracker\_data@{tracker\_data}}
\index{tracker\_data@{tracker\_data}!central\_request\_entry\_t@{central\_request\_entry\_t}}
\doxysubsubsection{tracker\_data}
{\footnotesize\ttfamily \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t}$\ast$ central\+\_\+request\+\_\+entry\+\_\+t\+::tracker\+\_\+data}



Datos del tracker original (sesión del ascensor, token original, etc.) 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/\textbf{ api\+\_\+handlers.\+c}\end{DoxyCompactItemize}

\subsection{Estructura datos\_simulacion\_t}
\doxysection{datos\+\_\+simulacion\+\_\+t Struct Reference}
\label{structdatos__simulacion__t}\index{datos\_simulacion\_t@{datos\_simulacion\_t}}


Estructura principal de datos de simulación.  




{\ttfamily \#include $<$simulation\+\_\+loader.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$ \textbf{ edificios}
\item 
int \textbf{ num\+\_\+edificios}
\item 
bool \textbf{ datos\+\_\+cargados}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estructura principal de datos de simulación. 

Contiene todos los edificios cargados desde el archivo JSON y proporciona acceso a los datos de simulación. 

\doxysubsection{Field Documentation}
\label{structdatos__simulacion__t_ac965216d08f1e2b1024856c2756fc721} 
\index{datos\_simulacion\_t@{datos\_simulacion\_t}!datos\_cargados@{datos\_cargados}}
\index{datos\_cargados@{datos\_cargados}!datos\_simulacion\_t@{datos\_simulacion\_t}}
\doxysubsubsection{datos\_cargados}
{\footnotesize\ttfamily bool datos\+\_\+simulacion\+\_\+t\+::datos\+\_\+cargados}

Indica si los datos fueron cargados correctamente \label{structdatos__simulacion__t_a8ec4a560411e2124956ad7b750658beb} 
\index{datos\_simulacion\_t@{datos\_simulacion\_t}!edificios@{edificios}}
\index{edificios@{edificios}!datos\_simulacion\_t@{datos\_simulacion\_t}}
\doxysubsubsection{edificios}
{\footnotesize\ttfamily \textbf{ edificio\+\_\+simulacion\+\_\+t}$\ast$ datos\+\_\+simulacion\+\_\+t\+::edificios}

Array de edificios \label{structdatos__simulacion__t_a5fcd53e2053293c3e262743b0ed2654c} 
\index{datos\_simulacion\_t@{datos\_simulacion\_t}!num\_edificios@{num\_edificios}}
\index{num\_edificios@{num\_edificios}!datos\_simulacion\_t@{datos\_simulacion\_t}}
\doxysubsubsection{num\_edificios}
{\footnotesize\ttfamily int datos\+\_\+simulacion\+\_\+t\+::num\+\_\+edificios}

Número total de edificios 

The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ simulation\+\_\+loader.\+h}\end{DoxyCompactItemize}

\subsection{Estructura edificio\_simulacion\_t}
\doxysection{edificio\+\_\+simulacion\+\_\+t Struct Reference}
\label{structedificio__simulacion__t}\index{edificio\_simulacion\_t@{edificio\_simulacion\_t}}


Estructura para un edificio de simulación.  




{\ttfamily \#include $<$simulation\+\_\+loader.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
char \textbf{ id\+\_\+edificio} [16]
\item 
\textbf{ peticion\+\_\+simulacion\+\_\+t} $\ast$ \textbf{ peticiones}
\item 
int \textbf{ num\+\_\+peticiones}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estructura para un edificio de simulación. 

Representa un edificio completo con su ID único y conjunto de peticiones asociadas. 

\doxysubsection{Field Documentation}
\label{structedificio__simulacion__t_adcd146ebef8d2fd63bf07b857975f659} 
\index{edificio\_simulacion\_t@{edificio\_simulacion\_t}!id\_edificio@{id\_edificio}}
\index{id\_edificio@{id\_edificio}!edificio\_simulacion\_t@{edificio\_simulacion\_t}}
\doxysubsubsection{id\_edificio}
{\footnotesize\ttfamily char edificio\+\_\+simulacion\+\_\+t\+::id\+\_\+edificio[16]}

ID único del edificio (ej\+: "{}\+E001"{}) \label{structedificio__simulacion__t_a006872e2888145ee182e18284dbbd888} 
\index{edificio\_simulacion\_t@{edificio\_simulacion\_t}!num\_peticiones@{num\_peticiones}}
\index{num\_peticiones@{num\_peticiones}!edificio\_simulacion\_t@{edificio\_simulacion\_t}}
\doxysubsubsection{num\_peticiones}
{\footnotesize\ttfamily int edificio\+\_\+simulacion\+\_\+t\+::num\+\_\+peticiones}

Número de peticiones en el array \label{structedificio__simulacion__t_a893291e6f57a864ccab3f6575fa9a72f} 
\index{edificio\_simulacion\_t@{edificio\_simulacion\_t}!peticiones@{peticiones}}
\index{peticiones@{peticiones}!edificio\_simulacion\_t@{edificio\_simulacion\_t}}
\doxysubsubsection{peticiones}
{\footnotesize\ttfamily \textbf{ peticion\+\_\+simulacion\+\_\+t}$\ast$ edificio\+\_\+simulacion\+\_\+t\+::peticiones}

Array de peticiones 

The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ simulation\+\_\+loader.\+h}\end{DoxyCompactItemize}

\subsection{Estructura elevator\_group\_state\_t}
\doxysection{elevator\+\_\+group\+\_\+state\+\_\+t Struct Reference}
\label{structelevator__group__state__t}\index{elevator\_group\_state\_t@{elevator\_group\_state\_t}}


Estado del grupo de ascensores gestionado por el gateway.  




{\ttfamily \#include $<$elevator\+\_\+state\+\_\+manager.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\textbf{ elevator\+\_\+status\+\_\+t} \textbf{ ascensores} [MAX\+\_\+\+ELEVATORS\+\_\+\+PER\+\_\+\+GATEWAY]
\begin{DoxyCompactList}\small\item\em Array de ascensores del grupo. \end{DoxyCompactList}\item 
int \textbf{ num\+\_\+elevadores\+\_\+en\+\_\+grupo}
\begin{DoxyCompactList}\small\item\em Número de ascensores en el grupo. \end{DoxyCompactList}\item 
char \textbf{ edificio\+\_\+id\+\_\+str\+\_\+grupo} [ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]
\begin{DoxyCompactList}\small\item\em ID del edificio gestionado. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estado del grupo de ascensores gestionado por el gateway. 

Estructura que contiene el estado completo de todos los ascensores de un edificio gestionados por un API Gateway específico. 

\doxysubsection{Field Documentation}
\label{structelevator__group__state__t_a861616009ae11edc19d27d107c6580ac} 
\index{elevator\_group\_state\_t@{elevator\_group\_state\_t}!ascensores@{ascensores}}
\index{ascensores@{ascensores}!elevator\_group\_state\_t@{elevator\_group\_state\_t}}
\doxysubsubsection{ascensores}
{\footnotesize\ttfamily \textbf{ elevator\+\_\+status\+\_\+t} elevator\+\_\+group\+\_\+state\+\_\+t\+::ascensores[MAX\+\_\+\+ELEVATORS\+\_\+\+PER\+\_\+\+GATEWAY]}



Array de ascensores del grupo. 

\label{structelevator__group__state__t_a809113c3e567fe85c8b8ae2a4d3e1c6a} 
\index{elevator\_group\_state\_t@{elevator\_group\_state\_t}!edificio\_id\_str\_grupo@{edificio\_id\_str\_grupo}}
\index{edificio\_id\_str\_grupo@{edificio\_id\_str\_grupo}!elevator\_group\_state\_t@{elevator\_group\_state\_t}}
\doxysubsubsection{edificio\_id\_str\_grupo}
{\footnotesize\ttfamily char elevator\+\_\+group\+\_\+state\+\_\+t\+::edificio\+\_\+id\+\_\+str\+\_\+grupo[ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]}



ID del edificio gestionado. 

\label{structelevator__group__state__t_aa27a1033993ce97ba6d38702efad36df} 
\index{elevator\_group\_state\_t@{elevator\_group\_state\_t}!num\_elevadores\_en\_grupo@{num\_elevadores\_en\_grupo}}
\index{num\_elevadores\_en\_grupo@{num\_elevadores\_en\_grupo}!elevator\_group\_state\_t@{elevator\_group\_state\_t}}
\doxysubsubsection{num\_elevadores\_en\_grupo}
{\footnotesize\ttfamily int elevator\+\_\+group\+\_\+state\+\_\+t\+::num\+\_\+elevadores\+\_\+en\+\_\+grupo}



Número de ascensores en el grupo. 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ elevator\+\_\+state\+\_\+manager.\+h}\end{DoxyCompactItemize}

\subsection{Estructura elevator\_status\_t}
\doxysection{elevator\+\_\+status\+\_\+t Struct Reference}
\label{structelevator__status__t}\index{elevator\_status\_t@{elevator\_status\_t}}


Estado de un ascensor individual.  




{\ttfamily \#include $<$elevator\+\_\+state\+\_\+manager.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
char \textbf{ ascensor\+\_\+id} [ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]
\begin{DoxyCompactList}\small\item\em ID único del ascensor (ej\+: "{}\+E1\+A1"{}) \end{DoxyCompactList}\item 
char \textbf{ id\+\_\+edificio\+\_\+str} [ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]
\begin{DoxyCompactList}\small\item\em ID del edificio (ej\+: "{}\+E1"{}) \end{DoxyCompactList}\item 
int \textbf{ piso\+\_\+actual}
\begin{DoxyCompactList}\small\item\em Piso actual del ascensor. \end{DoxyCompactList}\item 
\textbf{ door\+\_\+state\+\_\+enum\+\_\+t} \textbf{ estado\+\_\+puerta\+\_\+enum}
\begin{DoxyCompactList}\small\item\em Estado actual de las puertas. \end{DoxyCompactList}\item 
char \textbf{ tarea\+\_\+actual\+\_\+id} [TASK\+\_\+\+ID\+\_\+\+MAX\+\_\+\+LEN]
\begin{DoxyCompactList}\small\item\em ID de la tarea asignada por el servidor central. \end{DoxyCompactList}\item 
int \textbf{ destino\+\_\+actual}
\begin{DoxyCompactList}\small\item\em Piso objetivo de la tarea actual (-\/1 si no hay) \end{DoxyCompactList}\item 
\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} \textbf{ direccion\+\_\+movimiento\+\_\+enum}
\begin{DoxyCompactList}\small\item\em Dirección de movimiento actual. \end{DoxyCompactList}\item 
bool \textbf{ ocupado}
\begin{DoxyCompactList}\small\item\em True si el ascensor está asignado a una tarea. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estado de un ascensor individual. 

Estructura que contiene toda la información de estado de un ascensor específico gestionado por el gateway. 

\doxysubsection{Field Documentation}
\label{structelevator__status__t_a88500363ecd33946d161639695642c09} 
\index{elevator\_status\_t@{elevator\_status\_t}!ascensor\_id@{ascensor\_id}}
\index{ascensor\_id@{ascensor\_id}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{ascensor\_id}
{\footnotesize\ttfamily char elevator\+\_\+status\+\_\+t\+::ascensor\+\_\+id[ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]}



ID único del ascensor (ej\+: "{}\+E1\+A1"{}) 

\label{structelevator__status__t_ac3e6ab573c29b113f73e1aa04bd3ce24} 
\index{elevator\_status\_t@{elevator\_status\_t}!destino\_actual@{destino\_actual}}
\index{destino\_actual@{destino\_actual}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{destino\_actual}
{\footnotesize\ttfamily int elevator\+\_\+status\+\_\+t\+::destino\+\_\+actual}



Piso objetivo de la tarea actual (-\/1 si no hay) 

\label{structelevator__status__t_a581bb8e8bb5d5d3f33b441d36144d777} 
\index{elevator\_status\_t@{elevator\_status\_t}!direccion\_movimiento\_enum@{direccion\_movimiento\_enum}}
\index{direccion\_movimiento\_enum@{direccion\_movimiento\_enum}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{direccion\_movimiento\_enum}
{\footnotesize\ttfamily \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} elevator\+\_\+status\+\_\+t\+::direccion\+\_\+movimiento\+\_\+enum}



Dirección de movimiento actual. 

\label{structelevator__status__t_a4cd0c76f4af9bc0205d675e4d00c76c9} 
\index{elevator\_status\_t@{elevator\_status\_t}!estado\_puerta\_enum@{estado\_puerta\_enum}}
\index{estado\_puerta\_enum@{estado\_puerta\_enum}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{estado\_puerta\_enum}
{\footnotesize\ttfamily \textbf{ door\+\_\+state\+\_\+enum\+\_\+t} elevator\+\_\+status\+\_\+t\+::estado\+\_\+puerta\+\_\+enum}



Estado actual de las puertas. 

\label{structelevator__status__t_aaa0fdf13b2c062317213c9e79be213ee} 
\index{elevator\_status\_t@{elevator\_status\_t}!id\_edificio\_str@{id\_edificio\_str}}
\index{id\_edificio\_str@{id\_edificio\_str}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{id\_edificio\_str}
{\footnotesize\ttfamily char elevator\+\_\+status\+\_\+t\+::id\+\_\+edificio\+\_\+str[ID\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+LEN]}



ID del edificio (ej\+: "{}\+E1"{}) 

\label{structelevator__status__t_aa2ac2a2b47927caccfb9978a8e329786} 
\index{elevator\_status\_t@{elevator\_status\_t}!ocupado@{ocupado}}
\index{ocupado@{ocupado}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{ocupado}
{\footnotesize\ttfamily bool elevator\+\_\+status\+\_\+t\+::ocupado}



True si el ascensor está asignado a una tarea. 

\label{structelevator__status__t_a49b269ba6a3071deeb505cc8ce289538} 
\index{elevator\_status\_t@{elevator\_status\_t}!piso\_actual@{piso\_actual}}
\index{piso\_actual@{piso\_actual}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{piso\_actual}
{\footnotesize\ttfamily int elevator\+\_\+status\+\_\+t\+::piso\+\_\+actual}



Piso actual del ascensor. 

\label{structelevator__status__t_a80ac4133eb5ddf9bcded8a716fb5a794} 
\index{elevator\_status\_t@{elevator\_status\_t}!tarea\_actual\_id@{tarea\_actual\_id}}
\index{tarea\_actual\_id@{tarea\_actual\_id}!elevator\_status\_t@{elevator\_status\_t}}
\doxysubsubsection{tarea\_actual\_id}
{\footnotesize\ttfamily char elevator\+\_\+status\+\_\+t\+::tarea\+\_\+actual\+\_\+id[TASK\+\_\+\+ID\+\_\+\+MAX\+\_\+\+LEN]}



ID de la tarea asignada por el servidor central. 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ elevator\+\_\+state\+\_\+manager.\+h}\end{DoxyCompactItemize}

\subsection{Estructura execution\_stats\_t}
\doxysection{execution\+\_\+stats\+\_\+t Struct Reference}
\label{structexecution__stats__t}\index{execution\_stats\_t@{execution\_stats\_t}}


Estadísticas de ejecución.  




{\ttfamily \#include $<$execution\+\_\+logger.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
int \textbf{ total\+\_\+can\+\_\+frames\+\_\+sent}
\begin{DoxyCompactList}\small\item\em Total de frames CAN enviados. \end{DoxyCompactList}\item 
int \textbf{ total\+\_\+can\+\_\+frames\+\_\+received}
\begin{DoxyCompactList}\small\item\em Total de frames CAN recibidos. \end{DoxyCompactList}\item 
int \textbf{ total\+\_\+coap\+\_\+requests}
\begin{DoxyCompactList}\small\item\em Total de peticiones Co\+AP. \end{DoxyCompactList}\item 
int \textbf{ total\+\_\+coap\+\_\+responses}
\begin{DoxyCompactList}\small\item\em Total de respuestas Co\+AP. \end{DoxyCompactList}\item 
int \textbf{ total\+\_\+tasks\+\_\+assigned}
\begin{DoxyCompactList}\small\item\em Total de tareas asignadas. \end{DoxyCompactList}\item 
int \textbf{ total\+\_\+tasks\+\_\+completed}
\begin{DoxyCompactList}\small\item\em Total de tareas completadas. \end{DoxyCompactList}\item 
int \textbf{ total\+\_\+elevator\+\_\+movements}
\begin{DoxyCompactList}\small\item\em Total de movimientos de ascensores. \end{DoxyCompactList}\item 
int \textbf{ total\+\_\+errors}
\begin{DoxyCompactList}\small\item\em Total de errores. \end{DoxyCompactList}\item 
double \textbf{ execution\+\_\+duration\+\_\+sec}
\begin{DoxyCompactList}\small\item\em Duración total en segundos. \end{DoxyCompactList}\item 
char \textbf{ building\+\_\+id} [32]
\begin{DoxyCompactList}\small\item\em ID del edificio simulado. \end{DoxyCompactList}\item 
int \textbf{ building\+\_\+requests}
\begin{DoxyCompactList}\small\item\em Número de peticiones del edificio. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estadísticas de ejecución. 

\doxysubsection{Field Documentation}
\label{structexecution__stats__t_a023f87be387c601892b1f997a56b4745} 
\index{execution\_stats\_t@{execution\_stats\_t}!building\_id@{building\_id}}
\index{building\_id@{building\_id}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{building\_id}
{\footnotesize\ttfamily char execution\+\_\+stats\+\_\+t\+::building\+\_\+id[32]}



ID del edificio simulado. 

\label{structexecution__stats__t_ad53f61c42c194884f50473324802d344} 
\index{execution\_stats\_t@{execution\_stats\_t}!building\_requests@{building\_requests}}
\index{building\_requests@{building\_requests}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{building\_requests}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::building\+\_\+requests}



Número de peticiones del edificio. 

\label{structexecution__stats__t_ac39048a9e7ae262ae39c72022e2e4400} 
\index{execution\_stats\_t@{execution\_stats\_t}!execution\_duration\_sec@{execution\_duration\_sec}}
\index{execution\_duration\_sec@{execution\_duration\_sec}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{execution\_duration\_sec}
{\footnotesize\ttfamily double execution\+\_\+stats\+\_\+t\+::execution\+\_\+duration\+\_\+sec}



Duración total en segundos. 

\label{structexecution__stats__t_a58f78fb85ebd37aa8e0b48547ab90b13} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_can\_frames\_received@{total\_can\_frames\_received}}
\index{total\_can\_frames\_received@{total\_can\_frames\_received}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_can\_frames\_received}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+can\+\_\+frames\+\_\+received}



Total de frames CAN recibidos. 

\label{structexecution__stats__t_ae85f58c2179eb2fb253aa0bdc36536f7} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_can\_frames\_sent@{total\_can\_frames\_sent}}
\index{total\_can\_frames\_sent@{total\_can\_frames\_sent}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_can\_frames\_sent}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+can\+\_\+frames\+\_\+sent}



Total de frames CAN enviados. 

\label{structexecution__stats__t_a6736dbed2dce6b705eb7444a6f05d6d9} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_coap\_requests@{total\_coap\_requests}}
\index{total\_coap\_requests@{total\_coap\_requests}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_coap\_requests}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+coap\+\_\+requests}



Total de peticiones Co\+AP. 

\label{structexecution__stats__t_a8db30e4962877d28b2effc100d87d4cd} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_coap\_responses@{total\_coap\_responses}}
\index{total\_coap\_responses@{total\_coap\_responses}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_coap\_responses}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+coap\+\_\+responses}



Total de respuestas Co\+AP. 

\label{structexecution__stats__t_a072ca5e4fbb2d20d5400e834b9ad30e4} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_elevator\_movements@{total\_elevator\_movements}}
\index{total\_elevator\_movements@{total\_elevator\_movements}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_elevator\_movements}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+elevator\+\_\+movements}



Total de movimientos de ascensores. 

\label{structexecution__stats__t_a06bc467e5f3156f9b5d44d1378ef957f} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_errors@{total\_errors}}
\index{total\_errors@{total\_errors}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_errors}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+errors}



Total de errores. 

\label{structexecution__stats__t_a63a115a9c7d00d912da134db40b171d2} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_tasks\_assigned@{total\_tasks\_assigned}}
\index{total\_tasks\_assigned@{total\_tasks\_assigned}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_tasks\_assigned}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+tasks\+\_\+assigned}



Total de tareas asignadas. 

\label{structexecution__stats__t_a1a6fd0a15b8853a2d29d4cc25fbd0f1e} 
\index{execution\_stats\_t@{execution\_stats\_t}!total\_tasks\_completed@{total\_tasks\_completed}}
\index{total\_tasks\_completed@{total\_tasks\_completed}!execution\_stats\_t@{execution\_stats\_t}}
\doxysubsubsection{total\_tasks\_completed}
{\footnotesize\ttfamily int execution\+\_\+stats\+\_\+t\+::total\+\_\+tasks\+\_\+completed}



Total de tareas completadas. 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ execution\+\_\+logger.\+h}\end{DoxyCompactItemize}

\subsection{Estructura log\_event\_t}
\doxysection{log\+\_\+event\+\_\+t Struct Reference}
\label{structlog__event__t}\index{log\_event\_t@{log\_event\_t}}


Estructura de un evento de log.  




{\ttfamily \#include $<$execution\+\_\+logger.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\textbf{ log\+\_\+event\+\_\+type\+\_\+t} \textbf{ type}
\begin{DoxyCompactList}\small\item\em Tipo de evento. \end{DoxyCompactList}\item 
time\+\_\+t \textbf{ timestamp}
\begin{DoxyCompactList}\small\item\em Timestamp del evento. \end{DoxyCompactList}\item 
char \textbf{ description} [MAX\+\_\+\+EVENT\+\_\+\+DESCRIPTION]
\begin{DoxyCompactList}\small\item\em Descripción del evento. \end{DoxyCompactList}\item 
char \textbf{ details} [MAX\+\_\+\+LOG\+\_\+\+MESSAGE]
\begin{DoxyCompactList}\small\item\em Detalles adicionales. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estructura de un evento de log. 

\doxysubsection{Field Documentation}
\label{structlog__event__t_a4a60d64e81f30eb008e512e45ee6c183} 
\index{log\_event\_t@{log\_event\_t}!description@{description}}
\index{description@{description}!log\_event\_t@{log\_event\_t}}
\doxysubsubsection{description}
{\footnotesize\ttfamily char log\+\_\+event\+\_\+t\+::description[MAX\+\_\+\+EVENT\+\_\+\+DESCRIPTION]}



Descripción del evento. 

\label{structlog__event__t_a43b8bb5e00c5bf8355008645a77db013} 
\index{log\_event\_t@{log\_event\_t}!details@{details}}
\index{details@{details}!log\_event\_t@{log\_event\_t}}
\doxysubsubsection{details}
{\footnotesize\ttfamily char log\+\_\+event\+\_\+t\+::details[MAX\+\_\+\+LOG\+\_\+\+MESSAGE]}



Detalles adicionales. 

\label{structlog__event__t_ab2acc6ac6d07afbe299b657d48865bc6} 
\index{log\_event\_t@{log\_event\_t}!timestamp@{timestamp}}
\index{timestamp@{timestamp}!log\_event\_t@{log\_event\_t}}
\doxysubsubsection{timestamp}
{\footnotesize\ttfamily time\+\_\+t log\+\_\+event\+\_\+t\+::timestamp}



Timestamp del evento. 

\label{structlog__event__t_ae5fad0cb88afc66c8a919228a861fad6} 
\index{log\_event\_t@{log\_event\_t}!type@{type}}
\index{type@{type}!log\_event\_t@{log\_event\_t}}
\doxysubsubsection{type}
{\footnotesize\ttfamily \textbf{ log\+\_\+event\+\_\+type\+\_\+t} log\+\_\+event\+\_\+t\+::type}



Tipo de evento. 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ execution\+\_\+logger.\+h}\end{DoxyCompactItemize}

\subsection{Estructura peticion\_simulacion\_t}
\doxysection{peticion\+\_\+simulacion\+\_\+t Struct Reference}
\label{structpeticion__simulacion__t}\index{peticion\_simulacion\_t@{peticion\_simulacion\_t}}


Estructura para una petición individual.  




{\ttfamily \#include $<$simulation\+\_\+loader.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\textbf{ tipo\+\_\+peticion\+\_\+t} \textbf{ tipo}
\item 
int \textbf{ piso\+\_\+origen}
\item 
char \textbf{ direccion} [8]
\item 
int \textbf{ indice\+\_\+ascensor}
\item 
int \textbf{ piso\+\_\+destino}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estructura para una petición individual. 

Contiene toda la información necesaria para ejecutar una petición específica durante la simulación. 

\doxysubsection{Field Documentation}
\label{structpeticion__simulacion__t_af5466515581d96786fe26eab34923e09} 
\index{peticion\_simulacion\_t@{peticion\_simulacion\_t}!direccion@{direccion}}
\index{direccion@{direccion}!peticion\_simulacion\_t@{peticion\_simulacion\_t}}
\doxysubsubsection{direccion}
{\footnotesize\ttfamily char peticion\+\_\+simulacion\+\_\+t\+::direccion[8]}

Dirección\+: "{}up"{} o "{}down"{} \label{structpeticion__simulacion__t_a377c904745de9b54d90bce3ab372ca37} 
\index{peticion\_simulacion\_t@{peticion\_simulacion\_t}!indice\_ascensor@{indice\_ascensor}}
\index{indice\_ascensor@{indice\_ascensor}!peticion\_simulacion\_t@{peticion\_simulacion\_t}}
\doxysubsubsection{indice\_ascensor}
{\footnotesize\ttfamily int peticion\+\_\+simulacion\+\_\+t\+::indice\+\_\+ascensor}

Índice del ascensor (0-\/based) \label{structpeticion__simulacion__t_ae1263837afa2060c58ff85262adc7c95} 
\index{peticion\_simulacion\_t@{peticion\_simulacion\_t}!piso\_destino@{piso\_destino}}
\index{piso\_destino@{piso\_destino}!peticion\_simulacion\_t@{peticion\_simulacion\_t}}
\doxysubsubsection{piso\_destino}
{\footnotesize\ttfamily int peticion\+\_\+simulacion\+\_\+t\+::piso\+\_\+destino}

Piso destino solicitado \label{structpeticion__simulacion__t_ae94756e78d10631228f10082d095c1f6} 
\index{peticion\_simulacion\_t@{peticion\_simulacion\_t}!piso\_origen@{piso\_origen}}
\index{piso\_origen@{piso\_origen}!peticion\_simulacion\_t@{peticion\_simulacion\_t}}
\doxysubsubsection{piso\_origen}
{\footnotesize\ttfamily int peticion\+\_\+simulacion\+\_\+t\+::piso\+\_\+origen}

Piso desde el cual se llama \label{structpeticion__simulacion__t_a0ae991ed4673b66be4bf108adee70f84} 
\index{peticion\_simulacion\_t@{peticion\_simulacion\_t}!tipo@{tipo}}
\index{tipo@{tipo}!peticion\_simulacion\_t@{peticion\_simulacion\_t}}
\doxysubsubsection{tipo}
{\footnotesize\ttfamily \textbf{ tipo\+\_\+peticion\+\_\+t} peticion\+\_\+simulacion\+\_\+t\+::tipo}

Tipo de petición 

The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ simulation\+\_\+loader.\+h}\end{DoxyCompactItemize}

\subsection{Estructura psk\_keys\_t}
\doxysection{psk\+\_\+keys\+\_\+t Struct Reference}
\label{structpsk__keys__t}\index{psk\_keys\_t@{psk\_keys\_t}}
\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
char $\ast$$\ast$ \textbf{ keys}
\item 
int \textbf{ count}
\item 
int \textbf{ capacity}
\end{DoxyCompactItemize}


\doxysubsection{Field Documentation}
\label{structpsk__keys__t_aceb97aba7ce96e62d93786885d58bffb} 
\index{psk\_keys\_t@{psk\_keys\_t}!capacity@{capacity}}
\index{capacity@{capacity}!psk\_keys\_t@{psk\_keys\_t}}
\doxysubsubsection{capacity}
{\footnotesize\ttfamily int psk\+\_\+keys\+\_\+t\+::capacity}

\label{structpsk__keys__t_a92e2da2d916a7fe6e1f3873ba986ffcc} 
\index{psk\_keys\_t@{psk\_keys\_t}!count@{count}}
\index{count@{count}!psk\_keys\_t@{psk\_keys\_t}}
\doxysubsubsection{count}
{\footnotesize\ttfamily int psk\+\_\+keys\+\_\+t\+::count}

\label{structpsk__keys__t_aaaf85aa4b7720d86ee1fcd6a32db4dfa} 
\index{psk\_keys\_t@{psk\_keys\_t}!keys@{keys}}
\index{keys@{keys}!psk\_keys\_t@{psk\_keys\_t}}
\doxysubsubsection{keys}
{\footnotesize\ttfamily char$\ast$$\ast$ psk\+\_\+keys\+\_\+t\+::keys}



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/\textbf{ psk\+\_\+manager.\+c}\end{DoxyCompactItemize}

\subsection{Estructura simulated\_can\_frame\_t}
\doxysection{simulated\+\_\+can\+\_\+frame\+\_\+t Struct Reference}
\label{structsimulated__can__frame__t}\index{simulated\_can\_frame\_t@{simulated\_can\_frame\_t}}


Estructura para un frame CAN simulado.  




{\ttfamily \#include $<$can\+\_\+bridge.\+h$>$}

\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
uint32\+\_\+t \textbf{ id}
\begin{DoxyCompactList}\small\item\em CAN ID (identificador del mensaje) \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ data} [8]
\begin{DoxyCompactList}\small\item\em Datos CAN (hasta 8 bytes según estándar CAN) \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ dlc}
\begin{DoxyCompactList}\small\item\em Data Length Code (0-\/8, número de bytes válidos) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estructura para un frame CAN simulado. 

Representa un frame CAN estándar con ID, datos y longitud. Utilizada para la comunicación entre el simulador de ascensores y el API Gateway. 

\doxysubsection{Field Documentation}
\label{structsimulated__can__frame__t_ad318c7931af21d1fd14e7ef967cc3b84} 
\index{simulated\_can\_frame\_t@{simulated\_can\_frame\_t}!data@{data}}
\index{data@{data}!simulated\_can\_frame\_t@{simulated\_can\_frame\_t}}
\doxysubsubsection{data}
{\footnotesize\ttfamily uint8\+\_\+t simulated\+\_\+can\+\_\+frame\+\_\+t\+::data[8]}



Datos CAN (hasta 8 bytes según estándar CAN) 

\label{structsimulated__can__frame__t_a2d2ae417c42402074feba54b1e8eb941} 
\index{simulated\_can\_frame\_t@{simulated\_can\_frame\_t}!dlc@{dlc}}
\index{dlc@{dlc}!simulated\_can\_frame\_t@{simulated\_can\_frame\_t}}
\doxysubsubsection{dlc}
{\footnotesize\ttfamily uint8\+\_\+t simulated\+\_\+can\+\_\+frame\+\_\+t\+::dlc}



Data Length Code (0-\/8, número de bytes válidos) 

\label{structsimulated__can__frame__t_a7075c6fa359faa8aed111b64c5c52b42} 
\index{simulated\_can\_frame\_t@{simulated\_can\_frame\_t}!id@{id}}
\index{id@{id}!simulated\_can\_frame\_t@{simulated\_can\_frame\_t}}
\doxysubsubsection{id}
{\footnotesize\ttfamily uint32\+\_\+t simulated\+\_\+can\+\_\+frame\+\_\+t\+::id}



CAN ID (identificador del mensaje) 



The documentation for this struct was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/api\+\_\+gateway/\textbf{ can\+\_\+bridge.\+h}\end{DoxyCompactItemize}

\section{Archivos de Headers}
\subsection{api\_common\_defs}
\doxysection{include/api\+\_\+gateway/api\+\_\+common\+\_\+defs.h File Reference}
\label{api__common__defs_8h}\index{include/api\_gateway/api\_common\_defs.h@{include/api\_gateway/api\_common\_defs.h}}

\subsection{can\_bridge}
\doxysection{include/api\+\_\+gateway/can\+\_\+bridge.h File Reference}
\label{can__bridge_8h}\index{include/api\_gateway/can\_bridge.h@{include/api\_gateway/can\_bridge.h}}


Puente CAN-\/\+Co\+AP para el API Gateway.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura para un frame CAN simulado. \end{DoxyCompactList}\item 
struct \textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t}
\begin{DoxyCompactList}\small\item\em Tracker para correlacionar solicitudes CAN con respuestas Co\+AP. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ \textbf{ can\+\_\+send\+\_\+callback\+\_\+t}) (\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$frame)
\begin{DoxyCompactList}\small\item\em Callback para envío de frames CAN al simulador. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Inicializa el puente CAN simulado. \end{DoxyCompactList}\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback} (\textbf{ can\+\_\+send\+\_\+callback\+\_\+t} callback)
\begin{DoxyCompactList}\small\item\em Registra la función de callback que la API Gateway usará para enviar frames CAN. \end{DoxyCompactList}\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame} (\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$frame, struct coap\+\_\+context\+\_\+t $\ast$coap\+\_\+context)
\begin{DoxyCompactList}\small\item\em Procesa un frame CAN simulado entrante desde la simulación de ascensores. \end{DoxyCompactList}\item 
\textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t} $\ast$ \textbf{ find\+\_\+can\+\_\+tracker} (coap\+\_\+bin\+\_\+const\+\_\+t token)
\begin{DoxyCompactList}\small\item\em Busca un tracker de origen CAN basado en un token Co\+AP. \end{DoxyCompactList}\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame} (uint32\+\_\+t original\+\_\+can\+\_\+id, coap\+\_\+pdu\+\_\+code\+\_\+t response\+\_\+code, c\+JSON $\ast$server\+\_\+response\+\_\+json)
\begin{DoxyCompactList}\small\item\em Envía una respuesta (traducida de Co\+AP) como un frame CAN simulado a la simulación. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Puente CAN-\/\+Co\+AP para el API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo define la interfaz del puente de comunicación entre el protocolo CAN (Controller Area Network) y Co\+AP (Constrained Application Protocol) para el sistema de control de ascensores.

{\bfseries{Funcionalidades principales\+:}}
\begin{DoxyItemize}
\item Procesamiento de frames CAN entrantes desde simuladores
\item Conversión de mensajes CAN a solicitudes Co\+AP
\item Gestión de trackers para correlación de respuestas
\item Envío de respuestas del servidor central vía CAN
\item Interfaz con simuladores de ascensores
\end{DoxyItemize}

{\bfseries{Tipos de mensajes CAN soportados\+:}}
\begin{DoxyItemize}
\item 0x100\+: Llamadas de piso (floor calls) con dirección
\item 0x200\+: Solicitudes de cabina (cabin requests) con destino
\item 0x300\+: Notificaciones de llegada de ascensores
\end{DoxyItemize}

El puente mantiene un buffer circular de trackers para correlacionar respuestas del servidor central con las solicitudes CAN originales.

\begin{DoxySeeAlso}{See also}
\doxyref{can\+\_\+bridge.\+c}{p.}{can__bridge_8c} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 

api\+\_\+handlers.\+h 
\end{DoxySeeAlso}


\doxysubsection{Typedef Documentation}
\label{can__bridge_8h_a1c10dfd5c89b2417f2eacc2d71c91c9a} 
\index{can\_bridge.h@{can\_bridge.h}!can\_send\_callback\_t@{can\_send\_callback\_t}}
\index{can\_send\_callback\_t@{can\_send\_callback\_t}!can\_bridge.h@{can\_bridge.h}}
\doxysubsubsection{can\_send\_callback\_t}
{\footnotesize\ttfamily typedef void($\ast$ can\+\_\+send\+\_\+callback\+\_\+t) (\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$frame)}



Callback para envío de frames CAN al simulador. 


\begin{DoxyParams}{Parameters}
{\em frame} & El frame CAN simulado a enviar al simulador del ascensor\\
\hline
\end{DoxyParams}
Tipo de función callback que debe implementar el simulador de ascensores para recibir frames CAN de respuesta del API Gateway. El simulador registra una función de este tipo usando \doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15}.

{\bfseries{Responsabilidades del callback\+:}}
\begin{DoxyItemize}
\item Procesar el frame CAN recibido
\item Interpretar códigos de respuesta y datos
\item Actualizar estado del simulador según corresponda
\item Generar logging apropiado para debugging
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame()}{p.}{can__bridge_8h_a5add34ce57a2d36aa902cf08b921a665} 
\end{DoxySeeAlso}


\doxysubsection{Function Documentation}
\label{can__bridge_8h_a331e50c4b7681888fa7b0c1eb89e7f32} 
\index{can\_bridge.h@{can\_bridge.h}!ag\_can\_bridge\_init@{ag\_can\_bridge\_init}}
\index{ag\_can\_bridge\_init@{ag\_can\_bridge\_init}!can\_bridge.h@{can\_bridge.h}}
\doxysubsubsection{ag\_can\_bridge\_init()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Inicializa el puente CAN simulado. 

Esta función inicializa el sistema de puente CAN-\/\+Co\+AP, preparando todas las estructuras de datos necesarias para el funcionamiento.

{\bfseries{Operaciones realizadas\+:}}
\begin{DoxyItemize}
\item Limpia el callback de envío CAN
\item Libera memoria de tokens almacenados en trackers
\item Inicializa a cero el buffer de trackers CAN
\item Resetea el índice del buffer circular
\end{DoxyItemize}

Debe llamarse una vez al inicio del programa antes de procesar cualquier frame CAN o registrar callbacks.

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame()}{p.}{can__bridge_8h_a1859dd08bf918dd5bc9ebc92071ae9ca}
\end{DoxySeeAlso}
Inicializa el puente CAN simulado.

Esta función inicializa el sistema de puente CAN-\/\+Co\+AP, preparando todas las estructuras de datos necesarias para el funcionamiento.

Operaciones realizadas\+:
\begin{DoxyItemize}
\item Limpia el callback de envío CAN
\item Libera memoria de tokens almacenados en trackers
\item Inicializa a cero el buffer de trackers CAN
\item Resetea el índice del buffer circular
\end{DoxyItemize}

Debe llamarse una vez al inicio del programa antes de procesar cualquier frame CAN o registrar callbacks.

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame()}{p.}{can__bridge_8h_a1859dd08bf918dd5bc9ebc92071ae9ca} 
\end{DoxySeeAlso}
\label{can__bridge_8h_a1859dd08bf918dd5bc9ebc92071ae9ca} 
\index{can\_bridge.h@{can\_bridge.h}!ag\_can\_bridge\_process\_incoming\_frame@{ag\_can\_bridge\_process\_incoming\_frame}}
\index{ag\_can\_bridge\_process\_incoming\_frame@{ag\_can\_bridge\_process\_incoming\_frame}!can\_bridge.h@{can\_bridge.h}}
\doxysubsubsection{ag\_can\_bridge\_process\_incoming\_frame()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame (\begin{DoxyParamCaption}\item[{\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$}]{frame,  }\item[{coap\+\_\+context\+\_\+t $\ast$}]{coap\+\_\+ctx }\end{DoxyParamCaption})}



Procesa un frame CAN simulado entrante desde la simulación de ascensores. 


\begin{DoxyParams}{Parameters}
{\em frame} & Puntero al frame CAN simulado recibido \\
\hline
{\em coap\+\_\+context} & El contexto Co\+AP de la API Gateway, necesario para enviar solicitudes\\
\hline
\end{DoxyParams}
Esta función es el punto de entrada principal para el procesamiento de frames CAN entrantes. Interpreta el contenido del frame según el esquema de mensajes CAN definido y genera las solicitudes Co\+AP correspondientes al servidor central.

{\bfseries{Tipos de frames CAN soportados\+:}}
\begin{DoxyItemize}
\item {\bfseries{0x100 -\/ Llamada de piso}}\+:
\begin{DoxyItemize}
\item data[0]\+: Piso origen (0-\/255)
\item data[1]\+: Dirección (0=UP, 1=DOWN)
\end{DoxyItemize}
\item {\bfseries{0x200 -\/ Solicitud de cabina}}\+:
\begin{DoxyItemize}
\item data[0]\+: Índice del ascensor (0-\/based)
\item data[1]\+: Piso destino (0-\/255)
\end{DoxyItemize}
\item {\bfseries{0x300 -\/ Notificación de llegada}}\+:
\begin{DoxyItemize}
\item data[0]\+: Índice del ascensor (0-\/based)
\item data[1]\+: Piso actual (0-\/255)
\end{DoxyItemize}
\end{DoxyItemize}

{\bfseries{Procesamiento realizado\+:}}
\begin{DoxyEnumerate}
\item Validación del formato y longitud de datos
\item Extracción de parámetros específicos del tipo de mensaje
\item Generación de solicitud Co\+AP al servidor central
\item Almacenamiento de tracker para correlación de respuesta
\end{DoxyEnumerate}

\begin{DoxyNote}{Note}
Los IDs CAN y formato de datos deben adaptarse según el esquema específico del sistema de ascensores
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{forward\+\_\+can\+\_\+originated\+\_\+request\+\_\+to\+\_\+central\+\_\+server()}{p.}{can__bridge_8c_ad9eccdae992eb522b098df7cf4ff050d} 

\doxyref{store\+\_\+can\+\_\+tracker()}{p.}{can__bridge_8c_a26febc28ea92320546cd8ec40d003b87} 

\doxyref{simulated\+\_\+can\+\_\+frame\+\_\+t}{p.}{structsimulated__can__frame__t}
\end{DoxySeeAlso}
Procesa un frame CAN simulado entrante desde la simulación de ascensores.


\begin{DoxyParams}{Parameters}
{\em frame} & Puntero al frame CAN simulado a procesar \\
\hline
{\em coap\+\_\+ctx} & Contexto Co\+AP para enviar solicitudes al servidor central\\
\hline
\end{DoxyParams}
Esta función es el punto de entrada principal para el procesamiento de frames CAN entrantes. Interpreta el contenido del frame según el esquema de mensajes CAN definido y genera las solicitudes Co\+AP correspondientes al servidor central.

{\bfseries{Tipos de frames CAN soportados\+:}}
\begin{DoxyItemize}
\item {\bfseries{0x100 -\/ Llamada de piso}}\+:
\begin{DoxyItemize}
\item data[0]\+: Piso origen (0-\/255)
\item data[1]\+: Dirección (0=UP, 1=DOWN)
\end{DoxyItemize}
\item {\bfseries{0x200 -\/ Solicitud de cabina}}\+:
\begin{DoxyItemize}
\item data[0]\+: Índice del ascensor (0-\/based)
\item data[1]\+: Piso destino (0-\/255)
\end{DoxyItemize}
\item {\bfseries{0x300 -\/ Notificación de llegada}}\+:
\begin{DoxyItemize}
\item data[0]\+: Índice del ascensor (0-\/based)
\item data[1]\+: Piso actual (0-\/255)
\end{DoxyItemize}
\end{DoxyItemize}

Para cada frame válido, la función\+:
\begin{DoxyEnumerate}
\item Valida el formato y longitud de datos
\item Extrae los parámetros específicos del tipo de mensaje
\item Genera una solicitud Co\+AP al servidor central
\item Almacena un tracker para correlacionar la respuesta
\end{DoxyEnumerate}

\begin{DoxyNote}{Note}
Los IDs CAN y formato de datos deben adaptarse según el esquema específico del sistema de ascensores
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{forward\+\_\+can\+\_\+originated\+\_\+request\+\_\+to\+\_\+central\+\_\+server()}{p.}{can__bridge_8c_ad9eccdae992eb522b098df7cf4ff050d} 

\doxyref{store\+\_\+can\+\_\+tracker()}{p.}{can__bridge_8c_a26febc28ea92320546cd8ec40d003b87} 

\doxyref{simulated\+\_\+can\+\_\+frame\+\_\+t}{p.}{structsimulated__can__frame__t} 
\end{DoxySeeAlso}
\label{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15} 
\index{can\_bridge.h@{can\_bridge.h}!ag\_can\_bridge\_register\_send\_callback@{ag\_can\_bridge\_register\_send\_callback}}
\index{ag\_can\_bridge\_register\_send\_callback@{ag\_can\_bridge\_register\_send\_callback}!can\_bridge.h@{can\_bridge.h}}
\doxysubsubsection{ag\_can\_bridge\_register\_send\_callback()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback (\begin{DoxyParamCaption}\item[{\textbf{ can\+\_\+send\+\_\+callback\+\_\+t}}]{callback }\end{DoxyParamCaption})}



Registra la función de callback que la API Gateway usará para enviar frames CAN. 


\begin{DoxyParams}{Parameters}
{\em callback} & Puntero a la función de callback implementada por la simulación\\
\hline
\end{DoxyParams}
Esta función registra una función callback que será utilizada por el puente CAN-\/\+Co\+AP para enviar frames CAN de respuesta al simulador.

El callback debe implementar la interfaz can\+\_\+send\+\_\+callback\+\_\+t y será invocado cuando el puente necesite enviar respuestas del servidor central de vuelta al sistema CAN simulado.

{\bfseries{Características\+:}}
\begin{DoxyItemize}
\item Solo se puede registrar un callback a la vez
\item Llamadas posteriores sobrescriben el callback anterior
\item El callback debe ser thread-\/safe si se usa en entorno multihilo
\end{DoxyItemize}

\begin{DoxyNote}{Note}
El callback debe permanecer válido durante toda la vida del programa
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{can\+\_\+send\+\_\+callback\+\_\+t}{p.}{can__bridge_8h_a1c10dfd5c89b2417f2eacc2d71c91c9a} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame()}{p.}{can__bridge_8h_a5add34ce57a2d36aa902cf08b921a665}
\end{DoxySeeAlso}
Registra la función de callback que la API Gateway usará para enviar frames CAN.


\begin{DoxyParams}{Parameters}
{\em callback} & Función callback que será llamada para enviar frames CAN\\
\hline
\end{DoxyParams}
Esta función registra una función callback que será utilizada por el puente CAN-\/\+Co\+AP para enviar frames CAN de respuesta al simulador.

El callback debe implementar la interfaz can\+\_\+send\+\_\+callback\+\_\+t y será invocado cuando el puente necesite enviar respuestas del servidor central de vuelta al sistema CAN simulado.

\begin{DoxyNote}{Note}
Solo se puede registrar un callback a la vez. Llamadas posteriores sobrescriben el callback anterior.
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{can\+\_\+send\+\_\+callback\+\_\+t}{p.}{can__bridge_8h_a1c10dfd5c89b2417f2eacc2d71c91c9a} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame()}{p.}{can__bridge_8h_a5add34ce57a2d36aa902cf08b921a665} 
\end{DoxySeeAlso}
\label{can__bridge_8h_a5add34ce57a2d36aa902cf08b921a665} 
\index{can\_bridge.h@{can\_bridge.h}!ag\_can\_bridge\_send\_response\_frame@{ag\_can\_bridge\_send\_response\_frame}}
\index{ag\_can\_bridge\_send\_response\_frame@{ag\_can\_bridge\_send\_response\_frame}!can\_bridge.h@{can\_bridge.h}}
\doxysubsubsection{ag\_can\_bridge\_send\_response\_frame()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{original\+\_\+can\+\_\+id,  }\item[{coap\+\_\+pdu\+\_\+code\+\_\+t}]{response\+\_\+code,  }\item[{c\+JSON $\ast$}]{server\+\_\+response\+\_\+json }\end{DoxyParamCaption})}



Envía una respuesta (traducida de Co\+AP) como un frame CAN simulado a la simulación. 


\begin{DoxyParams}{Parameters}
{\em original\+\_\+can\+\_\+id} & El ID del frame CAN original que originó esta respuesta \\
\hline
{\em response\+\_\+code} & El código de respuesta Co\+AP recibido del servidor central \\
\hline
{\em server\+\_\+response\+\_\+json} & El objeto c\+JSON que contiene la respuesta del servidor central (puede ser NULL)\\
\hline
\end{DoxyParams}
Esta función convierte una respuesta Co\+AP del servidor central en un frame CAN simulado que se envía de vuelta al simulador de ascensores. Maneja tanto respuestas exitosas como códigos de error.

{\bfseries{Procesamiento de respuestas exitosas\+:}}
\begin{DoxyItemize}
\item Extrae ascensor\+\_\+asignado\+\_\+id y tarea\+\_\+id del JSON
\item Convierte ID de ascensor a índice numérico
\item Construye frame CAN con información de asignación
\item ID de respuesta\+: original\+\_\+can\+\_\+id + 1
\end{DoxyItemize}

{\bfseries{Procesamiento de errores\+:}}
\begin{DoxyItemize}
\item Detecta códigos de error Co\+AP o campo "{}error"{} en JSON
\item Genera frame CAN de error con ID 0x\+FE
\item Incluye código de error específico en data[1]
\end{DoxyItemize}

{\bfseries{Códigos de error definidos\+:}}
\begin{DoxyItemize}
\item 0x01\+: JSON faltante o nulo del servidor
\item 0x02\+: Servidor reportó error o código Co\+AP de error
\item 0x03\+: Fallo al parsear JSON de éxito
\end{DoxyItemize}

La función utiliza el callback registrado para enviar el frame al simulador de ascensores.

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{can\+\_\+send\+\_\+callback\+\_\+t}{p.}{can__bridge_8h_a1c10dfd5c89b2417f2eacc2d71c91c9a} 

\doxyref{simulated\+\_\+can\+\_\+frame\+\_\+t}{p.}{structsimulated__can__frame__t} 
\end{DoxySeeAlso}
\label{can__bridge_8h_a7027a900f632b8023cfd9f3b0e4a5a99} 
\index{can\_bridge.h@{can\_bridge.h}!find\_can\_tracker@{find\_can\_tracker}}
\index{find\_can\_tracker@{find\_can\_tracker}!can\_bridge.h@{can\_bridge.h}}
\doxysubsubsection{find\_can\_tracker()}
{\footnotesize\ttfamily \textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t} $\ast$ find\+\_\+can\+\_\+tracker (\begin{DoxyParamCaption}\item[{coap\+\_\+bin\+\_\+const\+\_\+t}]{token }\end{DoxyParamCaption})}



Busca un tracker de origen CAN basado en un token Co\+AP. 


\begin{DoxyParams}{Parameters}
{\em token} & El token Co\+AP de la respuesta recibida del servidor central \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero al \doxyref{can\+\_\+origin\+\_\+tracker\+\_\+t}{p.}{structcan__origin__tracker__t} si se encuentra, NULL en caso contrario
\end{DoxyReturn}
Esta función busca en el buffer circular de trackers CAN un tracker que corresponda al token Co\+AP especificado. Se utiliza para correlacionar respuestas del servidor central con solicitudes CAN originales.

{\bfseries{Características de la búsqueda\+:}}
\begin{DoxyItemize}
\item Comparación binaria exacta del token (longitud + contenido)
\item Búsqueda lineal en buffer circular
\item No remueve el tracker de la lista (a diferencia de find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker)
\item Thread-\/safe para lecturas concurrentes
\end{DoxyItemize}

{\bfseries{Uso típico\+:}}
\begin{DoxyEnumerate}
\item Se recibe respuesta del servidor central con token
\item Se busca el tracker correspondiente
\item Se extrae información del frame CAN original
\item Se genera respuesta CAN apropiada
\end{DoxyEnumerate}

\begin{DoxySeeAlso}{See also}
\doxyref{store\+\_\+can\+\_\+tracker()}{p.}{can__bridge_8c_a26febc28ea92320546cd8ec40d003b87} 

\doxyref{can\+\_\+origin\+\_\+tracker\+\_\+t}{p.}{structcan__origin__tracker__t} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame()}{p.}{can__bridge_8h_a5add34ce57a2d36aa902cf08b921a665}
\end{DoxySeeAlso}
Busca un tracker de origen CAN basado en un token Co\+AP.


\begin{DoxyParams}{Parameters}
{\em token} & Token Co\+AP a buscar en los trackers almacenados \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero al tracker encontrado, o NULL si no se encuentra
\end{DoxyReturn}
Esta función busca en el buffer circular de trackers CAN un tracker que corresponda al token Co\+AP especificado. Se utiliza para correlacionar respuestas del servidor central con solicitudes CAN originales.

La búsqueda se realiza comparando tanto la longitud como el contenido binario del token. No remueve el tracker de la lista (a diferencia de find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker).

\begin{DoxySeeAlso}{See also}
\doxyref{store\+\_\+can\+\_\+tracker()}{p.}{can__bridge_8c_a26febc28ea92320546cd8ec40d003b87} 

\doxyref{can\+\_\+origin\+\_\+tracker\+\_\+t}{p.}{structcan__origin__tracker__t} 
\end{DoxySeeAlso}

\subsection{coap\_config}
\doxysection{include/api\+\_\+gateway/coap\+\_\+config.h File Reference}
\label{coap__config_8h}\index{include/api\_gateway/coap\_config.h@{include/api\_gateway/coap\_config.h}}


Configuraciones Co\+AP para el API Gateway.  




\doxysubsection{Detailed Description}
Configuraciones Co\+AP para el API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo define las configuraciones del protocolo Co\+AP (Constrained Application Protocol) utilizadas por el API Gateway para comunicarse con el servidor central.

{\bfseries{Configuraciones incluidas\+:}}
\begin{DoxyItemize}
\item Dirección IP y puerto del servidor central
\item Dirección IP y puerto de escucha del gateway
\item Rutas de recursos Co\+AP para diferentes tipos de solicitudes
\item Configuraciones de timeout y reintentos
\item Parámetros de conexión DTLS-\/\+PSK
\end{DoxyItemize}

{\bfseries{Recursos Co\+AP definidos\+:}}
\begin{DoxyItemize}
\item {\ttfamily /peticion\+\_\+piso}\+: Para solicitudes de llamada de piso
\item {\ttfamily /peticion\+\_\+cabina}\+: Para solicitudes desde cabina de ascensor
\end{DoxyItemize}

Las configuraciones aquí definidas deben coincidir con las rutas y configuraciones del servidor central para garantizar la comunicación.

\begin{DoxySeeAlso}{See also}
servidor\+\_\+central/main.\+c 
\end{DoxySeeAlso}

\subsection{elevator\_state\_manager}
\doxysection{include/api\+\_\+gateway/elevator\+\_\+state\+\_\+manager.h File Reference}
\label{elevator__state__manager_8h}\index{include/api\_gateway/elevator\_state\_manager.h@{include/api\_gateway/elevator\_state\_manager.h}}


Gestor de Estado de Ascensores para el API Gateway.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ elevator\+\_\+status\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estado de un ascensor individual. \end{DoxyCompactList}\item 
struct \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estado del grupo de ascensores gestionado por el gateway. \end{DoxyCompactList}\item 
struct \textbf{ api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t}
\begin{DoxyCompactList}\small\item\em Detalles específicos de solicitud para serialización JSON. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ door\+\_\+state\+\_\+enum\+\_\+t} \{ \newline
\textbf{ DOOR\+\_\+\+CLOSED}
, \textbf{ DOOR\+\_\+\+OPEN}
, \textbf{ DOOR\+\_\+\+OPENING}
, \textbf{ DOOR\+\_\+\+CLOSING}
, \newline
\textbf{ DOOR\+\_\+\+UNKNOWN}
 \}
\begin{DoxyCompactList}\small\item\em Enumeración de estados de puertas de ascensor. \end{DoxyCompactList}\item 
enum \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} \{ \textbf{ MOVING\+\_\+\+UP}
, \textbf{ MOVING\+\_\+\+DOWN}
, \textbf{ STOPPED}
, \textbf{ DIRECTION\+\_\+\+UNKNOWN}
 \}
\begin{DoxyCompactList}\small\item\em Enumeración de direcciones de movimiento de ascensor. \end{DoxyCompactList}\item 
enum \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} \{ \textbf{ GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+UNKNOWN} = 0
, \textbf{ GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+FLOOR\+\_\+\+CALL}
, \textbf{ GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+CABIN\+\_\+\+REQUEST}
 \}
\begin{DoxyCompactList}\small\item\em Enumeración de tipos de solicitud del gateway. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ init\+\_\+elevator\+\_\+group} (\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group, const char $\ast$edificio\+\_\+id\+\_\+str, int num\+\_\+elevadores, int num\+\_\+pisos)
\begin{DoxyCompactList}\small\item\em Inicializa el estado de un grupo de ascensores. \end{DoxyCompactList}\item 
c\+JSON $\ast$ \textbf{ elevator\+\_\+group\+\_\+to\+\_\+json\+\_\+for\+\_\+server} (const \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group, \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} request\+\_\+type, const \textbf{ api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t} $\ast$details)
\begin{DoxyCompactList}\small\item\em Serializa el estado del grupo de ascensores a JSON para el servidor central. \end{DoxyCompactList}\item 
void \textbf{ assign\+\_\+task\+\_\+to\+\_\+elevator} (\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group, const char $\ast$elevator\+\_\+id\+\_\+to\+\_\+update, const char $\ast$task\+\_\+id, int target\+\_\+floor, int current\+\_\+request\+\_\+floor)
\begin{DoxyCompactList}\small\item\em Actualiza el estado de un ascensor tras recibir asignación de tarea. \end{DoxyCompactList}\item 
const char $\ast$ \textbf{ door\+\_\+state\+\_\+to\+\_\+string} (\textbf{ door\+\_\+state\+\_\+enum\+\_\+t} state)
\begin{DoxyCompactList}\small\item\em Convierte un estado de puerta a su representación en string. \end{DoxyCompactList}\item 
const char $\ast$ \textbf{ movement\+\_\+direction\+\_\+to\+\_\+string} (\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} direction)
\begin{DoxyCompactList}\small\item\em Convierte una dirección de movimiento a su representación en string. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Gestor de Estado de Ascensores para el API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este header define las estructuras de datos y funciones para la gestión del estado de ascensores en el API Gateway. Proporciona\+:


\begin{DoxyItemize}
\item {\bfseries{Estructuras de estado}}\+: Definiciones para ascensores individuales y grupos
\item {\bfseries{Enumeraciones}}\+: Estados de puertas, direcciones de movimiento, tipos de solicitud
\item {\bfseries{Funciones de gestión}}\+: Inicialización, asignación de tareas, notificaciones
\item {\bfseries{Serialización JSON}}\+: Conversión de estado a formato para servidor central
\item {\bfseries{Utilidades}}\+: Funciones helper para conversión de enums a strings
\end{DoxyItemize}

El gestor mantiene información completa de cada ascensor incluyendo\+:
\begin{DoxyItemize}
\item Identificación única y edificio
\item Posición actual y destino
\item Estado de puertas y dirección de movimiento
\item Tarea asignada y estado de ocupación
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+state\+\_\+manager.\+c}{p.}{elevator__state__manager_8c} 

api\+\_\+handlers.\+h 

\doxyref{api\+\_\+common\+\_\+defs.\+h}{p.}{api__common__defs_8h} 
\end{DoxySeeAlso}


\doxysubsection{Enumeration Type Documentation}
\label{elevator__state__manager_8h_ab8ae21f2fd452f98f77170f3dc9e2786} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!door\_state\_enum\_t@{door\_state\_enum\_t}}
\index{door\_state\_enum\_t@{door\_state\_enum\_t}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{door\_state\_enum\_t}
{\footnotesize\ttfamily enum \textbf{ door\+\_\+state\+\_\+enum\+\_\+t}}



Enumeración de estados de puertas de ascensor. 

Define los posibles estados de las puertas de un ascensor para control y monitoreo del sistema. \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{DOOR\_CLOSED@{DOOR\_CLOSED}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!DOOR\_CLOSED@{DOOR\_CLOSED}}}\label{elevator__state__manager_8h_ab8ae21f2fd452f98f77170f3dc9e2786ae8b1c2b57163356ce43b43747e51f74e} 
DOOR\+\_\+\+CLOSED&Puertas completamente cerradas. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{DOOR\_OPEN@{DOOR\_OPEN}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!DOOR\_OPEN@{DOOR\_OPEN}}}\label{elevator__state__manager_8h_ab8ae21f2fd452f98f77170f3dc9e2786a11915658ade106027bd75056b907539d} 
DOOR\+\_\+\+OPEN&Puertas completamente abiertas. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{DOOR\_OPENING@{DOOR\_OPENING}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!DOOR\_OPENING@{DOOR\_OPENING}}}\label{elevator__state__manager_8h_ab8ae21f2fd452f98f77170f3dc9e2786a99eca5709ed520c7112e884b915d8082} 
DOOR\+\_\+\+OPENING&Puertas en proceso de apertura. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{DOOR\_CLOSING@{DOOR\_CLOSING}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!DOOR\_CLOSING@{DOOR\_CLOSING}}}\label{elevator__state__manager_8h_ab8ae21f2fd452f98f77170f3dc9e2786ab66bfdf0e51c75abbcfe59363cef65ee} 
DOOR\+\_\+\+CLOSING&Puertas en proceso de cierre. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{DOOR\_UNKNOWN@{DOOR\_UNKNOWN}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!DOOR\_UNKNOWN@{DOOR\_UNKNOWN}}}\label{elevator__state__manager_8h_ab8ae21f2fd452f98f77170f3dc9e2786a84ccbad8501b2e1db88ea03bb8687cd4} 
DOOR\+\_\+\+UNKNOWN&Estado de puertas desconocido. \\
\hline

\end{DoxyEnumFields}
\label{elevator__state__manager_8h_a17e4539046553af2ffabda67ff75cbb0} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!gw\_request\_type\_t@{gw\_request\_type\_t}}
\index{gw\_request\_type\_t@{gw\_request\_type\_t}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{gw\_request\_type\_t}
{\footnotesize\ttfamily enum \textbf{ gw\+\_\+request\+\_\+type\+\_\+t}}



Enumeración de tipos de solicitud del gateway. 

Define los tipos de solicitudes que el gateway puede procesar y reenviar al servidor central. Utilizado para serialización JSON y gestión de trackers. \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{GW\_REQUEST\_TYPE\_UNKNOWN@{GW\_REQUEST\_TYPE\_UNKNOWN}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!GW\_REQUEST\_TYPE\_UNKNOWN@{GW\_REQUEST\_TYPE\_UNKNOWN}}}\label{elevator__state__manager_8h_a17e4539046553af2ffabda67ff75cbb0ae0f69383a1f168c37cc7f8fc70e1f42e} 
GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+UNKNOWN&Tipo de solicitud desconocido. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{GW\_REQUEST\_TYPE\_FLOOR\_CALL@{GW\_REQUEST\_TYPE\_FLOOR\_CALL}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!GW\_REQUEST\_TYPE\_FLOOR\_CALL@{GW\_REQUEST\_TYPE\_FLOOR\_CALL}}}\label{elevator__state__manager_8h_a17e4539046553af2ffabda67ff75cbb0aad2430297848cdfb0e5be7eda7c01300} 
GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+FLOOR\+\_\+\+CALL&Llamada de piso (botón externo) \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{GW\_REQUEST\_TYPE\_CABIN\_REQUEST@{GW\_REQUEST\_TYPE\_CABIN\_REQUEST}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!GW\_REQUEST\_TYPE\_CABIN\_REQUEST@{GW\_REQUEST\_TYPE\_CABIN\_REQUEST}}}\label{elevator__state__manager_8h_a17e4539046553af2ffabda67ff75cbb0ac516ba6346d0cc1d0ed36ad6b24000af} 
GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+CABIN\+\_\+\+REQUEST&Solicitud de cabina (botón interno) \\
\hline

\end{DoxyEnumFields}
\label{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!movement\_direction\_enum\_t@{movement\_direction\_enum\_t}}
\index{movement\_direction\_enum\_t@{movement\_direction\_enum\_t}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{movement\_direction\_enum\_t}
{\footnotesize\ttfamily enum \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t}}



Enumeración de direcciones de movimiento de ascensor. 

Define las posibles direcciones de movimiento de un ascensor para control de tráfico y optimización de rutas. \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{MOVING\_UP@{MOVING\_UP}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!MOVING\_UP@{MOVING\_UP}}}\label{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01ad0d69c60b9d20b96b089b680f8d7566d} 
MOVING\+\_\+\+UP&Ascensor moviéndose hacia arriba. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{MOVING\_DOWN@{MOVING\_DOWN}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!MOVING\_DOWN@{MOVING\_DOWN}}}\label{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01aa9afce301988e16292cfcae76a57d9a8} 
MOVING\+\_\+\+DOWN&Ascensor moviéndose hacia abajo. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{STOPPED@{STOPPED}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!STOPPED@{STOPPED}}}\label{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01a948b2aee15f52b421fa4770c47bcfe8c} 
STOPPED&Ascensor detenido. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{DIRECTION\_UNKNOWN@{DIRECTION\_UNKNOWN}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!DIRECTION\_UNKNOWN@{DIRECTION\_UNKNOWN}}}\label{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01a2a4636cbb5f8e381089da3af802d0839} 
DIRECTION\+\_\+\+UNKNOWN&Dirección de movimiento desconocida. \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\label{elevator__state__manager_8h_a7a4e6bf1bb74d59a17c1d77689d93ccc} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!assign\_task\_to\_elevator@{assign\_task\_to\_elevator}}
\index{assign\_task\_to\_elevator@{assign\_task\_to\_elevator}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{assign\_task\_to\_elevator()}
{\footnotesize\ttfamily void assign\+\_\+task\+\_\+to\+\_\+elevator (\begin{DoxyParamCaption}\item[{\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group,  }\item[{const char $\ast$}]{elevator\+\_\+id\+\_\+to\+\_\+update,  }\item[{const char $\ast$}]{task\+\_\+id,  }\item[{int}]{target\+\_\+floor,  }\item[{int}]{current\+\_\+request\+\_\+floor }\end{DoxyParamCaption})}



Actualiza el estado de un ascensor tras recibir asignación de tarea. 


\begin{DoxyParams}{Parameters}
{\em group} & Puntero al grupo de ascensores \\
\hline
{\em elevator\+\_\+id\+\_\+to\+\_\+update} & ID del ascensor a actualizar \\
\hline
{\em task\+\_\+id} & El nuevo ID de tarea asignado \\
\hline
{\em target\+\_\+floor} & El piso destino para esta tarea \\
\hline
{\em current\+\_\+request\+\_\+floor} & El piso donde se originó la solicitud\\
\hline
\end{DoxyParams}
Esta función actualiza el estado de un ascensor específico después de recibir una asignación de tarea del servidor central. Establece la tarea, destino, dirección de movimiento y marca el ascensor como ocupado.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+status\+\_\+t}{p.}{structelevator__status__t} 
\end{DoxySeeAlso}
\label{elevator__state__manager_8h_aa035ebf813e4df0e747c251865f217db} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!door\_state\_to\_string@{door\_state\_to\_string}}
\index{door\_state\_to\_string@{door\_state\_to\_string}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{door\_state\_to\_string()}
{\footnotesize\ttfamily const char $\ast$ door\+\_\+state\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{\textbf{ door\+\_\+state\+\_\+enum\+\_\+t}}]{state }\end{DoxyParamCaption})}



Convierte un estado de puerta a su representación en string. 


\begin{DoxyParams}{Parameters}
{\em state} & Estado de puerta a convertir \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String representando el estado de la puerta
\end{DoxyReturn}
Función helper para convertir enumeraciones de estado de puerta a strings legibles para JSON y logging.

\begin{DoxySeeAlso}{See also}
\doxyref{door\+\_\+state\+\_\+enum\+\_\+t}{p.}{elevator__state__manager_8h_ab8ae21f2fd452f98f77170f3dc9e2786}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em state} & Estado de puerta a convertir \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String representando el estado de la puerta
\end{DoxyReturn}
Esta función proporciona una representación legible del estado de las puertas del ascensor para logging y serialización JSON.

Estados soportados\+:
\begin{DoxyItemize}
\item DOOR\+\_\+\+CLOSED\+: "{}\+CERRADA"{}
\item DOOR\+\_\+\+OPEN\+: "{}\+ABIERTA"{} ~\newline

\item DOOR\+\_\+\+OPENING\+: "{}\+ABRIENDO"{}
\item DOOR\+\_\+\+CLOSING\+: "{}\+CERRANDO"{}
\item Otros\+: "{}\+DESCONOCIDO"{} 
\end{DoxyItemize}\label{elevator__state__manager_8h_ab9cb3524ec8747ce92dc01657dbb7a5a} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!elevator\_group\_to\_json\_for\_server@{elevator\_group\_to\_json\_for\_server}}
\index{elevator\_group\_to\_json\_for\_server@{elevator\_group\_to\_json\_for\_server}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{elevator\_group\_to\_json\_for\_server()}
{\footnotesize\ttfamily c\+JSON $\ast$ elevator\+\_\+group\+\_\+to\+\_\+json\+\_\+for\+\_\+server (\begin{DoxyParamCaption}\item[{const \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group,  }\item[{\textbf{ gw\+\_\+request\+\_\+type\+\_\+t}}]{request\+\_\+type,  }\item[{const \textbf{ api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t} $\ast$}]{details }\end{DoxyParamCaption})}



Serializa el estado del grupo de ascensores a JSON para el servidor central. 


\begin{DoxyParams}{Parameters}
{\em group} & Puntero al estado del grupo de ascensores \\
\hline
{\em request\+\_\+type} & El tipo de la solicitud original que motiva este payload \\
\hline
{\em details} & Puntero a estructura con detalles específicos de la solicitud (puede ser NULL) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero a objeto c\+JSON que representa el payload, o NULL en caso de error
\end{DoxyReturn}
Esta función convierte el estado completo del grupo de ascensores y los detalles de la solicitud específica a un objeto JSON formateado como espera el servidor central para procesamiento de asignaciones.

El llamador es responsable de liberar el objeto c\+JSON con c\+JSON\+\_\+\+Delete().

\begin{DoxySeeAlso}{See also}
\doxyref{gw\+\_\+request\+\_\+type\+\_\+t}{p.}{elevator__state__manager_8h_a17e4539046553af2ffabda67ff75cbb0} 

\doxyref{api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t}{p.}{structapi__request__details__for__json__t} 
\end{DoxySeeAlso}
\label{elevator__state__manager_8h_ad1f96394c1b8256e78409c71a912eea1} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!init\_elevator\_group@{init\_elevator\_group}}
\index{init\_elevator\_group@{init\_elevator\_group}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{init\_elevator\_group()}
{\footnotesize\ttfamily void init\+\_\+elevator\+\_\+group (\begin{DoxyParamCaption}\item[{\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group,  }\item[{const char $\ast$}]{edificio\+\_\+id\+\_\+str,  }\item[{int}]{num\+\_\+elevadores,  }\item[{int}]{num\+\_\+pisos }\end{DoxyParamCaption})}



Inicializa el estado de un grupo de ascensores. 


\begin{DoxyParams}{Parameters}
{\em group} & Puntero al grupo de ascensores a inicializar \\
\hline
{\em edificio\+\_\+id\+\_\+str} & El ID del edificio (ej\+: "{}\+E1"{}) \\
\hline
{\em num\+\_\+elevadores} & El número de ascensores en este grupo \\
\hline
{\em num\+\_\+pisos} & El número total de pisos en el edificio\\
\hline
\end{DoxyParams}
Esta función inicializa completamente un grupo de ascensores con la configuración especificada, estableciendo IDs únicos, posiciones iniciales y estados por defecto para todos los ascensores.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+status\+\_\+t}{p.}{structelevator__status__t}
\end{DoxySeeAlso}
Inicializa el estado de un grupo de ascensores.


\begin{DoxyParams}{Parameters}
{\em group} & Puntero al grupo de ascensores a inicializar \\
\hline
{\em edificio\+\_\+id\+\_\+str} & ID del edificio al que pertenece el grupo \\
\hline
{\em num\+\_\+elevadores} & Número de ascensores en el grupo \\
\hline
{\em num\+\_\+pisos} & Número de pisos del edificio\\
\hline
\end{DoxyParams}
Esta función inicializa completamente un grupo de ascensores con la configuración especificada. Realiza las siguientes operaciones\+:


\begin{DoxyEnumerate}
\item {\bfseries{Validación}}\+: Verifica parámetros de entrada válidos
\item {\bfseries{Limpieza}}\+: Inicializa la estructura a cero
\item {\bfseries{Configuración del grupo}}\+: Establece ID del edificio y número de ascensores
\item {\bfseries{Inicialización individual}}\+: Configura cada ascensor con\+:
\begin{DoxyItemize}
\item ID único (formato\+: \{edificio\+\_\+id\}A\{numero\})
\item Piso inicial\+: 0 (planta baja)
\item Puertas cerradas
\item Sin tarea asignada
\item Estado parado y disponible
\end{DoxyItemize}
\end{DoxyEnumerate}

\begin{DoxyNote}{Note}
El número de ascensores debe estar entre 1 y MAX\+\_\+\+ELEVATORS\+\_\+\+PER\+\_\+\+GATEWAY 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+status\+\_\+t}{p.}{structelevator__status__t} 
\end{DoxySeeAlso}
\label{elevator__state__manager_8h_a9f8c127c735277e87e71a52ba68d2e56} 
\index{elevator\_state\_manager.h@{elevator\_state\_manager.h}!movement\_direction\_to\_string@{movement\_direction\_to\_string}}
\index{movement\_direction\_to\_string@{movement\_direction\_to\_string}!elevator\_state\_manager.h@{elevator\_state\_manager.h}}
\doxysubsubsection{movement\_direction\_to\_string()}
{\footnotesize\ttfamily const char $\ast$ movement\+\_\+direction\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t}}]{direction }\end{DoxyParamCaption})}



Convierte una dirección de movimiento a su representación en string. 


\begin{DoxyParams}{Parameters}
{\em direction} & Dirección de movimiento a convertir \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String representando la dirección de movimiento
\end{DoxyReturn}
Función helper para convertir enumeraciones de dirección de movimiento a strings legibles para JSON y logging.

\begin{DoxySeeAlso}{See also}
\doxyref{movement\+\_\+direction\+\_\+enum\+\_\+t}{p.}{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01}
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em direction} & Dirección de movimiento a convertir \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String representando la dirección de movimiento
\end{DoxyReturn}
Esta función proporciona una representación legible de la dirección de movimiento del ascensor para logging y serialización JSON.

Direcciones soportadas\+:
\begin{DoxyItemize}
\item MOVING\+\_\+\+UP\+: "{}\+SUBIENDO"{}
\item MOVING\+\_\+\+DOWN\+: "{}\+BAJANDO"{}
\item STOPPED\+: "{}\+PARADO"{}
\item Otros\+: "{}\+DESCONOCIDO"{} 
\end{DoxyItemize}
\subsection{execution\_logger}
\doxysection{include/api\+\_\+gateway/execution\+\_\+logger.h File Reference}
\label{execution__logger_8h}\index{include/api\_gateway/execution\_logger.h@{include/api\_gateway/execution\_logger.h}}


Sistema de Logging de Ejecuciones para Resultados de TFG.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ log\+\_\+event\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura de un evento de log. \end{DoxyCompactList}\item 
struct \textbf{ execution\+\_\+stats\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estadísticas de ejecución. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ log\+\_\+event\+\_\+type\+\_\+t} \{ \newline
\textbf{ LOG\+\_\+\+EVENT\+\_\+\+SYSTEM\+\_\+\+START}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+SYSTEM\+\_\+\+END}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+SIMULATION\+\_\+\+START}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+SIMULATION\+\_\+\+END}
, \newline
\textbf{ LOG\+\_\+\+EVENT\+\_\+\+BUILDING\+\_\+\+SELECTED}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+CAN\+\_\+\+SENT}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+CAN\+\_\+\+RECEIVED}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+COAP\+\_\+\+SENT}
, \newline
\textbf{ LOG\+\_\+\+EVENT\+\_\+\+COAP\+\_\+\+RECEIVED}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+TASK\+\_\+\+ASSIGNED}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+ELEVATOR\+\_\+\+MOVED}
, \textbf{ LOG\+\_\+\+EVENT\+\_\+\+TASK\+\_\+\+COMPLETED}
, \newline
\textbf{ LOG\+\_\+\+EVENT\+\_\+\+ERROR}
 \}
\begin{DoxyCompactList}\small\item\em Tipos de eventos que se pueden registrar. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \textbf{ exec\+\_\+logger\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Inicializa el sistema de logging de ejecuciones. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+finish} (void)
\begin{DoxyCompactList}\small\item\em Finaliza el sistema de logging y cierra el archivo. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+event} (\textbf{ log\+\_\+event\+\_\+type\+\_\+t} type, const char $\ast$description, const char $\ast$details)
\begin{DoxyCompactList}\small\item\em Registra un evento en el log. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+start} (const char $\ast$building\+\_\+id, int num\+\_\+requests)
\begin{DoxyCompactList}\small\item\em Registra el inicio de la simulación. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+end} (int successful\+\_\+requests, int total\+\_\+requests)
\begin{DoxyCompactList}\small\item\em Registra el fin de la simulación. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+sent} (unsigned int can\+\_\+id, int dlc, const unsigned char $\ast$data, const char $\ast$description)
\begin{DoxyCompactList}\small\item\em Registra un frame CAN enviado. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+received} (unsigned int can\+\_\+id, int dlc, const unsigned char $\ast$data, const char $\ast$description)
\begin{DoxyCompactList}\small\item\em Registra un frame CAN recibido. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+sent} (const char $\ast$method, const char $\ast$uri, const char $\ast$payload)
\begin{DoxyCompactList}\small\item\em Registra una petición Co\+AP enviada. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+received} (const char $\ast$code, const char $\ast$payload)
\begin{DoxyCompactList}\small\item\em Registra una respuesta Co\+AP recibida. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+assigned} (const char $\ast$task\+\_\+id, const char $\ast$elevator\+\_\+id, int target\+\_\+floor)
\begin{DoxyCompactList}\small\item\em Registra la asignación de una tarea. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+elevator\+\_\+moved} (const char $\ast$elevator\+\_\+id, int from\+\_\+floor, int to\+\_\+floor, const char $\ast$direction)
\begin{DoxyCompactList}\small\item\em Registra el movimiento de un ascensor. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+completed} (const char $\ast$task\+\_\+id, const char $\ast$elevator\+\_\+id, int final\+\_\+floor)
\begin{DoxyCompactList}\small\item\em Registra la completación de una tarea. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+error} (const char $\ast$error\+\_\+code, const char $\ast$error\+\_\+message)
\begin{DoxyCompactList}\small\item\em Registra un error del sistema. \end{DoxyCompactList}\item 
const \textbf{ execution\+\_\+stats\+\_\+t} $\ast$ \textbf{ exec\+\_\+logger\+\_\+get\+\_\+stats} (void)
\begin{DoxyCompactList}\small\item\em Obtiene las estadísticas actuales de ejecución. \end{DoxyCompactList}\item 
bool \textbf{ exec\+\_\+logger\+\_\+is\+\_\+active} (void)
\begin{DoxyCompactList}\small\item\em Verifica si el logger está activo. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Sistema de Logging de Ejecuciones para Resultados de TFG. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0
\end{DoxyVersion}
Este módulo implementa un sistema de logging avanzado que genera archivos Markdown con el flujo completo de comunicación del API Gateway.

{\bfseries{Características\+:}}
\begin{DoxyItemize}
\item Archivos organizados por fecha (carpetas por día)
\item Formato Markdown para visualización bonita
\item Captura de eventos Co\+AP, CAN y simulación
\item Estadísticas automáticas de rendimiento
\item Timestamps precisos para cada evento
\end{DoxyItemize}

{\bfseries{Estructura de archivos\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{api\_gateway/logs/YYYY-\/MM-\/DD/ejecucion\_HH-\/MM-\/SS.md}

\end{DoxyCode}
 

\doxysubsection{Enumeration Type Documentation}
\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476} 
\index{execution\_logger.h@{execution\_logger.h}!log\_event\_type\_t@{log\_event\_type\_t}}
\index{log\_event\_type\_t@{log\_event\_type\_t}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{log\_event\_type\_t}
{\footnotesize\ttfamily enum \textbf{ log\+\_\+event\+\_\+type\+\_\+t}}



Tipos de eventos que se pueden registrar. 

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_SYSTEM\_START@{LOG\_EVENT\_SYSTEM\_START}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_SYSTEM\_START@{LOG\_EVENT\_SYSTEM\_START}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a35100a84f631a83c88779e15de4dd5a5} 
LOG\+\_\+\+EVENT\+\_\+\+SYSTEM\+\_\+\+START&Inicio del sistema. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_SYSTEM\_END@{LOG\_EVENT\_SYSTEM\_END}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_SYSTEM\_END@{LOG\_EVENT\_SYSTEM\_END}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476adbaf6c292d00660b1ea66b2dc01fd7e8} 
LOG\+\_\+\+EVENT\+\_\+\+SYSTEM\+\_\+\+END&Fin del sistema. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_SIMULATION\_START@{LOG\_EVENT\_SIMULATION\_START}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_SIMULATION\_START@{LOG\_EVENT\_SIMULATION\_START}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476af12e383c8319384656377a3686907d83} 
LOG\+\_\+\+EVENT\+\_\+\+SIMULATION\+\_\+\+START&Inicio de simulación. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_SIMULATION\_END@{LOG\_EVENT\_SIMULATION\_END}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_SIMULATION\_END@{LOG\_EVENT\_SIMULATION\_END}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a7480cc8f26553373c14b83d37d558a43} 
LOG\+\_\+\+EVENT\+\_\+\+SIMULATION\+\_\+\+END&Fin de simulación. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_BUILDING\_SELECTED@{LOG\_EVENT\_BUILDING\_SELECTED}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_BUILDING\_SELECTED@{LOG\_EVENT\_BUILDING\_SELECTED}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a6ab85735087bfe114cdee395bb6e9752} 
LOG\+\_\+\+EVENT\+\_\+\+BUILDING\+\_\+\+SELECTED&Edificio seleccionado para simulación. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_CAN\_SENT@{LOG\_EVENT\_CAN\_SENT}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_CAN\_SENT@{LOG\_EVENT\_CAN\_SENT}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a2b3a6f95a056f0eebc7abdd1a618a28c} 
LOG\+\_\+\+EVENT\+\_\+\+CAN\+\_\+\+SENT&Frame CAN enviado. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_CAN\_RECEIVED@{LOG\_EVENT\_CAN\_RECEIVED}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_CAN\_RECEIVED@{LOG\_EVENT\_CAN\_RECEIVED}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a150e0c669e230ce2ca5d4b995d88a23c} 
LOG\+\_\+\+EVENT\+\_\+\+CAN\+\_\+\+RECEIVED&Frame CAN recibido. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_COAP\_SENT@{LOG\_EVENT\_COAP\_SENT}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_COAP\_SENT@{LOG\_EVENT\_COAP\_SENT}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a2fcb5d5ee3be450f0dc865819195baef} 
LOG\+\_\+\+EVENT\+\_\+\+COAP\+\_\+\+SENT&Mensaje Co\+AP enviado. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_COAP\_RECEIVED@{LOG\_EVENT\_COAP\_RECEIVED}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_COAP\_RECEIVED@{LOG\_EVENT\_COAP\_RECEIVED}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476aa271050c34a516b9afebabeff234627a} 
LOG\+\_\+\+EVENT\+\_\+\+COAP\+\_\+\+RECEIVED&Mensaje Co\+AP recibido. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_TASK\_ASSIGNED@{LOG\_EVENT\_TASK\_ASSIGNED}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_TASK\_ASSIGNED@{LOG\_EVENT\_TASK\_ASSIGNED}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a31d29d1f11673e326183f9ff663fdd7f} 
LOG\+\_\+\+EVENT\+\_\+\+TASK\+\_\+\+ASSIGNED&Tarea asignada a ascensor. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_ELEVATOR\_MOVED@{LOG\_EVENT\_ELEVATOR\_MOVED}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_ELEVATOR\_MOVED@{LOG\_EVENT\_ELEVATOR\_MOVED}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476a6972700cc9230e5a515978a000fd4239} 
LOG\+\_\+\+EVENT\+\_\+\+ELEVATOR\+\_\+\+MOVED&Ascensor se movió \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_TASK\_COMPLETED@{LOG\_EVENT\_TASK\_COMPLETED}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_TASK\_COMPLETED@{LOG\_EVENT\_TASK\_COMPLETED}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476acfe1883cd1b1e89b8e3c139bb505c5ff} 
LOG\+\_\+\+EVENT\+\_\+\+TASK\+\_\+\+COMPLETED&Tarea completada. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{LOG\_EVENT\_ERROR@{LOG\_EVENT\_ERROR}!execution\_logger.h@{execution\_logger.h}}\index{execution\_logger.h@{execution\_logger.h}!LOG\_EVENT\_ERROR@{LOG\_EVENT\_ERROR}}}\label{execution__logger_8h_a550af63f434a6964e161bc1f5bfe4476ab208c51d3dfb4a2f2b8381a1c6898784} 
LOG\+\_\+\+EVENT\+\_\+\+ERROR&Error del sistema. \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\label{execution__logger_8h_ae0868cf99c3976e5054e296a99a865a8} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_finish@{exec\_logger\_finish}}
\index{exec\_logger\_finish@{exec\_logger\_finish}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_finish()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+finish (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Finaliza el sistema de logging y cierra el archivo. 

Esta función\+:
\begin{DoxyItemize}
\item Calcula estadísticas finales
\item Escribe el resumen de ejecución
\item Cierra el archivo de log
\item Limpia recursos 
\end{DoxyItemize}\label{execution__logger_8h_a5fdd5443b630dc1afbbc2c528b6eae89} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_get\_stats@{exec\_logger\_get\_stats}}
\index{exec\_logger\_get\_stats@{exec\_logger\_get\_stats}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_get\_stats()}
{\footnotesize\ttfamily const \textbf{ execution\+\_\+stats\+\_\+t} $\ast$ exec\+\_\+logger\+\_\+get\+\_\+stats (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Obtiene las estadísticas actuales de ejecución. 

\begin{DoxyReturn}{Returns}
Puntero a las estadísticas (solo lectura) 
\end{DoxyReturn}
\label{execution__logger_8h_a8f17ab3d08e18defbc6bc3894b87ad57} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_init@{exec\_logger\_init}}
\index{exec\_logger\_init@{exec\_logger\_init}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_init()}
{\footnotesize\ttfamily bool exec\+\_\+logger\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Inicializa el sistema de logging de ejecuciones. 

\begin{DoxyReturn}{Returns}
true si se inicializó correctamente, false en caso de error
\end{DoxyReturn}
Esta función\+:
\begin{DoxyItemize}
\item Crea las carpetas necesarias por fecha
\item Genera el nombre del archivo de log
\item Inicializa las estructuras de estadísticas
\item Escribe el header del archivo Markdown 
\end{DoxyItemize}\label{execution__logger_8h_a5ce893b0367275087161fc41ee3ea01b} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_is\_active@{exec\_logger\_is\_active}}
\index{exec\_logger\_is\_active@{exec\_logger\_is\_active}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_is\_active()}
{\footnotesize\ttfamily bool exec\+\_\+logger\+\_\+is\+\_\+active (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Verifica si el logger está activo. 

\begin{DoxyReturn}{Returns}
true si está activo, false si no 
\end{DoxyReturn}
\label{execution__logger_8h_ae52f012f4fc98b850c48a36881f5ef4b} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_can\_received@{exec\_logger\_log\_can\_received}}
\index{exec\_logger\_log\_can\_received@{exec\_logger\_log\_can\_received}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_can\_received()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+received (\begin{DoxyParamCaption}\item[{unsigned int}]{can\+\_\+id,  }\item[{int}]{dlc,  }\item[{const unsigned char $\ast$}]{data,  }\item[{const char $\ast$}]{description }\end{DoxyParamCaption})}



Registra un frame CAN recibido. 


\begin{DoxyParams}{Parameters}
{\em can\+\_\+id} & ID del frame CAN \\
\hline
{\em dlc} & Longitud de datos \\
\hline
{\em data} & Datos del frame \\
\hline
{\em description} & Descripción del evento \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_aa27056e265d9a0470c136c31fbb3e9d0} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_can\_sent@{exec\_logger\_log\_can\_sent}}
\index{exec\_logger\_log\_can\_sent@{exec\_logger\_log\_can\_sent}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_can\_sent()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+sent (\begin{DoxyParamCaption}\item[{unsigned int}]{can\+\_\+id,  }\item[{int}]{dlc,  }\item[{const unsigned char $\ast$}]{data,  }\item[{const char $\ast$}]{description }\end{DoxyParamCaption})}



Registra un frame CAN enviado. 


\begin{DoxyParams}{Parameters}
{\em can\+\_\+id} & ID del frame CAN \\
\hline
{\em dlc} & Longitud de datos \\
\hline
{\em data} & Datos del frame \\
\hline
{\em description} & Descripción del evento \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_ad0470fcf53f9a93e9c78e3f663b6606a} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_coap\_received@{exec\_logger\_log\_coap\_received}}
\index{exec\_logger\_log\_coap\_received@{exec\_logger\_log\_coap\_received}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_coap\_received()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+received (\begin{DoxyParamCaption}\item[{const char $\ast$}]{code,  }\item[{const char $\ast$}]{payload }\end{DoxyParamCaption})}



Registra una respuesta Co\+AP recibida. 


\begin{DoxyParams}{Parameters}
{\em code} & Código de respuesta Co\+AP \\
\hline
{\em payload} & Payload de la respuesta (puede ser NULL) \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_a529e2cea53c04d196f94d5165ce2f2da} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_coap\_sent@{exec\_logger\_log\_coap\_sent}}
\index{exec\_logger\_log\_coap\_sent@{exec\_logger\_log\_coap\_sent}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_coap\_sent()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+sent (\begin{DoxyParamCaption}\item[{const char $\ast$}]{method,  }\item[{const char $\ast$}]{uri,  }\item[{const char $\ast$}]{payload }\end{DoxyParamCaption})}



Registra una petición Co\+AP enviada. 


\begin{DoxyParams}{Parameters}
{\em method} & Método Co\+AP (GET, POST, etc.) \\
\hline
{\em uri} & URI del recurso \\
\hline
{\em payload} & Payload de la petición (puede ser NULL) \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_ac0d70f4be37b4af70a10aba97fd4f448} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_elevator\_moved@{exec\_logger\_log\_elevator\_moved}}
\index{exec\_logger\_log\_elevator\_moved@{exec\_logger\_log\_elevator\_moved}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_elevator\_moved()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+elevator\+\_\+moved (\begin{DoxyParamCaption}\item[{const char $\ast$}]{elevator\+\_\+id,  }\item[{int}]{from\+\_\+floor,  }\item[{int}]{to\+\_\+floor,  }\item[{const char $\ast$}]{direction }\end{DoxyParamCaption})}



Registra el movimiento de un ascensor. 


\begin{DoxyParams}{Parameters}
{\em elevator\+\_\+id} & ID del ascensor \\
\hline
{\em from\+\_\+floor} & Piso origen \\
\hline
{\em to\+\_\+floor} & Piso destino \\
\hline
{\em direction} & Dirección del movimiento \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_af6629562e75625c3758a34ef00d93f34} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_error@{exec\_logger\_log\_error}}
\index{exec\_logger\_log\_error@{exec\_logger\_log\_error}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_error()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+error (\begin{DoxyParamCaption}\item[{const char $\ast$}]{error\+\_\+code,  }\item[{const char $\ast$}]{error\+\_\+message }\end{DoxyParamCaption})}



Registra un error del sistema. 


\begin{DoxyParams}{Parameters}
{\em error\+\_\+code} & Código de error \\
\hline
{\em error\+\_\+message} & Mensaje de error \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_a0d26263b498931ad084d10c45b1e2280} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_event@{exec\_logger\_log\_event}}
\index{exec\_logger\_log\_event@{exec\_logger\_log\_event}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_event()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+event (\begin{DoxyParamCaption}\item[{\textbf{ log\+\_\+event\+\_\+type\+\_\+t}}]{type,  }\item[{const char $\ast$}]{description,  }\item[{const char $\ast$}]{details }\end{DoxyParamCaption})}



Registra un evento en el log. 


\begin{DoxyParams}{Parameters}
{\em type} & Tipo de evento \\
\hline
{\em description} & Descripción breve del evento \\
\hline
{\em details} & Detalles adicionales (puede ser NULL) \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_a502b75cee9921726287da66a1973d0c0} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_simulation\_end@{exec\_logger\_log\_simulation\_end}}
\index{exec\_logger\_log\_simulation\_end@{exec\_logger\_log\_simulation\_end}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_simulation\_end()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+end (\begin{DoxyParamCaption}\item[{int}]{successful\+\_\+requests,  }\item[{int}]{total\+\_\+requests }\end{DoxyParamCaption})}



Registra el fin de la simulación. 


\begin{DoxyParams}{Parameters}
{\em successful\+\_\+requests} & Número de peticiones exitosas \\
\hline
{\em total\+\_\+requests} & Número total de peticiones \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_afe36ef96b0a0346e8f389ddd550d1d62} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_simulation\_start@{exec\_logger\_log\_simulation\_start}}
\index{exec\_logger\_log\_simulation\_start@{exec\_logger\_log\_simulation\_start}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_simulation\_start()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+start (\begin{DoxyParamCaption}\item[{const char $\ast$}]{building\+\_\+id,  }\item[{int}]{num\+\_\+requests }\end{DoxyParamCaption})}



Registra el inicio de la simulación. 


\begin{DoxyParams}{Parameters}
{\em building\+\_\+id} & ID del edificio seleccionado \\
\hline
{\em num\+\_\+requests} & Número de peticiones a ejecutar \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_ac545eb869f25dc8a259c8cc8d79012be} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_task\_assigned@{exec\_logger\_log\_task\_assigned}}
\index{exec\_logger\_log\_task\_assigned@{exec\_logger\_log\_task\_assigned}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_task\_assigned()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+assigned (\begin{DoxyParamCaption}\item[{const char $\ast$}]{task\+\_\+id,  }\item[{const char $\ast$}]{elevator\+\_\+id,  }\item[{int}]{target\+\_\+floor }\end{DoxyParamCaption})}



Registra la asignación de una tarea. 


\begin{DoxyParams}{Parameters}
{\em task\+\_\+id} & ID de la tarea \\
\hline
{\em elevator\+\_\+id} & ID del ascensor asignado \\
\hline
{\em target\+\_\+floor} & Piso destino \\
\hline
\end{DoxyParams}
\label{execution__logger_8h_a22e3151602bf4070c2c7ffa9fe505487} 
\index{execution\_logger.h@{execution\_logger.h}!exec\_logger\_log\_task\_completed@{exec\_logger\_log\_task\_completed}}
\index{exec\_logger\_log\_task\_completed@{exec\_logger\_log\_task\_completed}!execution\_logger.h@{execution\_logger.h}}
\doxysubsubsection{exec\_logger\_log\_task\_completed()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+completed (\begin{DoxyParamCaption}\item[{const char $\ast$}]{task\+\_\+id,  }\item[{const char $\ast$}]{elevator\+\_\+id,  }\item[{int}]{final\+\_\+floor }\end{DoxyParamCaption})}



Registra la completación de una tarea. 


\begin{DoxyParams}{Parameters}
{\em task\+\_\+id} & ID de la tarea completada \\
\hline
{\em elevator\+\_\+id} & ID del ascensor que completó la tarea \\
\hline
{\em final\+\_\+floor} & Piso final donde se completó \\
\hline
\end{DoxyParams}

\subsection{include\_2api\_gateway\_2api\_handlers}
\doxysection{include/api\+\_\+gateway/api\+\_\+handlers.h File Reference}
\label{include_2api__gateway_2api__handlers_8h}\index{include/api\_gateway/api\_handlers.h@{include/api\_gateway/api\_handlers.h}}
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t}
\begin{DoxyCompactList}\small\item\em Tracks information from an original client (elevator) request OR a gateway-\/originated request. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t}
\begin{DoxyCompactList}\small\item\em Structure to track client requests forwarded to the central server. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
coap\+\_\+session\+\_\+t $\ast$ \textbf{ get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session} (struct coap\+\_\+context\+\_\+t $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Obtiene o crea una sesión DTLS con el servidor central. \end{DoxyCompactList}\item 
void \textbf{ handle\+\_\+sigint\+\_\+gw} (int signum)
\begin{DoxyCompactList}\small\item\em Manejador de señal para SIGINT (Ctrl+C) \end{DoxyCompactList}\item 
coap\+\_\+response\+\_\+t \textbf{ hnd\+\_\+central\+\_\+server\+\_\+response\+\_\+gw} (coap\+\_\+session\+\_\+t $\ast$session\+\_\+to\+\_\+central, const coap\+\_\+pdu\+\_\+t $\ast$sent\+\_\+to\+\_\+central, const coap\+\_\+pdu\+\_\+t $\ast$received\+\_\+from\+\_\+central, const coap\+\_\+mid\+\_\+t mid\+\_\+to\+\_\+central)
\begin{DoxyCompactList}\small\item\em Manejador de respuestas del servidor central. \end{DoxyCompactList}\item 
void \textbf{ hnd\+\_\+elevator\+\_\+api\+\_\+request\+\_\+gw} (coap\+\_\+resource\+\_\+t $\ast$resource, coap\+\_\+session\+\_\+t $\ast$elevator\+\_\+session, const coap\+\_\+pdu\+\_\+t $\ast$elevator\+\_\+request\+\_\+pdu, const coap\+\_\+string\+\_\+t $\ast$query, coap\+\_\+pdu\+\_\+t $\ast$response\+\_\+placeholder)
\begin{DoxyCompactList}\small\item\em Handler for legacy elevator API requests (e.\+g., /peticion\+\_\+ascensor). Currently logs and discards such requests. \end{DoxyCompactList}\item 
void \textbf{ hnd\+\_\+cabin\+\_\+request\+\_\+from\+\_\+elevator\+\_\+gw} (coap\+\_\+resource\+\_\+t $\ast$resource, coap\+\_\+session\+\_\+t $\ast$elevator\+\_\+session, const coap\+\_\+pdu\+\_\+t $\ast$elevator\+\_\+request\+\_\+pdu, const coap\+\_\+string\+\_\+t $\ast$query, coap\+\_\+pdu\+\_\+t $\ast$response\+\_\+placeholder)
\begin{DoxyCompactList}\small\item\em Handler for cabin requests from elevator clients. Path\+: GW\+\_\+\+CABIN\+\_\+\+REQUEST\+\_\+\+PATH (e.\+g., /solicitud\+\_\+cabina\+\_\+gw) Parses query params\+: elevator\+\_\+id, target\+\_\+floor. \end{DoxyCompactList}\item 
void \textbf{ hnd\+\_\+floor\+\_\+call\+\_\+from\+\_\+elevator\+\_\+gw} (coap\+\_\+resource\+\_\+t $\ast$resource, coap\+\_\+session\+\_\+t $\ast$elevator\+\_\+session, const coap\+\_\+pdu\+\_\+t $\ast$elevator\+\_\+request\+\_\+pdu, const coap\+\_\+string\+\_\+t $\ast$query, coap\+\_\+pdu\+\_\+t $\ast$response\+\_\+placeholder)
\begin{DoxyCompactList}\small\item\em Handler for floor calls from elevator clients/external. Path\+: GW\+\_\+\+FLOOR\+\_\+\+CALL\+\_\+\+PATH (e.\+g., /llamada\+\_\+piso\+\_\+gw) Parses query params\+: floor, dir (UP/\+DOWN) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile sig\+\_\+atomic\+\_\+t \textbf{ quit\+\_\+main\+\_\+loop}
\begin{DoxyCompactList}\small\item\em Bandera global para controlar el bucle principal de la aplicación. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Typedef Documentation}
\label{include_2api__gateway_2api__handlers_8h_a35ab69cb8840cd418c5fe093acdbb57c} 
\index{api\_handlers.h@{api\_handlers.h}!api\_request\_tracker\_t@{api\_request\_tracker\_t}}
\index{api\_request\_tracker\_t@{api\_request\_tracker\_t}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{api\_request\_tracker\_t}
{\footnotesize\ttfamily typedef struct \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t}}



Structure to track client requests forwarded to the central server. 

This structure holds information about an original client request that the API Gateway has forwarded to the central server. It is used to correlate the server\textquotesingle{}s response back to the original client session and to manage state or context related to the request. 

\doxysubsection{Function Documentation}
\label{include_2api__gateway_2api__handlers_8h_a86ad67d9e4f5e5bff1724c17232dc0ff} 
\index{api\_handlers.h@{api\_handlers.h}!get\_or\_create\_central\_server\_dtls\_session@{get\_or\_create\_central\_server\_dtls\_session}}
\index{get\_or\_create\_central\_server\_dtls\_session@{get\_or\_create\_central\_server\_dtls\_session}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{get\_or\_create\_central\_server\_dtls\_session()}
{\footnotesize\ttfamily coap\+\_\+session\+\_\+t $\ast$ get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session (\begin{DoxyParamCaption}\item[{coap\+\_\+context\+\_\+t $\ast$}]{ctx }\end{DoxyParamCaption})}



Obtiene o crea una sesión DTLS con el servidor central. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Contexto Co\+AP a utilizar para la sesión \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero a la sesión DTLS establecida, o NULL en caso de error
\end{DoxyReturn}
Esta función implementa un patrón singleton para la gestión de sesiones DTLS con el servidor central. Reutiliza sesiones existentes cuando están activas y crea nuevas sesiones cuando es necesario.

Comportamiento\+:
\begin{DoxyEnumerate}
\item Si existe una sesión activa y establecida, la reutiliza
\item Si la sesión existe pero no está establecida, la libera y crea una nueva
\item Si no existe sesión, crea una nueva con configuración DTLS-\/\+PSK
\item Registra el manejador de eventos para gestión automática de la sesión
\end{DoxyEnumerate}

La función utiliza las siguientes configuraciones\+:
\begin{DoxyItemize}
\item IP del servidor\+: CENTRAL\+\_\+\+SERVER\+\_\+\+IP
\item Puerto del servidor\+: CENTRAL\+\_\+\+SERVER\+\_\+\+PORT ~\newline

\item Identidad PSK\+: IDENTITY\+\_\+\+TO\+\_\+\+PRESENT\+\_\+\+TO\+\_\+\+SERVER
\item Clave PSK\+: KEY\+\_\+\+FOR\+\_\+\+SERVER
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{event\+\_\+handler\+\_\+gw()}{p.}{main_8c_a4d72c24b61707ff5f39a4123ca8cd833} 

\doxyref{coap\+\_\+config.\+h}{p.}{coap__config_8h} 
\end{DoxySeeAlso}
\label{include_2api__gateway_2api__handlers_8h_a7fd01dcda5b603f45f20d97c84d9260b} 
\index{api\_handlers.h@{api\_handlers.h}!handle\_sigint\_gw@{handle\_sigint\_gw}}
\index{handle\_sigint\_gw@{handle\_sigint\_gw}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{handle\_sigint\_gw()}
{\footnotesize\ttfamily void handle\+\_\+sigint\+\_\+gw (\begin{DoxyParamCaption}\item[{int}]{signum }\end{DoxyParamCaption})}



Manejador de señal para SIGINT (Ctrl+C) 

Signal handler for SIGINT (Ctrl+C) to allow graceful shutdown.


\begin{DoxyParams}{Parameters}
{\em signum} & Número de señal recibida (se espera SIGINT). No utilizado.\\
\hline
\end{DoxyParams}
Establece la bandera quit\+\_\+main\+\_\+loop a 1 para señalar al bucle principal de eventos que debe terminar, permitiendo una terminación elegante del API Gateway.

Esta función es registrada como manejador de SIGINT en \doxyref{main.\+c}{p.}{main_8c} y proporciona una forma limpia de cerrar la aplicación. \label{include_2api__gateway_2api__handlers_8h_a053f34293ce0f5e920e378b1cd18789e} 
\index{api\_handlers.h@{api\_handlers.h}!hnd\_cabin\_request\_from\_elevator\_gw@{hnd\_cabin\_request\_from\_elevator\_gw}}
\index{hnd\_cabin\_request\_from\_elevator\_gw@{hnd\_cabin\_request\_from\_elevator\_gw}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{hnd\_cabin\_request\_from\_elevator\_gw()}
{\footnotesize\ttfamily void hnd\+\_\+cabin\+\_\+request\+\_\+from\+\_\+elevator\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+resource\+\_\+t $\ast$}]{resource,  }\item[{coap\+\_\+session\+\_\+t $\ast$}]{elevator\+\_\+session,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{elevator\+\_\+request\+\_\+pdu,  }\item[{const coap\+\_\+string\+\_\+t $\ast$}]{query,  }\item[{coap\+\_\+pdu\+\_\+t $\ast$}]{response\+\_\+placeholder }\end{DoxyParamCaption})}



Handler for cabin requests from elevator clients. Path\+: GW\+\_\+\+CABIN\+\_\+\+REQUEST\+\_\+\+PATH (e.\+g., /solicitud\+\_\+cabina\+\_\+gw) Parses query params\+: elevator\+\_\+id, target\+\_\+floor. 

\label{include_2api__gateway_2api__handlers_8h_aba27754223447346d8049fc61efcd6f8} 
\index{api\_handlers.h@{api\_handlers.h}!hnd\_central\_server\_response\_gw@{hnd\_central\_server\_response\_gw}}
\index{hnd\_central\_server\_response\_gw@{hnd\_central\_server\_response\_gw}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{hnd\_central\_server\_response\_gw()}
{\footnotesize\ttfamily coap\+\_\+response\+\_\+t hnd\+\_\+central\+\_\+server\+\_\+response\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+session\+\_\+t $\ast$}]{session\+\_\+from\+\_\+server,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{sent\+\_\+to\+\_\+central,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{received\+\_\+from\+\_\+central,  }\item[{const coap\+\_\+mid\+\_\+t}]{mid\+\_\+from\+\_\+server }\end{DoxyParamCaption})}



Manejador de respuestas del servidor central. 

Handles responses received from the Central Server.


\begin{DoxyParams}{Parameters}
{\em session\+\_\+from\+\_\+server} & Sesión Co\+AP desde la cual se recibió la respuesta \\
\hline
{\em sent\+\_\+to\+\_\+central} & PDU que fue enviado al servidor central \\
\hline
{\em received\+\_\+from\+\_\+central} & PDU recibido del servidor central \\
\hline
{\em mid\+\_\+from\+\_\+server} & Message ID de la respuesta del servidor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
COAP\+\_\+\+RESPONSE\+\_\+\+OK si la respuesta se procesó correctamente
\end{DoxyReturn}
Esta función procesa las respuestas recibidas del servidor central para solicitudes de asignación de ascensores. Realiza las siguientes operaciones\+:


\begin{DoxyEnumerate}
\item {\bfseries{Validación}}\+: Verifica que se recibió un PDU válido
\item {\bfseries{Parsing JSON}}\+: Extrae y parsea el payload JSON de la respuesta
\item {\bfseries{Correlación}}\+: Encuentra el tracker original usando el token
\item {\bfseries{Procesamiento}}\+: Extrae información de asignación (ascensor\+\_\+asignado\+\_\+id, tarea\+\_\+id)
\item {\bfseries{Notificación CAN}}\+: Envía respuesta al controlador CAN correspondiente
\item {\bfseries{Limpieza}}\+: Libera recursos del tracker y memoria asociada
\end{DoxyEnumerate}

Maneja diferentes códigos de respuesta\+:
\begin{DoxyItemize}
\item 2.\+01 Created\+: Asignación exitosa
\item 4.\+xx Client Error\+: Errores de solicitud
\item 5.\+xx Server Error\+: Errores del servidor
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{add\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a7292f2cbff08db77c70629ddbac256dc} 

\doxyref{find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a5f19bc5f95b0869d7b25b596f6767877} 

\doxyref{can\+\_\+bridge.\+h}{p.}{can__bridge_8h} 
\end{DoxySeeAlso}
\label{include_2api__gateway_2api__handlers_8h_af5a21d636796fd0fe682efedb9420894} 
\index{api\_handlers.h@{api\_handlers.h}!hnd\_elevator\_api\_request\_gw@{hnd\_elevator\_api\_request\_gw}}
\index{hnd\_elevator\_api\_request\_gw@{hnd\_elevator\_api\_request\_gw}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{hnd\_elevator\_api\_request\_gw()}
{\footnotesize\ttfamily void hnd\+\_\+elevator\+\_\+api\+\_\+request\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+resource\+\_\+t $\ast$}]{resource,  }\item[{coap\+\_\+session\+\_\+t $\ast$}]{elevator\+\_\+session,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{elevator\+\_\+request\+\_\+pdu,  }\item[{const coap\+\_\+string\+\_\+t $\ast$}]{query,  }\item[{coap\+\_\+pdu\+\_\+t $\ast$}]{response\+\_\+placeholder }\end{DoxyParamCaption})}



Handler for legacy elevator API requests (e.\+g., /peticion\+\_\+ascensor). Currently logs and discards such requests. 

\label{include_2api__gateway_2api__handlers_8h_aadcce191828355c65cabd0862f5f5b4a} 
\index{api\_handlers.h@{api\_handlers.h}!hnd\_floor\_call\_from\_elevator\_gw@{hnd\_floor\_call\_from\_elevator\_gw}}
\index{hnd\_floor\_call\_from\_elevator\_gw@{hnd\_floor\_call\_from\_elevator\_gw}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{hnd\_floor\_call\_from\_elevator\_gw()}
{\footnotesize\ttfamily void hnd\+\_\+floor\+\_\+call\+\_\+from\+\_\+elevator\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+resource\+\_\+t $\ast$}]{resource,  }\item[{coap\+\_\+session\+\_\+t $\ast$}]{elevator\+\_\+session,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{elevator\+\_\+request\+\_\+pdu,  }\item[{const coap\+\_\+string\+\_\+t $\ast$}]{query,  }\item[{coap\+\_\+pdu\+\_\+t $\ast$}]{response\+\_\+placeholder }\end{DoxyParamCaption})}



Handler for floor calls from elevator clients/external. Path\+: GW\+\_\+\+FLOOR\+\_\+\+CALL\+\_\+\+PATH (e.\+g., /llamada\+\_\+piso\+\_\+gw) Parses query params\+: floor, dir (UP/\+DOWN) 



\doxysubsection{Variable Documentation}
\label{include_2api__gateway_2api__handlers_8h_a8a485bed3bbf69f7556aa3167043d7e2} 
\index{api\_handlers.h@{api\_handlers.h}!quit\_main\_loop@{quit\_main\_loop}}
\index{quit\_main\_loop@{quit\_main\_loop}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{quit\_main\_loop}
{\footnotesize\ttfamily volatile sig\+\_\+atomic\+\_\+t quit\+\_\+main\+\_\+loop\hspace{0.3cm}{\ttfamily [extern]}}



Bandera global para controlar el bucle principal de la aplicación. 

Bandera para indicar si el bucle principal debe terminar.

Esta bandera se establece a 1 por el manejador de señal SIGINT (handle\+\_\+sigint\+\_\+gw) para indicar que la aplicación debe terminar de manera elegante.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b}
\end{DoxySeeAlso}
Bandera global para controlar el bucle principal de la aplicación.

Esta variable se declara como extern en api\+\_\+handlers.\+h y se define en \doxyref{main.\+c}{p.}{main_8c}. Es establecida por el manejador de señal (handle\+\_\+sigint\+\_\+gw) para detener el bucle principal de eventos.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b}
\end{DoxySeeAlso}
Bandera para indicar si el bucle principal debe terminar.

Esta bandera se establece a 1 por el manejador de señal SIGINT (handle\+\_\+sigint\+\_\+gw) para indicar que la aplicación debe terminar de manera elegante.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b} 
\end{DoxySeeAlso}

\subsection{logging\_gw}
\doxysection{include/api\+\_\+gateway/logging\+\_\+gw.h File Reference}
\label{logging__gw_8h}\index{include/api\_gateway/logging\_gw.h@{include/api\_gateway/logging\_gw.h}}


Sistema de Logging para el API Gateway.  




\doxysubsection{Detailed Description}
Sistema de Logging para el API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo define las macros de logging utilizadas por el API Gateway para generar mensajes de depuración, información, advertencias y errores con formato consistente y colores ANSI.

{\bfseries{Características\+:}}
\begin{DoxyItemize}
\item Colores ANSI para diferenciación visual de niveles
\item Macros variádicas compatibles con printf
\item Prefijo específico del gateway [$\ast$-\/\+GW] para identificación
\item Flush automático para salida inmediata
\item Separación entre stdout (info/debug) y stderr (warn/error)
\end{DoxyItemize}

{\bfseries{Niveles de logging\+:}}
\begin{DoxyItemize}
\item INFO\+: Información general del gateway
\item DEBUG\+: Información detallada para depuración
\item WARN\+: Advertencias que no afectan funcionalidad crítica
\item ERROR\+: Errores que requieren atención
\item CRIT\+: Errores críticos que pueden preceder a una salida
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
servidor\+\_\+central/logging.\+h 

\doxyref{api\+\_\+common\+\_\+defs.\+h}{p.}{api__common__defs_8h} 
\end{DoxySeeAlso}

\subsection{psk\_manager}
\doxysection{src/psk\+\_\+manager.h File Reference}
\label{psk__manager_8h}\index{src/psk\_manager.h@{src/psk\_manager.h}}


Gestor de claves PSK para API Gateway.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ psk\+\_\+manager\+\_\+init} (const char $\ast$keys\+\_\+file\+\_\+path)
\begin{DoxyCompactList}\small\item\em Inicializa el gestor de claves PSK. \end{DoxyCompactList}\item 
int \textbf{ psk\+\_\+manager\+\_\+get\+\_\+random\+\_\+key} (char $\ast$key\+\_\+buffer, size\+\_\+t buffer\+\_\+size)
\begin{DoxyCompactList}\small\item\em Obtiene una clave PSK aleatoria del archivo. \end{DoxyCompactList}\item 
int \textbf{ psk\+\_\+manager\+\_\+get\+\_\+first\+\_\+key} (char $\ast$key\+\_\+buffer, size\+\_\+t buffer\+\_\+size)
\begin{DoxyCompactList}\small\item\em Obtiene la primera clave PSK del archivo como fallback. \end{DoxyCompactList}\item 
int \textbf{ psk\+\_\+manager\+\_\+get\+\_\+deterministic\+\_\+key} (const char $\ast$identity, char $\ast$key\+\_\+buffer, size\+\_\+t buffer\+\_\+size)
\begin{DoxyCompactList}\small\item\em Obtiene una clave PSK determinística basada en la identidad. \end{DoxyCompactList}\item 
void \textbf{ psk\+\_\+manager\+\_\+cleanup} (void)
\begin{DoxyCompactList}\small\item\em Libera los recursos del gestor de claves PSK. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Gestor de claves PSK para API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0
\end{DoxyVersion}
Este archivo define las funciones para gestionar claves PSK desde un archivo de claves predefinidas. 

\doxysubsection{Function Documentation}
\label{psk__manager_8h_ad35ff5f3bbc4390b787ccd3cc84789fd} 
\index{psk\_manager.h@{psk\_manager.h}!psk\_manager\_cleanup@{psk\_manager\_cleanup}}
\index{psk\_manager\_cleanup@{psk\_manager\_cleanup}!psk\_manager.h@{psk\_manager.h}}
\doxysubsubsection{psk\_manager\_cleanup()}
{\footnotesize\ttfamily void psk\+\_\+manager\+\_\+cleanup (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Libera los recursos del gestor de claves PSK. 

\label{psk__manager_8h_ae935da22c745fa1661bb66f846e67caf} 
\index{psk\_manager.h@{psk\_manager.h}!psk\_manager\_get\_deterministic\_key@{psk\_manager\_get\_deterministic\_key}}
\index{psk\_manager\_get\_deterministic\_key@{psk\_manager\_get\_deterministic\_key}!psk\_manager.h@{psk\_manager.h}}
\doxysubsubsection{psk\_manager\_get\_deterministic\_key()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+get\+\_\+deterministic\+\_\+key (\begin{DoxyParamCaption}\item[{const char $\ast$}]{identity,  }\item[{char $\ast$}]{key\+\_\+buffer,  }\item[{size\+\_\+t}]{buffer\+\_\+size }\end{DoxyParamCaption})}



Obtiene una clave PSK determinística basada en la identidad. 


\begin{DoxyParams}{Parameters}
{\em identity} & Identidad del cliente \\
\hline
{\em key\+\_\+buffer} & Buffer donde se almacenará la clave \\
\hline
{\em buffer\+\_\+size} & Tamaño del buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se obtuvo correctamente, -\/1 en caso de error 
\end{DoxyReturn}
\label{psk__manager_8h_ae0d0cd73b05236bb4bfbbf26420ddcb1} 
\index{psk\_manager.h@{psk\_manager.h}!psk\_manager\_get\_first\_key@{psk\_manager\_get\_first\_key}}
\index{psk\_manager\_get\_first\_key@{psk\_manager\_get\_first\_key}!psk\_manager.h@{psk\_manager.h}}
\doxysubsubsection{psk\_manager\_get\_first\_key()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+get\+\_\+first\+\_\+key (\begin{DoxyParamCaption}\item[{char $\ast$}]{key\+\_\+buffer,  }\item[{size\+\_\+t}]{buffer\+\_\+size }\end{DoxyParamCaption})}



Obtiene la primera clave PSK del archivo como fallback. 


\begin{DoxyParams}{Parameters}
{\em key\+\_\+buffer} & Buffer donde se almacenará la clave \\
\hline
{\em buffer\+\_\+size} & Tamaño del buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se obtuvo correctamente, -\/1 en caso de error 
\end{DoxyReturn}
\label{psk__manager_8h_a5663ed8700e380919e18e9d9ae752621} 
\index{psk\_manager.h@{psk\_manager.h}!psk\_manager\_get\_random\_key@{psk\_manager\_get\_random\_key}}
\index{psk\_manager\_get\_random\_key@{psk\_manager\_get\_random\_key}!psk\_manager.h@{psk\_manager.h}}
\doxysubsubsection{psk\_manager\_get\_random\_key()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+get\+\_\+random\+\_\+key (\begin{DoxyParamCaption}\item[{char $\ast$}]{key\+\_\+buffer,  }\item[{size\+\_\+t}]{buffer\+\_\+size }\end{DoxyParamCaption})}



Obtiene una clave PSK aleatoria del archivo. 


\begin{DoxyParams}{Parameters}
{\em key\+\_\+buffer} & Buffer donde se almacenará la clave \\
\hline
{\em buffer\+\_\+size} & Tamaño del buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se obtuvo correctamente, -\/1 en caso de error 
\end{DoxyReturn}
\label{psk__manager_8h_a47c0404c2287b0964a03a03f5843dd7e} 
\index{psk\_manager.h@{psk\_manager.h}!psk\_manager\_init@{psk\_manager\_init}}
\index{psk\_manager\_init@{psk\_manager\_init}!psk\_manager.h@{psk\_manager.h}}
\doxysubsubsection{psk\_manager\_init()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+init (\begin{DoxyParamCaption}\item[{const char $\ast$}]{keys\+\_\+file\+\_\+path }\end{DoxyParamCaption})}



Inicializa el gestor de claves PSK. 


\begin{DoxyParams}{Parameters}
{\em keys\+\_\+file\+\_\+path} & Ruta al archivo de claves PSK \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se inicializó correctamente, -\/1 en caso de error 
\end{DoxyReturn}

\subsection{simulation\_loader}
\doxysection{include/api\+\_\+gateway/simulation\+\_\+loader.h File Reference}
\label{simulation__loader_8h}\index{include/api\_gateway/simulation\_loader.h@{include/api\_gateway/simulation\_loader.h}}


Sistema de Carga y Ejecución de Simulaciones de Ascensores.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ peticion\+\_\+simulacion\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura para una petición individual. \end{DoxyCompactList}\item 
struct \textbf{ edificio\+\_\+simulacion\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura para un edificio de simulación. \end{DoxyCompactList}\item 
struct \textbf{ datos\+\_\+simulacion\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura principal de datos de simulación. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ tipo\+\_\+peticion\+\_\+t} \{ \textbf{ PETICION\+\_\+\+LLAMADA\+\_\+\+PISO}
, \textbf{ PETICION\+\_\+\+SOLICITUD\+\_\+\+CABINA}
 \}
\begin{DoxyCompactList}\small\item\em Tipos de peticiones de simulación. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \textbf{ cargar\+\_\+datos\+\_\+simulacion} (const char $\ast$archivo\+\_\+json, \textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Carga los datos de simulación desde un archivo JSON. \end{DoxyCompactList}\item 
void \textbf{ liberar\+\_\+datos\+\_\+simulacion} (\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Libera la memoria utilizada por los datos de simulación. \end{DoxyCompactList}\item 
\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$ \textbf{ seleccionar\+\_\+edificio\+\_\+aleatorio} (\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Selecciona un edificio aleatorio de los datos cargados. \end{DoxyCompactList}\item 
int \textbf{ ejecutar\+\_\+peticiones\+\_\+edificio} (\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$edificio, coap\+\_\+context\+\_\+t $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Ejecuta todas las peticiones de un edificio. \end{DoxyCompactList}\item 
int \textbf{ convertir\+\_\+direccion\+\_\+string} (const char $\ast$direccion\+\_\+str)
\begin{DoxyCompactList}\small\item\em Convierte una cadena de dirección a enum. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Sistema de Carga y Ejecución de Simulaciones de Ascensores. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0
\end{DoxyVersion}
Este archivo define las funciones para cargar y ejecutar simulaciones de ascensores desde archivos JSON. Permite probar el sistema con múltiples escenarios de edificios y peticiones variadas.

{\bfseries{Funcionalidades principales\+:}}
\begin{DoxyItemize}
\item Carga de datos de simulación desde JSON
\item Selección aleatoria de edificios
\item Ejecución secuencial de peticiones
\item Gestión de memoria para datos de simulación
\end{DoxyItemize}

{\bfseries{Formato de datos esperado\+:}} El archivo JSON debe contener un array de edificios, cada uno con un ID único y un conjunto de peticiones específicas.

\begin{DoxySeeAlso}{See also}
mi\+\_\+simulador\+\_\+ascensor.\+h 

c\+JSON 
\end{DoxySeeAlso}

\subsection{src\_2api\_handlers}
\doxysection{src/api\+\_\+handlers.h File Reference}
\label{src_2api__handlers_8h}\index{src/api\_handlers.h@{src/api\_handlers.h}}


Declares Co\+AP handler functions and related data structures for the API Gateway.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t}
\begin{DoxyCompactList}\small\item\em Tracks information from an original client (elevator) request OR a gateway-\/originated request. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} \{ \textbf{ GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+UNKNOWN}
, \textbf{ GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+FLOOR\+\_\+\+CALL}
, \textbf{ GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+CABIN\+\_\+\+REQUEST}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ handle\+\_\+sigint\+\_\+gw} (int signum)
\begin{DoxyCompactList}\small\item\em Signal handler for SIGINT (Ctrl+C) to allow graceful shutdown. \end{DoxyCompactList}\item 
coap\+\_\+response\+\_\+t \textbf{ hnd\+\_\+central\+\_\+server\+\_\+response\+\_\+gw} (coap\+\_\+session\+\_\+t $\ast$session\+\_\+to\+\_\+central, const coap\+\_\+pdu\+\_\+t $\ast$sent\+\_\+to\+\_\+central, const coap\+\_\+pdu\+\_\+t $\ast$received\+\_\+from\+\_\+central, const coap\+\_\+mid\+\_\+t mid\+\_\+to\+\_\+central)
\begin{DoxyCompactList}\small\item\em Handles responses received from the Central Server. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Declares Co\+AP handler functions and related data structures for the API Gateway. 

This file provides the interface for the Co\+AP NACK/response handler for client requests made by the gateway. 

\doxysubsection{Enumeration Type Documentation}
\label{src_2api__handlers_8h_a17e4539046553af2ffabda67ff75cbb0} 
\index{api\_handlers.h@{api\_handlers.h}!gw\_request\_type\_t@{gw\_request\_type\_t}}
\index{gw\_request\_type\_t@{gw\_request\_type\_t}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{gw\_request\_type\_t}
{\footnotesize\ttfamily enum \textbf{ gw\+\_\+request\+\_\+type\+\_\+t}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{GW\_REQUEST\_TYPE\_UNKNOWN@{GW\_REQUEST\_TYPE\_UNKNOWN}!api\_handlers.h@{api\_handlers.h}}\index{api\_handlers.h@{api\_handlers.h}!GW\_REQUEST\_TYPE\_UNKNOWN@{GW\_REQUEST\_TYPE\_UNKNOWN}}}\label{src_2api__handlers_8h_a17e4539046553af2ffabda67ff75cbb0ae0f69383a1f168c37cc7f8fc70e1f42e} 
GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+UNKNOWN&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{GW\_REQUEST\_TYPE\_FLOOR\_CALL@{GW\_REQUEST\_TYPE\_FLOOR\_CALL}!api\_handlers.h@{api\_handlers.h}}\index{api\_handlers.h@{api\_handlers.h}!GW\_REQUEST\_TYPE\_FLOOR\_CALL@{GW\_REQUEST\_TYPE\_FLOOR\_CALL}}}\label{src_2api__handlers_8h_a17e4539046553af2ffabda67ff75cbb0aad2430297848cdfb0e5be7eda7c01300} 
GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+FLOOR\+\_\+\+CALL&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{GW\_REQUEST\_TYPE\_CABIN\_REQUEST@{GW\_REQUEST\_TYPE\_CABIN\_REQUEST}!api\_handlers.h@{api\_handlers.h}}\index{api\_handlers.h@{api\_handlers.h}!GW\_REQUEST\_TYPE\_CABIN\_REQUEST@{GW\_REQUEST\_TYPE\_CABIN\_REQUEST}}}\label{src_2api__handlers_8h_a17e4539046553af2ffabda67ff75cbb0ac516ba6346d0cc1d0ed36ad6b24000af} 
GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+CABIN\+\_\+\+REQUEST&\\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\label{src_2api__handlers_8h_a7fd01dcda5b603f45f20d97c84d9260b} 
\index{api\_handlers.h@{api\_handlers.h}!handle\_sigint\_gw@{handle\_sigint\_gw}}
\index{handle\_sigint\_gw@{handle\_sigint\_gw}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{handle\_sigint\_gw()}
{\footnotesize\ttfamily void handle\+\_\+sigint\+\_\+gw (\begin{DoxyParamCaption}\item[{int}]{signum }\end{DoxyParamCaption})}



Signal handler for SIGINT (Ctrl+C) to allow graceful shutdown. 


\begin{DoxyParams}{Parameters}
{\em signum} & The signal number (unused).\\
\hline
\end{DoxyParams}
Signal handler for SIGINT (Ctrl+C) to allow graceful shutdown.


\begin{DoxyParams}{Parameters}
{\em signum} & Número de señal recibida (se espera SIGINT). No utilizado.\\
\hline
\end{DoxyParams}
Establece la bandera quit\+\_\+main\+\_\+loop a 1 para señalar al bucle principal de eventos que debe terminar, permitiendo una terminación elegante del API Gateway.

Esta función es registrada como manejador de SIGINT en \doxyref{main.\+c}{p.}{main_8c} y proporciona una forma limpia de cerrar la aplicación. \label{src_2api__handlers_8h_aba27754223447346d8049fc61efcd6f8} 
\index{api\_handlers.h@{api\_handlers.h}!hnd\_central\_server\_response\_gw@{hnd\_central\_server\_response\_gw}}
\index{hnd\_central\_server\_response\_gw@{hnd\_central\_server\_response\_gw}!api\_handlers.h@{api\_handlers.h}}
\doxysubsubsection{hnd\_central\_server\_response\_gw()}
{\footnotesize\ttfamily coap\+\_\+response\+\_\+t hnd\+\_\+central\+\_\+server\+\_\+response\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+session\+\_\+t $\ast$}]{session\+\_\+from\+\_\+server,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{sent\+\_\+to\+\_\+central,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{received\+\_\+from\+\_\+central,  }\item[{const coap\+\_\+mid\+\_\+t}]{mid\+\_\+from\+\_\+server }\end{DoxyParamCaption})}



Handles responses received from the Central Server. 

This function is registered as a Co\+AP NACK/response handler for requests made by the API Gateway (acting as a client) to the Central Server. It processes the Central Server\textquotesingle{}s response and forwards it to the original elevator client (if applicable) or updates internal state (e.\+g. for CAN originated).


\begin{DoxyParams}{Parameters}
{\em session\+\_\+to\+\_\+central} & The Co\+AP session between the API Gateway and the Central Server. \\
\hline
{\em sent\+\_\+to\+\_\+central} & The PDU that the API Gateway sent to the Central Server (can be NULL). \\
\hline
{\em received\+\_\+from\+\_\+central} & The PDU received from the Central Server. \\
\hline
{\em mid\+\_\+to\+\_\+central} & The Co\+AP Message ID of the exchange with the Central Server. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
COAP\+\_\+\+RESPONSE\+\_\+\+OK to indicate the response was handled.
\end{DoxyReturn}
Handles responses received from the Central Server.


\begin{DoxyParams}{Parameters}
{\em session\+\_\+from\+\_\+server} & Sesión Co\+AP desde la cual se recibió la respuesta \\
\hline
{\em sent\+\_\+to\+\_\+central} & PDU que fue enviado al servidor central \\
\hline
{\em received\+\_\+from\+\_\+central} & PDU recibido del servidor central \\
\hline
{\em mid\+\_\+from\+\_\+server} & Message ID de la respuesta del servidor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
COAP\+\_\+\+RESPONSE\+\_\+\+OK si la respuesta se procesó correctamente
\end{DoxyReturn}
Esta función procesa las respuestas recibidas del servidor central para solicitudes de asignación de ascensores. Realiza las siguientes operaciones\+:


\begin{DoxyEnumerate}
\item {\bfseries{Validación}}\+: Verifica que se recibió un PDU válido
\item {\bfseries{Parsing JSON}}\+: Extrae y parsea el payload JSON de la respuesta
\item {\bfseries{Correlación}}\+: Encuentra el tracker original usando el token
\item {\bfseries{Procesamiento}}\+: Extrae información de asignación (ascensor\+\_\+asignado\+\_\+id, tarea\+\_\+id)
\item {\bfseries{Notificación CAN}}\+: Envía respuesta al controlador CAN correspondiente
\item {\bfseries{Limpieza}}\+: Libera recursos del tracker y memoria asociada
\end{DoxyEnumerate}

Maneja diferentes códigos de respuesta\+:
\begin{DoxyItemize}
\item 2.\+01 Created\+: Asignación exitosa
\item 4.\+xx Client Error\+: Errores de solicitud
\item 5.\+xx Server Error\+: Errores del servidor
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{add\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a7292f2cbff08db77c70629ddbac256dc} 

\doxyref{find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a5f19bc5f95b0869d7b25b596f6767877} 

\doxyref{can\+\_\+bridge.\+h}{p.}{can__bridge_8h} 
\end{DoxySeeAlso}

\section{Archivos de Implementación}
\subsection{api\_handlers}
\doxysection{src/api\+\_\+handlers.c File Reference}
\label{api__handlers_8c}\index{src/api\_handlers.c@{src/api\_handlers.c}}


Implementación de manejadores Co\+AP para el API Gateway.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ central\+\_\+request\+\_\+entry\+\_\+t}
\begin{DoxyCompactList}\small\item\em Entrada de tracker para solicitudes al servidor central. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ handle\+\_\+sigint\+\_\+gw} (int signum)
\begin{DoxyCompactList}\small\item\em Manejador de señal para SIGINT (Ctrl+C) \end{DoxyCompactList}\item 
static void \textbf{ add\+\_\+central\+\_\+request\+\_\+tracker} (coap\+\_\+bin\+\_\+const\+\_\+t token\+\_\+to\+\_\+central, \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} $\ast$tracker)
\begin{DoxyCompactList}\small\item\em Añade un tracker a la lista de solicitudes pendientes. \end{DoxyCompactList}\item 
static \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} $\ast$ \textbf{ find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker} (coap\+\_\+bin\+\_\+const\+\_\+t received\+\_\+token)
\begin{DoxyCompactList}\small\item\em Encuentra y remueve un tracker de la lista de solicitudes pendientes. \end{DoxyCompactList}\item 
static void \textbf{ forward\+\_\+request\+\_\+to\+\_\+central\+\_\+server} (coap\+\_\+session\+\_\+t $\ast$original\+\_\+client\+\_\+session, coap\+\_\+mid\+\_\+t original\+\_\+mid, coap\+\_\+bin\+\_\+const\+\_\+t original\+\_\+token\+\_\+const, const char $\ast$central\+\_\+server\+\_\+path, const char $\ast$log\+\_\+tag\+\_\+param, \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} request\+\_\+type\+\_\+param, int origin\+\_\+floor\+\_\+param, int target\+\_\+floor\+\_\+for\+\_\+task\+\_\+param, const char $\ast$requesting\+\_\+elevator\+\_\+id\+\_\+cabin\+\_\+param, \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} requested\+\_\+direction\+\_\+floor\+\_\+param)
\begin{DoxyCompactList}\small\item\em Constructs and sends a Co\+AP request to the central server with the gateway\textquotesingle{}s elevator group state. \end{DoxyCompactList}\item 
coap\+\_\+response\+\_\+t \textbf{ hnd\+\_\+central\+\_\+server\+\_\+response\+\_\+gw} (coap\+\_\+session\+\_\+t $\ast$session\+\_\+from\+\_\+server, const coap\+\_\+pdu\+\_\+t $\ast$sent\+\_\+to\+\_\+central, const coap\+\_\+pdu\+\_\+t $\ast$received\+\_\+from\+\_\+central, const coap\+\_\+mid\+\_\+t mid\+\_\+from\+\_\+server)
\begin{DoxyCompactList}\small\item\em Manejador de respuestas del servidor central. \end{DoxyCompactList}\item 
void \textbf{ hnd\+\_\+elevator\+\_\+api\+\_\+request\+\_\+gw} (coap\+\_\+resource\+\_\+t $\ast$resource, coap\+\_\+session\+\_\+t $\ast$elevator\+\_\+session, const coap\+\_\+pdu\+\_\+t $\ast$elevator\+\_\+request\+\_\+pdu, const coap\+\_\+string\+\_\+t $\ast$query, coap\+\_\+pdu\+\_\+t $\ast$response\+\_\+placeholder)
\begin{DoxyCompactList}\small\item\em Handler for legacy elevator API requests (e.\+g., /peticion\+\_\+ascensor). Currently logs and discards such requests. \end{DoxyCompactList}\item 
void \textbf{ hnd\+\_\+cabin\+\_\+request\+\_\+from\+\_\+elevator\+\_\+gw} (coap\+\_\+resource\+\_\+t $\ast$resource, coap\+\_\+session\+\_\+t $\ast$elevator\+\_\+session, const coap\+\_\+pdu\+\_\+t $\ast$elevator\+\_\+request\+\_\+pdu, const coap\+\_\+string\+\_\+t $\ast$query, coap\+\_\+pdu\+\_\+t $\ast$response\+\_\+placeholder)
\begin{DoxyCompactList}\small\item\em Handler for cabin requests from elevator clients. Path\+: GW\+\_\+\+CABIN\+\_\+\+REQUEST\+\_\+\+PATH (e.\+g., /solicitud\+\_\+cabina\+\_\+gw) Parses query params\+: elevator\+\_\+id, target\+\_\+floor. \end{DoxyCompactList}\item 
void \textbf{ hnd\+\_\+floor\+\_\+call\+\_\+from\+\_\+elevator\+\_\+gw} (coap\+\_\+resource\+\_\+t $\ast$resource, coap\+\_\+session\+\_\+t $\ast$elevator\+\_\+session, const coap\+\_\+pdu\+\_\+t $\ast$elevator\+\_\+request\+\_\+pdu, const coap\+\_\+string\+\_\+t $\ast$query, coap\+\_\+pdu\+\_\+t $\ast$response\+\_\+placeholder)
\begin{DoxyCompactList}\small\item\em Handler for floor calls from elevator clients/external. Path\+: GW\+\_\+\+FLOOR\+\_\+\+CALL\+\_\+\+PATH (e.\+g., /llamada\+\_\+piso\+\_\+gw) Parses query params\+: floor, dir (UP/\+DOWN) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile sig\+\_\+atomic\+\_\+t \textbf{ quit\+\_\+main\+\_\+loop}
\begin{DoxyCompactList}\small\item\em Bandera para indicar si el bucle principal debe terminar. \end{DoxyCompactList}\item 
\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} \textbf{ managed\+\_\+elevator\+\_\+group}
\begin{DoxyCompactList}\small\item\em Estado del grupo de ascensores gestionado por este gateway. \end{DoxyCompactList}\item 
coap\+\_\+session\+\_\+t $\ast$ \textbf{ g\+\_\+dtls\+\_\+session\+\_\+to\+\_\+central\+\_\+server}
\begin{DoxyCompactList}\small\item\em Sesión DTLS global con el servidor central. \end{DoxyCompactList}\item 
static \textbf{ central\+\_\+request\+\_\+entry\+\_\+t} \textbf{ pending\+\_\+central\+\_\+requests} [MAX\+\_\+\+PENDING\+\_\+\+REQUESTS\+\_\+\+TO\+\_\+\+CENTRAL]
\begin{DoxyCompactList}\small\item\em Array de solicitudes pendientes al servidor central. \end{DoxyCompactList}\item 
static int \textbf{ num\+\_\+pending\+\_\+central\+\_\+requests} = 0
\begin{DoxyCompactList}\small\item\em Número actual de solicitudes pendientes al servidor central. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementación de manejadores Co\+AP para el API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo contiene la lógica para manejar\+:
\begin{DoxyItemize}
\item {\bfseries{Solicitudes entrantes}}\+: Requests de clientes (ascensores) vía Co\+AP
\item {\bfseries{Respuestas del servidor central}}\+: Procesamiento de respuestas de asignación
\item {\bfseries{Gestión de trackers}}\+: Seguimiento de solicitudes pendientes
\item {\bfseries{Manejo de señales}}\+: Terminación elegante con SIGINT
\item {\bfseries{Puente CAN-\/\+Co\+AP}}\+: Integración con el sistema de comunicación CAN
\end{DoxyItemize}

Funcionalidades principales\+:
\begin{DoxyItemize}
\item Recepción de solicitudes de llamada de piso y cabina
\item Reenvío de solicitudes al servidor central con estado de ascensores
\item Gestión de sesiones DTLS-\/\+PSK para comunicación segura
\item Tracking de solicitudes pendientes para correlación de respuestas
\item Integración con el gestor de estado de ascensores
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
api\+\_\+handlers.\+h 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 

\doxyref{can\+\_\+bridge.\+h}{p.}{can__bridge_8h} 

\doxyref{coap\+\_\+config.\+h}{p.}{coap__config_8h} 
\end{DoxySeeAlso}


\doxysubsection{Function Documentation}
\label{api__handlers_8c_a7292f2cbff08db77c70629ddbac256dc} 
\index{api\_handlers.c@{api\_handlers.c}!add\_central\_request\_tracker@{add\_central\_request\_tracker}}
\index{add\_central\_request\_tracker@{add\_central\_request\_tracker}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{add\_central\_request\_tracker()}
{\footnotesize\ttfamily static void add\+\_\+central\+\_\+request\+\_\+tracker (\begin{DoxyParamCaption}\item[{coap\+\_\+bin\+\_\+const\+\_\+t}]{token\+\_\+to\+\_\+central,  }\item[{\textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} $\ast$}]{tracker }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Añade un tracker a la lista de solicitudes pendientes. 


\begin{DoxyParams}{Parameters}
{\em token\+\_\+to\+\_\+central} & Token de la solicitud enviada al servidor central \\
\hline
{\em tracker} & Datos del tracker original a asociar\\
\hline
\end{DoxyParams}
Esta función almacena la asociación entre un token de solicitud al servidor central y el tracker original que contiene información de la solicitud del ascensor. Crea una copia del token para evitar problemas de memoria.

Si no hay espacio disponible o hay errores de memoria, libera automáticamente el tracker para evitar fugas de memoria.

\begin{DoxySeeAlso}{See also}
\doxyref{find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a5f19bc5f95b0869d7b25b596f6767877} 
\end{DoxySeeAlso}
\label{api__handlers_8c_a5f19bc5f95b0869d7b25b596f6767877} 
\index{api\_handlers.c@{api\_handlers.c}!find\_and\_remove\_central\_request\_tracker@{find\_and\_remove\_central\_request\_tracker}}
\index{find\_and\_remove\_central\_request\_tracker@{find\_and\_remove\_central\_request\_tracker}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{find\_and\_remove\_central\_request\_tracker()}
{\footnotesize\ttfamily static \textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} $\ast$ find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker (\begin{DoxyParamCaption}\item[{coap\+\_\+bin\+\_\+const\+\_\+t}]{received\+\_\+token }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Encuentra y remueve un tracker de la lista de solicitudes pendientes. 


\begin{DoxyParams}{Parameters}
{\em received\+\_\+token} & Token recibido en la respuesta del servidor central \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero al tracker encontrado, o NULL si no se encuentra
\end{DoxyReturn}
Esta función busca en la lista de solicitudes pendientes un tracker que corresponda al token recibido en una respuesta del servidor central. Si lo encuentra, lo remueve de la lista y libera la memoria del token copiado.

La función compacta el array después de remover una entrada para mantener la integridad de la estructura de datos. Es responsabilidad del llamador liberar la memoria del tracker retornado.

\begin{DoxyNote}{Note}
En un entorno multihilo, esta función requeriría sincronización 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{add\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a7292f2cbff08db77c70629ddbac256dc} 
\end{DoxySeeAlso}
\label{api__handlers_8c_aca6581a83ceb75ede9bbb92d8536b528} 
\index{api\_handlers.c@{api\_handlers.c}!forward\_request\_to\_central\_server@{forward\_request\_to\_central\_server}}
\index{forward\_request\_to\_central\_server@{forward\_request\_to\_central\_server}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{forward\_request\_to\_central\_server()}
{\footnotesize\ttfamily static void forward\+\_\+request\+\_\+to\+\_\+central\+\_\+server (\begin{DoxyParamCaption}\item[{coap\+\_\+session\+\_\+t $\ast$}]{original\+\_\+client\+\_\+session,  }\item[{coap\+\_\+mid\+\_\+t}]{original\+\_\+mid,  }\item[{coap\+\_\+bin\+\_\+const\+\_\+t}]{original\+\_\+token\+\_\+const,  }\item[{const char $\ast$}]{central\+\_\+server\+\_\+path,  }\item[{const char $\ast$}]{log\+\_\+tag\+\_\+param,  }\item[{\textbf{ gw\+\_\+request\+\_\+type\+\_\+t}}]{request\+\_\+type\+\_\+param,  }\item[{int}]{origin\+\_\+floor\+\_\+param,  }\item[{int}]{target\+\_\+floor\+\_\+for\+\_\+task\+\_\+param,  }\item[{const char $\ast$}]{requesting\+\_\+elevator\+\_\+id\+\_\+cabin\+\_\+param,  }\item[{\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t}}]{requested\+\_\+direction\+\_\+floor\+\_\+param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Constructs and sends a Co\+AP request to the central server with the gateway\textquotesingle{}s elevator group state. 

This function populates an \doxyref{api\+\_\+request\+\_\+tracker\+\_\+t}{p.}{structapi__request__tracker__t} with details of the intended operation (floor call, cabin request), serializes the current state of the managed elevator group to JSON, and sends this as a Co\+AP request to the specified path on the central server.


\begin{DoxyParams}{Parameters}
{\em original\+\_\+client\+\_\+session} & The Co\+AP session from which the original request came (can be NULL if internally generated). \\
\hline
{\em original\+\_\+mid} & The Co\+AP MID from the original request (if applicable). \\
\hline
{\em original\+\_\+token\+\_\+const} & The Co\+AP token from the original request (if applicable, will be duplicated). \\
\hline
{\em central\+\_\+server\+\_\+path} & The target Co\+AP resource path on the central server. \\
\hline
{\em log\+\_\+tag\+\_\+param} & A string tag for logging (e.\+g., "{}\+Floor\+Call\+GW"{}, will be duplicated). \\
\hline
{\em request\+\_\+type\+\_\+param} & The type of request being made (e.\+g., GW\+\_\+\+REQUEST\+\_\+\+TYPE\+\_\+\+FLOOR\+\_\+\+CALL). \\
\hline
{\em origin\+\_\+floor\+\_\+param} & Floor of origin for a floor call. \\
\hline
{\em target\+\_\+floor\+\_\+for\+\_\+task\+\_\+param} & The target floor for the task to be assigned by the server. \\
\hline
{\em requesting\+\_\+elevator\+\_\+id\+\_\+cabin\+\_\+param} & ID of the elevator making a cabin request (can be NULL). \\
\hline
{\em requested\+\_\+direction\+\_\+floor\+\_\+param} & Direction for a floor call. \\
\hline
\end{DoxyParams}
\label{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b} 
\index{api\_handlers.c@{api\_handlers.c}!handle\_sigint\_gw@{handle\_sigint\_gw}}
\index{handle\_sigint\_gw@{handle\_sigint\_gw}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{handle\_sigint\_gw()}
{\footnotesize\ttfamily void handle\+\_\+sigint\+\_\+gw (\begin{DoxyParamCaption}\item[{int}]{signum }\end{DoxyParamCaption})}



Manejador de señal para SIGINT (Ctrl+C) 

Signal handler for SIGINT (Ctrl+C) to allow graceful shutdown.


\begin{DoxyParams}{Parameters}
{\em signum} & Número de señal recibida (se espera SIGINT). No utilizado.\\
\hline
\end{DoxyParams}
Establece la bandera quit\+\_\+main\+\_\+loop a 1 para señalar al bucle principal de eventos que debe terminar, permitiendo una terminación elegante del API Gateway.

Esta función es registrada como manejador de SIGINT en \doxyref{main.\+c}{p.}{main_8c} y proporciona una forma limpia de cerrar la aplicación. \label{api__handlers_8c_a053f34293ce0f5e920e378b1cd18789e} 
\index{api\_handlers.c@{api\_handlers.c}!hnd\_cabin\_request\_from\_elevator\_gw@{hnd\_cabin\_request\_from\_elevator\_gw}}
\index{hnd\_cabin\_request\_from\_elevator\_gw@{hnd\_cabin\_request\_from\_elevator\_gw}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{hnd\_cabin\_request\_from\_elevator\_gw()}
{\footnotesize\ttfamily void hnd\+\_\+cabin\+\_\+request\+\_\+from\+\_\+elevator\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+resource\+\_\+t $\ast$}]{resource,  }\item[{coap\+\_\+session\+\_\+t $\ast$}]{elevator\+\_\+session,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{elevator\+\_\+request\+\_\+pdu,  }\item[{const coap\+\_\+string\+\_\+t $\ast$}]{query,  }\item[{coap\+\_\+pdu\+\_\+t $\ast$}]{response\+\_\+placeholder }\end{DoxyParamCaption})}



Handler for cabin requests from elevator clients. Path\+: GW\+\_\+\+CABIN\+\_\+\+REQUEST\+\_\+\+PATH (e.\+g., /solicitud\+\_\+cabina\+\_\+gw) Parses query params\+: elevator\+\_\+id, target\+\_\+floor. 

\label{api__handlers_8c_a53890892a78846765f23427df89fc0af} 
\index{api\_handlers.c@{api\_handlers.c}!hnd\_central\_server\_response\_gw@{hnd\_central\_server\_response\_gw}}
\index{hnd\_central\_server\_response\_gw@{hnd\_central\_server\_response\_gw}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{hnd\_central\_server\_response\_gw()}
{\footnotesize\ttfamily coap\+\_\+response\+\_\+t hnd\+\_\+central\+\_\+server\+\_\+response\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+session\+\_\+t $\ast$}]{session\+\_\+from\+\_\+server,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{sent\+\_\+to\+\_\+central,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{received\+\_\+from\+\_\+central,  }\item[{const coap\+\_\+mid\+\_\+t}]{mid\+\_\+from\+\_\+server }\end{DoxyParamCaption})}



Manejador de respuestas del servidor central. 

Handles responses received from the Central Server.


\begin{DoxyParams}{Parameters}
{\em session\+\_\+from\+\_\+server} & Sesión Co\+AP desde la cual se recibió la respuesta \\
\hline
{\em sent\+\_\+to\+\_\+central} & PDU que fue enviado al servidor central \\
\hline
{\em received\+\_\+from\+\_\+central} & PDU recibido del servidor central \\
\hline
{\em mid\+\_\+from\+\_\+server} & Message ID de la respuesta del servidor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
COAP\+\_\+\+RESPONSE\+\_\+\+OK si la respuesta se procesó correctamente
\end{DoxyReturn}
Esta función procesa las respuestas recibidas del servidor central para solicitudes de asignación de ascensores. Realiza las siguientes operaciones\+:


\begin{DoxyEnumerate}
\item {\bfseries{Validación}}\+: Verifica que se recibió un PDU válido
\item {\bfseries{Parsing JSON}}\+: Extrae y parsea el payload JSON de la respuesta
\item {\bfseries{Correlación}}\+: Encuentra el tracker original usando el token
\item {\bfseries{Procesamiento}}\+: Extrae información de asignación (ascensor\+\_\+asignado\+\_\+id, tarea\+\_\+id)
\item {\bfseries{Notificación CAN}}\+: Envía respuesta al controlador CAN correspondiente
\item {\bfseries{Limpieza}}\+: Libera recursos del tracker y memoria asociada
\end{DoxyEnumerate}

Maneja diferentes códigos de respuesta\+:
\begin{DoxyItemize}
\item 2.\+01 Created\+: Asignación exitosa
\item 4.\+xx Client Error\+: Errores de solicitud
\item 5.\+xx Server Error\+: Errores del servidor
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{add\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a7292f2cbff08db77c70629ddbac256dc} 

\doxyref{find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker()}{p.}{api__handlers_8c_a5f19bc5f95b0869d7b25b596f6767877} 

\doxyref{can\+\_\+bridge.\+h}{p.}{can__bridge_8h} 
\end{DoxySeeAlso}
\label{api__handlers_8c_af5a21d636796fd0fe682efedb9420894} 
\index{api\_handlers.c@{api\_handlers.c}!hnd\_elevator\_api\_request\_gw@{hnd\_elevator\_api\_request\_gw}}
\index{hnd\_elevator\_api\_request\_gw@{hnd\_elevator\_api\_request\_gw}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{hnd\_elevator\_api\_request\_gw()}
{\footnotesize\ttfamily void hnd\+\_\+elevator\+\_\+api\+\_\+request\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+resource\+\_\+t $\ast$}]{resource,  }\item[{coap\+\_\+session\+\_\+t $\ast$}]{elevator\+\_\+session,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{elevator\+\_\+request\+\_\+pdu,  }\item[{const coap\+\_\+string\+\_\+t $\ast$}]{query,  }\item[{coap\+\_\+pdu\+\_\+t $\ast$}]{response\+\_\+placeholder }\end{DoxyParamCaption})}



Handler for legacy elevator API requests (e.\+g., /peticion\+\_\+ascensor). Currently logs and discards such requests. 

\label{api__handlers_8c_aadcce191828355c65cabd0862f5f5b4a} 
\index{api\_handlers.c@{api\_handlers.c}!hnd\_floor\_call\_from\_elevator\_gw@{hnd\_floor\_call\_from\_elevator\_gw}}
\index{hnd\_floor\_call\_from\_elevator\_gw@{hnd\_floor\_call\_from\_elevator\_gw}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{hnd\_floor\_call\_from\_elevator\_gw()}
{\footnotesize\ttfamily void hnd\+\_\+floor\+\_\+call\+\_\+from\+\_\+elevator\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+resource\+\_\+t $\ast$}]{resource,  }\item[{coap\+\_\+session\+\_\+t $\ast$}]{elevator\+\_\+session,  }\item[{const coap\+\_\+pdu\+\_\+t $\ast$}]{elevator\+\_\+request\+\_\+pdu,  }\item[{const coap\+\_\+string\+\_\+t $\ast$}]{query,  }\item[{coap\+\_\+pdu\+\_\+t $\ast$}]{response\+\_\+placeholder }\end{DoxyParamCaption})}



Handler for floor calls from elevator clients/external. Path\+: GW\+\_\+\+FLOOR\+\_\+\+CALL\+\_\+\+PATH (e.\+g., /llamada\+\_\+piso\+\_\+gw) Parses query params\+: floor, dir (UP/\+DOWN) 



\doxysubsection{Variable Documentation}
\label{api__handlers_8c_abe546e2cc7517fb0f6e0218ca1e3ff10} 
\index{api\_handlers.c@{api\_handlers.c}!g\_dtls\_session\_to\_central\_server@{g\_dtls\_session\_to\_central\_server}}
\index{g\_dtls\_session\_to\_central\_server@{g\_dtls\_session\_to\_central\_server}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{g\_dtls\_session\_to\_central\_server}
{\footnotesize\ttfamily coap\+\_\+session\+\_\+t$\ast$ g\+\_\+dtls\+\_\+session\+\_\+to\+\_\+central\+\_\+server\hspace{0.3cm}{\ttfamily [extern]}}



Sesión DTLS global con el servidor central. 

Declaración externa de la sesión DTLS definida en \doxyref{main.\+c}{p.}{main_8c}. Se utiliza para enviar solicitudes al servidor central de manera eficiente reutilizando la misma conexión segura.

\begin{DoxySeeAlso}{See also}
\doxyref{main.\+c}{p.}{main_8c} 

\doxyref{get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session()}{p.}{main_8c_a7910799dc4997ea7ff42bb0339134d94}
\end{DoxySeeAlso}
Mantiene la conexión segura DTLS-\/\+PSK con el servidor central para el envío de solicitudes de asignación de ascensores. Se reutiliza para múltiples solicitudes para eficiencia. \label{api__handlers_8c_a2e69b946477ed035db425886fe261a13} 
\index{api\_handlers.c@{api\_handlers.c}!managed\_elevator\_group@{managed\_elevator\_group}}
\index{managed\_elevator\_group@{managed\_elevator\_group}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{managed\_elevator\_group}
{\footnotesize\ttfamily \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} managed\+\_\+elevator\+\_\+group\hspace{0.3cm}{\ttfamily [extern]}}



Estado del grupo de ascensores gestionado por este gateway. 

Declaración externa para acceder al estado del grupo de ascensores gestionado en \doxyref{main.\+c}{p.}{main_8c}. Contiene información completa de todos los ascensores del edificio.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{main.\+c}{p.}{main_8c}
\end{DoxySeeAlso}
Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 
\end{DoxySeeAlso}
\label{api__handlers_8c_a76b99a49711fa510460f784f46154891} 
\index{api\_handlers.c@{api\_handlers.c}!num\_pending\_central\_requests@{num\_pending\_central\_requests}}
\index{num\_pending\_central\_requests@{num\_pending\_central\_requests}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{num\_pending\_central\_requests}
{\footnotesize\ttfamily int num\+\_\+pending\+\_\+central\+\_\+requests = 0\hspace{0.3cm}{\ttfamily [static]}}



Número actual de solicitudes pendientes al servidor central. 

Contador que mantiene el número de entradas activas en el array pending\+\_\+central\+\_\+requests. Para un entorno multihilo, se necesitaría un mutex. \label{api__handlers_8c_a50087f66f2f272d8c1e54ff6a023a1be} 
\index{api\_handlers.c@{api\_handlers.c}!pending\_central\_requests@{pending\_central\_requests}}
\index{pending\_central\_requests@{pending\_central\_requests}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{pending\_central\_requests}
{\footnotesize\ttfamily \textbf{ central\+\_\+request\+\_\+entry\+\_\+t} pending\+\_\+central\+\_\+requests[MAX\+\_\+\+PENDING\+\_\+\+REQUESTS\+\_\+\+TO\+\_\+\+CENTRAL]\hspace{0.3cm}{\ttfamily [static]}}



Array de solicitudes pendientes al servidor central. 

Almacena todas las solicitudes que han sido enviadas al servidor central y están esperando respuesta. Se utiliza para correlacionar respuestas con las solicitudes originales de los ascensores. \label{api__handlers_8c_a8a485bed3bbf69f7556aa3167043d7e2} 
\index{api\_handlers.c@{api\_handlers.c}!quit\_main\_loop@{quit\_main\_loop}}
\index{quit\_main\_loop@{quit\_main\_loop}!api\_handlers.c@{api\_handlers.c}}
\doxysubsubsection{quit\_main\_loop}
{\footnotesize\ttfamily volatile sig\+\_\+atomic\+\_\+t quit\+\_\+main\+\_\+loop\hspace{0.3cm}{\ttfamily [extern]}}



Bandera para indicar si el bucle principal debe terminar. 

Esta variable se declara como extern en api\+\_\+handlers.\+h y se define en \doxyref{main.\+c}{p.}{main_8c}. Es establecida por el manejador de señal (handle\+\_\+sigint\+\_\+gw) para detener el bucle principal de eventos.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b}
\end{DoxySeeAlso}
Bandera para indicar si el bucle principal debe terminar.

Esta bandera se establece a 1 por el manejador de señal SIGINT (handle\+\_\+sigint\+\_\+gw) para indicar que la aplicación debe terminar de manera elegante.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b} 
\end{DoxySeeAlso}

\subsection{can\_bridge}
\doxysection{src/can\+\_\+bridge.c File Reference}
\label{can__bridge_8c}\index{src/can\_bridge.c@{src/can\_bridge.c}}


Implementación del Puente CAN-\/\+Co\+AP para el API Gateway.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \textbf{ log\+\_\+coap\+\_\+token} (const char $\ast$prefix, coap\+\_\+bin\+\_\+const\+\_\+t token)
\begin{DoxyCompactList}\small\item\em Función helper para logging de tokens Co\+AP. \end{DoxyCompactList}\item 
static void \textbf{ store\+\_\+can\+\_\+tracker} (coap\+\_\+bin\+\_\+const\+\_\+t token, uint32\+\_\+t can\+\_\+id, \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} req\+\_\+type, int target\+\_\+floor, int ref\+\_\+floor, const char $\ast$elevator\+\_\+id\+\_\+if\+\_\+cabin)
\begin{DoxyCompactList}\small\item\em Almacena un tracker CAN para correlación de respuestas. \end{DoxyCompactList}\item 
\textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t} $\ast$ \textbf{ find\+\_\+can\+\_\+tracker} (coap\+\_\+bin\+\_\+const\+\_\+t token)
\begin{DoxyCompactList}\small\item\em Busca un tracker CAN por token Co\+AP. \end{DoxyCompactList}\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Inicializa el puente CAN-\/\+Co\+AP. \end{DoxyCompactList}\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback} (\textbf{ can\+\_\+send\+\_\+callback\+\_\+t} callback)
\begin{DoxyCompactList}\small\item\em Registra el callback para envío de frames CAN al simulador. \end{DoxyCompactList}\item 
static void \textbf{ forward\+\_\+can\+\_\+originated\+\_\+request\+\_\+to\+\_\+central\+\_\+server} (coap\+\_\+context\+\_\+t $\ast$ctx, uint32\+\_\+t original\+\_\+can\+\_\+id, const char $\ast$central\+\_\+server\+\_\+path, const char $\ast$log\+\_\+tag\+\_\+param, \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} request\+\_\+type\+\_\+param, int origin\+\_\+floor\+\_\+param, int target\+\_\+floor\+\_\+for\+\_\+task\+\_\+param, const char $\ast$requesting\+\_\+elevator\+\_\+id\+\_\+cabin\+\_\+param, \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} requested\+\_\+direction\+\_\+floor\+\_\+param)
\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame} (\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$frame, coap\+\_\+context\+\_\+t $\ast$coap\+\_\+ctx)
\begin{DoxyCompactList}\small\item\em Procesa un frame CAN entrante y lo convierte a solicitud Co\+AP. \end{DoxyCompactList}\item 
void \textbf{ ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame} (uint32\+\_\+t original\+\_\+can\+\_\+id, coap\+\_\+pdu\+\_\+code\+\_\+t response\+\_\+code, c\+JSON $\ast$server\+\_\+response\+\_\+json)
\begin{DoxyCompactList}\small\item\em Envía una respuesta (traducida de Co\+AP) como un frame CAN simulado a la simulación. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \textbf{ can\+\_\+send\+\_\+callback\+\_\+t} \textbf{ send\+\_\+to\+\_\+simulation\+\_\+callback} = NULL
\begin{DoxyCompactList}\small\item\em Callback registrado para enviar frames CAN a la simulación. \end{DoxyCompactList}\item 
static \textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t} \textbf{ can\+\_\+trackers} [MAX\+\_\+\+CAN\+\_\+\+ORIGIN\+\_\+\+TRACKERS]
\begin{DoxyCompactList}\small\item\em Buffer circular de trackers para solicitudes CAN. \end{DoxyCompactList}\item 
static int \textbf{ next\+\_\+can\+\_\+tracker\+\_\+idx} = 0
\begin{DoxyCompactList}\small\item\em Índice del siguiente tracker CAN disponible. \end{DoxyCompactList}\item 
\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} \textbf{ managed\+\_\+elevator\+\_\+group}
\begin{DoxyCompactList}\small\item\em Estado del grupo de ascensores gestionado. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementación del Puente CAN-\/\+Co\+AP para el API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo implementa el puente de comunicación entre el protocolo CAN (Controller Area Network) y Co\+AP (Constrained Application Protocol) para el sistema de control de ascensores. Sus funciones principales\+:


\begin{DoxyItemize}
\item {\bfseries{Procesamiento de frames CAN}}\+: Interpretación de mensajes CAN entrantes
\item {\bfseries{Conversión CAN-\/\+Co\+AP}}\+: Transformación de solicitudes CAN a Co\+AP
\item {\bfseries{Gestión de trackers}}\+: Seguimiento de solicitudes originadas por CAN
\item {\bfseries{Respuestas CAN}}\+: Envío de respuestas del servidor central vía CAN
\item {\bfseries{Simulación}}\+: Interfaz con simulador de red CAN para testing
\item {\bfseries{Logging}}\+: Registro detallado de operaciones para debugging
\end{DoxyItemize}

Tipos de mensajes CAN soportados\+:
\begin{DoxyItemize}
\item {\bfseries{0x100}}\+: Llamadas de piso (floor calls) con dirección
\item {\bfseries{0x200}}\+: Solicitudes de cabina (cabin requests) con destino
\item {\bfseries{0x300}}\+: Notificaciones de llegada de ascensores
\end{DoxyItemize}

El puente mantiene un buffer circular de trackers para correlacionar respuestas del servidor central con las solicitudes CAN originales.

\begin{DoxySeeAlso}{See also}
\doxyref{can\+\_\+bridge.\+h}{p.}{can__bridge_8h} 

api\+\_\+handlers.\+h 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 

\doxyref{coap\+\_\+config.\+h}{p.}{coap__config_8h} 
\end{DoxySeeAlso}


\doxysubsection{Function Documentation}
\label{can__bridge_8c_a331e50c4b7681888fa7b0c1eb89e7f32} 
\index{can\_bridge.c@{can\_bridge.c}!ag\_can\_bridge\_init@{ag\_can\_bridge\_init}}
\index{ag\_can\_bridge\_init@{ag\_can\_bridge\_init}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{ag\_can\_bridge\_init()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Inicializa el puente CAN-\/\+Co\+AP. 

Inicializa el puente CAN simulado.

Esta función inicializa el sistema de puente CAN-\/\+Co\+AP, preparando todas las estructuras de datos necesarias para el funcionamiento.

Operaciones realizadas\+:
\begin{DoxyItemize}
\item Limpia el callback de envío CAN
\item Libera memoria de tokens almacenados en trackers
\item Inicializa a cero el buffer de trackers CAN
\item Resetea el índice del buffer circular
\end{DoxyItemize}

Debe llamarse una vez al inicio del programa antes de procesar cualquier frame CAN o registrar callbacks.

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame()}{p.}{can__bridge_8h_a1859dd08bf918dd5bc9ebc92071ae9ca} 
\end{DoxySeeAlso}
\label{can__bridge_8c_aacea58e11d63ec4a2601d1b225af2af7} 
\index{can\_bridge.c@{can\_bridge.c}!ag\_can\_bridge\_process\_incoming\_frame@{ag\_can\_bridge\_process\_incoming\_frame}}
\index{ag\_can\_bridge\_process\_incoming\_frame@{ag\_can\_bridge\_process\_incoming\_frame}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{ag\_can\_bridge\_process\_incoming\_frame()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame (\begin{DoxyParamCaption}\item[{\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$}]{frame,  }\item[{coap\+\_\+context\+\_\+t $\ast$}]{coap\+\_\+ctx }\end{DoxyParamCaption})}



Procesa un frame CAN entrante y lo convierte a solicitud Co\+AP. 

Procesa un frame CAN simulado entrante desde la simulación de ascensores.


\begin{DoxyParams}{Parameters}
{\em frame} & Puntero al frame CAN simulado a procesar \\
\hline
{\em coap\+\_\+ctx} & Contexto Co\+AP para enviar solicitudes al servidor central\\
\hline
\end{DoxyParams}
Esta función es el punto de entrada principal para el procesamiento de frames CAN entrantes. Interpreta el contenido del frame según el esquema de mensajes CAN definido y genera las solicitudes Co\+AP correspondientes al servidor central.

{\bfseries{Tipos de frames CAN soportados\+:}}
\begin{DoxyItemize}
\item {\bfseries{0x100 -\/ Llamada de piso}}\+:
\begin{DoxyItemize}
\item data[0]\+: Piso origen (0-\/255)
\item data[1]\+: Dirección (0=UP, 1=DOWN)
\end{DoxyItemize}
\item {\bfseries{0x200 -\/ Solicitud de cabina}}\+:
\begin{DoxyItemize}
\item data[0]\+: Índice del ascensor (0-\/based)
\item data[1]\+: Piso destino (0-\/255)
\end{DoxyItemize}
\item {\bfseries{0x300 -\/ Notificación de llegada}}\+:
\begin{DoxyItemize}
\item data[0]\+: Índice del ascensor (0-\/based)
\item data[1]\+: Piso actual (0-\/255)
\end{DoxyItemize}
\end{DoxyItemize}

Para cada frame válido, la función\+:
\begin{DoxyEnumerate}
\item Valida el formato y longitud de datos
\item Extrae los parámetros específicos del tipo de mensaje
\item Genera una solicitud Co\+AP al servidor central
\item Almacena un tracker para correlacionar la respuesta
\end{DoxyEnumerate}

\begin{DoxyNote}{Note}
Los IDs CAN y formato de datos deben adaptarse según el esquema específico del sistema de ascensores
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{forward\+\_\+can\+\_\+originated\+\_\+request\+\_\+to\+\_\+central\+\_\+server()}{p.}{can__bridge_8c_ad9eccdae992eb522b098df7cf4ff050d} 

\doxyref{store\+\_\+can\+\_\+tracker()}{p.}{can__bridge_8c_a26febc28ea92320546cd8ec40d003b87} 

\doxyref{simulated\+\_\+can\+\_\+frame\+\_\+t}{p.}{structsimulated__can__frame__t} 
\end{DoxySeeAlso}
\label{can__bridge_8c_a82b3383904e65573e79b59f4b7c5ef15} 
\index{can\_bridge.c@{can\_bridge.c}!ag\_can\_bridge\_register\_send\_callback@{ag\_can\_bridge\_register\_send\_callback}}
\index{ag\_can\_bridge\_register\_send\_callback@{ag\_can\_bridge\_register\_send\_callback}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{ag\_can\_bridge\_register\_send\_callback()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback (\begin{DoxyParamCaption}\item[{\textbf{ can\+\_\+send\+\_\+callback\+\_\+t}}]{callback }\end{DoxyParamCaption})}



Registra el callback para envío de frames CAN al simulador. 

Registra la función de callback que la API Gateway usará para enviar frames CAN.


\begin{DoxyParams}{Parameters}
{\em callback} & Función callback que será llamada para enviar frames CAN\\
\hline
\end{DoxyParams}
Esta función registra una función callback que será utilizada por el puente CAN-\/\+Co\+AP para enviar frames CAN de respuesta al simulador.

El callback debe implementar la interfaz can\+\_\+send\+\_\+callback\+\_\+t y será invocado cuando el puente necesite enviar respuestas del servidor central de vuelta al sistema CAN simulado.

\begin{DoxyNote}{Note}
Solo se puede registrar un callback a la vez. Llamadas posteriores sobrescriben el callback anterior.
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{can\+\_\+send\+\_\+callback\+\_\+t}{p.}{can__bridge_8h_a1c10dfd5c89b2417f2eacc2d71c91c9a} 

\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame()}{p.}{can__bridge_8h_a5add34ce57a2d36aa902cf08b921a665} 
\end{DoxySeeAlso}
\label{can__bridge_8c_a5add34ce57a2d36aa902cf08b921a665} 
\index{can\_bridge.c@{can\_bridge.c}!ag\_can\_bridge\_send\_response\_frame@{ag\_can\_bridge\_send\_response\_frame}}
\index{ag\_can\_bridge\_send\_response\_frame@{ag\_can\_bridge\_send\_response\_frame}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{ag\_can\_bridge\_send\_response\_frame()}
{\footnotesize\ttfamily void ag\+\_\+can\+\_\+bridge\+\_\+send\+\_\+response\+\_\+frame (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{original\+\_\+can\+\_\+id,  }\item[{coap\+\_\+pdu\+\_\+code\+\_\+t}]{response\+\_\+code,  }\item[{c\+JSON $\ast$}]{server\+\_\+response\+\_\+json }\end{DoxyParamCaption})}



Envía una respuesta (traducida de Co\+AP) como un frame CAN simulado a la simulación. 


\begin{DoxyParams}{Parameters}
{\em original\+\_\+can\+\_\+id} & El ID del frame CAN original que originó esta respuesta \\
\hline
{\em response\+\_\+code} & El código de respuesta Co\+AP recibido del servidor central \\
\hline
{\em server\+\_\+response\+\_\+json} & El objeto c\+JSON que contiene la respuesta del servidor central (puede ser NULL)\\
\hline
\end{DoxyParams}
Esta función convierte una respuesta Co\+AP del servidor central en un frame CAN simulado que se envía de vuelta al simulador de ascensores. Maneja tanto respuestas exitosas como códigos de error.

{\bfseries{Procesamiento de respuestas exitosas\+:}}
\begin{DoxyItemize}
\item Extrae ascensor\+\_\+asignado\+\_\+id y tarea\+\_\+id del JSON
\item Convierte ID de ascensor a índice numérico
\item Construye frame CAN con información de asignación
\item ID de respuesta\+: original\+\_\+can\+\_\+id + 1
\end{DoxyItemize}

{\bfseries{Procesamiento de errores\+:}}
\begin{DoxyItemize}
\item Detecta códigos de error Co\+AP o campo "{}error"{} en JSON
\item Genera frame CAN de error con ID 0x\+FE
\item Incluye código de error específico en data[1]
\end{DoxyItemize}

{\bfseries{Códigos de error definidos\+:}}
\begin{DoxyItemize}
\item 0x01\+: JSON faltante o nulo del servidor
\item 0x02\+: Servidor reportó error o código Co\+AP de error
\item 0x03\+: Fallo al parsear JSON de éxito
\end{DoxyItemize}

La función utiliza el callback registrado para enviar el frame al simulador de ascensores.

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8h_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{can\+\_\+send\+\_\+callback\+\_\+t}{p.}{can__bridge_8h_a1c10dfd5c89b2417f2eacc2d71c91c9a} 

\doxyref{simulated\+\_\+can\+\_\+frame\+\_\+t}{p.}{structsimulated__can__frame__t} 
\end{DoxySeeAlso}
\label{can__bridge_8c_a7027a900f632b8023cfd9f3b0e4a5a99} 
\index{can\_bridge.c@{can\_bridge.c}!find\_can\_tracker@{find\_can\_tracker}}
\index{find\_can\_tracker@{find\_can\_tracker}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{find\_can\_tracker()}
{\footnotesize\ttfamily \textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t} $\ast$ find\+\_\+can\+\_\+tracker (\begin{DoxyParamCaption}\item[{coap\+\_\+bin\+\_\+const\+\_\+t}]{token }\end{DoxyParamCaption})}



Busca un tracker CAN por token Co\+AP. 

Busca un tracker de origen CAN basado en un token Co\+AP.


\begin{DoxyParams}{Parameters}
{\em token} & Token Co\+AP a buscar en los trackers almacenados \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero al tracker encontrado, o NULL si no se encuentra
\end{DoxyReturn}
Esta función busca en el buffer circular de trackers CAN un tracker que corresponda al token Co\+AP especificado. Se utiliza para correlacionar respuestas del servidor central con solicitudes CAN originales.

La búsqueda se realiza comparando tanto la longitud como el contenido binario del token. No remueve el tracker de la lista (a diferencia de find\+\_\+and\+\_\+remove\+\_\+central\+\_\+request\+\_\+tracker).

\begin{DoxySeeAlso}{See also}
\doxyref{store\+\_\+can\+\_\+tracker()}{p.}{can__bridge_8c_a26febc28ea92320546cd8ec40d003b87} 

\doxyref{can\+\_\+origin\+\_\+tracker\+\_\+t}{p.}{structcan__origin__tracker__t} 
\end{DoxySeeAlso}
\label{can__bridge_8c_ad9eccdae992eb522b098df7cf4ff050d} 
\index{can\_bridge.c@{can\_bridge.c}!forward\_can\_originated\_request\_to\_central\_server@{forward\_can\_originated\_request\_to\_central\_server}}
\index{forward\_can\_originated\_request\_to\_central\_server@{forward\_can\_originated\_request\_to\_central\_server}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{forward\_can\_originated\_request\_to\_central\_server()}
{\footnotesize\ttfamily static void forward\+\_\+can\+\_\+originated\+\_\+request\+\_\+to\+\_\+central\+\_\+server (\begin{DoxyParamCaption}\item[{coap\+\_\+context\+\_\+t $\ast$}]{ctx,  }\item[{uint32\+\_\+t}]{original\+\_\+can\+\_\+id,  }\item[{const char $\ast$}]{central\+\_\+server\+\_\+path,  }\item[{const char $\ast$}]{log\+\_\+tag\+\_\+param,  }\item[{\textbf{ gw\+\_\+request\+\_\+type\+\_\+t}}]{request\+\_\+type\+\_\+param,  }\item[{int}]{origin\+\_\+floor\+\_\+param,  }\item[{int}]{target\+\_\+floor\+\_\+for\+\_\+task\+\_\+param,  }\item[{const char $\ast$}]{requesting\+\_\+elevator\+\_\+id\+\_\+cabin\+\_\+param,  }\item[{\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t}}]{requested\+\_\+direction\+\_\+floor\+\_\+param }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\label{can__bridge_8c_a52bc66ea0c5984ec76e0fc49a5fec28d} 
\index{can\_bridge.c@{can\_bridge.c}!log\_coap\_token@{log\_coap\_token}}
\index{log\_coap\_token@{log\_coap\_token}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{log\_coap\_token()}
{\footnotesize\ttfamily static void log\+\_\+coap\+\_\+token (\begin{DoxyParamCaption}\item[{const char $\ast$}]{prefix,  }\item[{coap\+\_\+bin\+\_\+const\+\_\+t}]{token }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Función helper para logging de tokens Co\+AP. 


\begin{DoxyParams}{Parameters}
{\em prefix} & Prefijo para el mensaje de log \\
\hline
{\em token} & Token Co\+AP a imprimir en formato hexadecimal\\
\hline
\end{DoxyParams}
Esta función convierte un token Co\+AP binario a su representación hexadecimal para facilitar el debugging y seguimiento de solicitudes. Limita la impresión a 8 bytes máximo para evitar logs excesivamente largos. \label{can__bridge_8c_a26febc28ea92320546cd8ec40d003b87} 
\index{can\_bridge.c@{can\_bridge.c}!store\_can\_tracker@{store\_can\_tracker}}
\index{store\_can\_tracker@{store\_can\_tracker}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{store\_can\_tracker()}
{\footnotesize\ttfamily static void store\+\_\+can\+\_\+tracker (\begin{DoxyParamCaption}\item[{coap\+\_\+bin\+\_\+const\+\_\+t}]{token,  }\item[{uint32\+\_\+t}]{can\+\_\+id,  }\item[{\textbf{ gw\+\_\+request\+\_\+type\+\_\+t}}]{req\+\_\+type,  }\item[{int}]{target\+\_\+floor,  }\item[{int}]{ref\+\_\+floor,  }\item[{const char $\ast$}]{elevator\+\_\+id\+\_\+if\+\_\+cabin }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Almacena un tracker CAN para correlación de respuestas. 


\begin{DoxyParams}{Parameters}
{\em token} & Token Co\+AP de la solicitud enviada al servidor central \\
\hline
{\em can\+\_\+id} & ID del frame CAN original \\
\hline
{\em req\+\_\+type} & Tipo de solicitud (floor call, cabin request, etc.) \\
\hline
{\em target\+\_\+floor} & Piso destino de la tarea \\
\hline
{\em ref\+\_\+floor} & Piso de referencia (origen para floor calls) \\
\hline
{\em elevator\+\_\+id\+\_\+if\+\_\+cabin} & ID del ascensor (solo para cabin requests)\\
\hline
\end{DoxyParams}
Esta función almacena información de correlación en el buffer circular de trackers CAN. Crea una copia del token Co\+AP para evitar problemas de memoria y libera automáticamente tokens anteriores si es necesario.

\begin{DoxySeeAlso}{See also}
\doxyref{find\+\_\+can\+\_\+tracker()}{p.}{can__bridge_8c_a7027a900f632b8023cfd9f3b0e4a5a99} 

\doxyref{can\+\_\+origin\+\_\+tracker\+\_\+t}{p.}{structcan__origin__tracker__t} 
\end{DoxySeeAlso}


\doxysubsection{Variable Documentation}
\label{can__bridge_8c_a940e868438ddbec6d259d01f6351fb7f} 
\index{can\_bridge.c@{can\_bridge.c}!can\_trackers@{can\_trackers}}
\index{can\_trackers@{can\_trackers}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{can\_trackers}
{\footnotesize\ttfamily \textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t} can\+\_\+trackers[MAX\+\_\+\+CAN\+\_\+\+ORIGIN\+\_\+\+TRACKERS]\hspace{0.3cm}{\ttfamily [static]}}



Buffer circular de trackers para solicitudes CAN. 

Array que almacena información de correlación entre solicitudes CAN enviadas al servidor central y sus respuestas esperadas. Se gestiona como un buffer circular para reutilizar entradas.

\begin{DoxySeeAlso}{See also}
\doxyref{can\+\_\+origin\+\_\+tracker\+\_\+t}{p.}{structcan__origin__tracker__t} 
\end{DoxySeeAlso}
\label{can__bridge_8c_a2e69b946477ed035db425886fe261a13} 
\index{can\_bridge.c@{can\_bridge.c}!managed\_elevator\_group@{managed\_elevator\_group}}
\index{managed\_elevator\_group@{managed\_elevator\_group}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{managed\_elevator\_group}
{\footnotesize\ttfamily \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} managed\+\_\+elevator\+\_\+group\hspace{0.3cm}{\ttfamily [extern]}}



Estado del grupo de ascensores gestionado. 

Referencia externa al estado global del grupo de ascensores definido en \doxyref{main.\+c}{p.}{main_8c}. Se utiliza para acceder a información del edificio y ascensores al procesar mensajes CAN.

\begin{DoxySeeAlso}{See also}
\doxyref{main.\+c}{p.}{main_8c} 

\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t}
\end{DoxySeeAlso}
Estado del grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h}
\end{DoxySeeAlso}
Estado del grupo de ascensores gestionado.

Declaración externa para acceder al estado del grupo de ascensores gestionado en \doxyref{main.\+c}{p.}{main_8c}. Contiene información completa de todos los ascensores del edificio.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{main.\+c}{p.}{main_8c}
\end{DoxySeeAlso}
Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 
\end{DoxySeeAlso}
\label{can__bridge_8c_a5d5288a89f4b4b8aea5ab40e134b0167} 
\index{can\_bridge.c@{can\_bridge.c}!next\_can\_tracker\_idx@{next\_can\_tracker\_idx}}
\index{next\_can\_tracker\_idx@{next\_can\_tracker\_idx}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{next\_can\_tracker\_idx}
{\footnotesize\ttfamily int next\+\_\+can\+\_\+tracker\+\_\+idx = 0\hspace{0.3cm}{\ttfamily [static]}}



Índice del siguiente tracker CAN disponible. 

Índice que apunta a la siguiente posición disponible en el buffer circular can\+\_\+trackers. Se incrementa módulo MAX\+\_\+\+CAN\+\_\+\+ORIGIN\+\_\+\+TRACKERS. \label{can__bridge_8c_a765d7d019374cc308d733c7dc216c555} 
\index{can\_bridge.c@{can\_bridge.c}!send\_to\_simulation\_callback@{send\_to\_simulation\_callback}}
\index{send\_to\_simulation\_callback@{send\_to\_simulation\_callback}!can\_bridge.c@{can\_bridge.c}}
\doxysubsubsection{send\_to\_simulation\_callback}
{\footnotesize\ttfamily \textbf{ can\+\_\+send\+\_\+callback\+\_\+t} send\+\_\+to\+\_\+simulation\+\_\+callback = NULL\hspace{0.3cm}{\ttfamily [static]}}



Callback registrado para enviar frames CAN a la simulación. 

Puntero a función que se utiliza para enviar frames CAN de respuesta al simulador. Se registra mediante \doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8c_a82b3383904e65573e79b59f4b7c5ef15}.

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8c_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{can\+\_\+send\+\_\+callback\+\_\+t}{p.}{can__bridge_8h_a1c10dfd5c89b2417f2eacc2d71c91c9a} 
\end{DoxySeeAlso}

\subsection{elevator\_state\_manager}
\doxysection{src/elevator\+\_\+state\+\_\+manager.c File Reference}
\label{elevator__state__manager_8c}\index{src/elevator\_state\_manager.c@{src/elevator\_state\_manager.c}}


Implementación del Gestor de Estado de Ascensores del API Gateway.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
const char $\ast$ \textbf{ door\+\_\+state\+\_\+to\+\_\+string} (\textbf{ door\+\_\+state\+\_\+enum\+\_\+t} state)
\begin{DoxyCompactList}\small\item\em Convierte un estado de puerta a su representación en string. \end{DoxyCompactList}\item 
const char $\ast$ \textbf{ movement\+\_\+direction\+\_\+to\+\_\+string} (\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} direction)
\begin{DoxyCompactList}\small\item\em Convierte una dirección de movimiento a su representación en string. \end{DoxyCompactList}\item 
void \textbf{ init\+\_\+elevator\+\_\+group} (\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group, const char $\ast$edificio\+\_\+id\+\_\+str, int num\+\_\+elevadores, int num\+\_\+pisos)
\begin{DoxyCompactList}\small\item\em Inicializa un grupo de ascensores con configuración específica. \end{DoxyCompactList}\item 
c\+JSON $\ast$ \textbf{ elevator\+\_\+group\+\_\+to\+\_\+json\+\_\+for\+\_\+server} (const \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group, \textbf{ gw\+\_\+request\+\_\+type\+\_\+t} request\+\_\+type, const \textbf{ api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t} $\ast$details)
\begin{DoxyCompactList}\small\item\em Serializa el estado del grupo de ascensores a JSON para el servidor central. \end{DoxyCompactList}\item 
void \textbf{ assign\+\_\+task\+\_\+to\+\_\+elevator} (\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group, const char $\ast$elevator\+\_\+id\+\_\+to\+\_\+update, const char $\ast$task\+\_\+id, int target\+\_\+floor, int current\+\_\+request\+\_\+floor)
\begin{DoxyCompactList}\small\item\em Actualiza el estado de un ascensor tras recibir asignación de tarea. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementación del Gestor de Estado de Ascensores del API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo implementa la gestión completa del estado de ascensores en el API Gateway, proporcionando funcionalidades para\+:


\begin{DoxyItemize}
\item {\bfseries{Inicialización de grupos}}\+: Configuración inicial de grupos de ascensores
\item {\bfseries{Gestión de estado}}\+: Mantenimiento del estado actual de cada ascensor
\item {\bfseries{Asignación de tareas}}\+: Asignación de tareas a ascensores específicos
\item {\bfseries{Notificaciones de llegada}}\+: Procesamiento de llegadas a destinos
\item {\bfseries{Serialización JSON}}\+: Conversión del estado a formato JSON para servidor central
\item {\bfseries{Utilidades de conversión}}\+: Funciones helper para strings de estado
\end{DoxyItemize}

El gestor mantiene información completa de cada ascensor incluyendo\+:
\begin{DoxyItemize}
\item Posición actual (piso)
\item Estado de puertas (abierta/cerrada/abriendo/cerrando)
\item Dirección de movimiento (subiendo/bajando/parado)
\item Tarea actual asignada
\item Destino actual
\item Estado de ocupación
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 

\doxyref{api\+\_\+common\+\_\+defs.\+h}{p.}{api__common__defs_8h} 

api\+\_\+handlers.\+h 
\end{DoxySeeAlso}


\doxysubsection{Function Documentation}
\label{elevator__state__manager_8c_a7a4e6bf1bb74d59a17c1d77689d93ccc} 
\index{elevator\_state\_manager.c@{elevator\_state\_manager.c}!assign\_task\_to\_elevator@{assign\_task\_to\_elevator}}
\index{assign\_task\_to\_elevator@{assign\_task\_to\_elevator}!elevator\_state\_manager.c@{elevator\_state\_manager.c}}
\doxysubsubsection{assign\_task\_to\_elevator()}
{\footnotesize\ttfamily void assign\+\_\+task\+\_\+to\+\_\+elevator (\begin{DoxyParamCaption}\item[{\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group,  }\item[{const char $\ast$}]{elevator\+\_\+id\+\_\+to\+\_\+update,  }\item[{const char $\ast$}]{task\+\_\+id,  }\item[{int}]{target\+\_\+floor,  }\item[{int}]{current\+\_\+request\+\_\+floor }\end{DoxyParamCaption})}



Actualiza el estado de un ascensor tras recibir asignación de tarea. 


\begin{DoxyParams}{Parameters}
{\em group} & Puntero al grupo de ascensores \\
\hline
{\em elevator\+\_\+id\+\_\+to\+\_\+update} & ID del ascensor a actualizar \\
\hline
{\em task\+\_\+id} & El nuevo ID de tarea asignado \\
\hline
{\em target\+\_\+floor} & El piso destino para esta tarea \\
\hline
{\em current\+\_\+request\+\_\+floor} & El piso donde se originó la solicitud\\
\hline
\end{DoxyParams}
Esta función actualiza el estado de un ascensor específico después de recibir una asignación de tarea del servidor central. Establece la tarea, destino, dirección de movimiento y marca el ascensor como ocupado.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+status\+\_\+t}{p.}{structelevator__status__t} 
\end{DoxySeeAlso}
\label{elevator__state__manager_8c_aa035ebf813e4df0e747c251865f217db} 
\index{elevator\_state\_manager.c@{elevator\_state\_manager.c}!door\_state\_to\_string@{door\_state\_to\_string}}
\index{door\_state\_to\_string@{door\_state\_to\_string}!elevator\_state\_manager.c@{elevator\_state\_manager.c}}
\doxysubsubsection{door\_state\_to\_string()}
{\footnotesize\ttfamily const char $\ast$ door\+\_\+state\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{\textbf{ door\+\_\+state\+\_\+enum\+\_\+t}}]{state }\end{DoxyParamCaption})}



Convierte un estado de puerta a su representación en string. 


\begin{DoxyParams}{Parameters}
{\em state} & Estado de puerta a convertir \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String representando el estado de la puerta
\end{DoxyReturn}
Esta función proporciona una representación legible del estado de las puertas del ascensor para logging y serialización JSON.

Estados soportados\+:
\begin{DoxyItemize}
\item DOOR\+\_\+\+CLOSED\+: "{}\+CERRADA"{}
\item DOOR\+\_\+\+OPEN\+: "{}\+ABIERTA"{} ~\newline

\item DOOR\+\_\+\+OPENING\+: "{}\+ABRIENDO"{}
\item DOOR\+\_\+\+CLOSING\+: "{}\+CERRANDO"{}
\item Otros\+: "{}\+DESCONOCIDO"{} 
\end{DoxyItemize}\label{elevator__state__manager_8c_ab9cb3524ec8747ce92dc01657dbb7a5a} 
\index{elevator\_state\_manager.c@{elevator\_state\_manager.c}!elevator\_group\_to\_json\_for\_server@{elevator\_group\_to\_json\_for\_server}}
\index{elevator\_group\_to\_json\_for\_server@{elevator\_group\_to\_json\_for\_server}!elevator\_state\_manager.c@{elevator\_state\_manager.c}}
\doxysubsubsection{elevator\_group\_to\_json\_for\_server()}
{\footnotesize\ttfamily c\+JSON $\ast$ elevator\+\_\+group\+\_\+to\+\_\+json\+\_\+for\+\_\+server (\begin{DoxyParamCaption}\item[{const \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group,  }\item[{\textbf{ gw\+\_\+request\+\_\+type\+\_\+t}}]{request\+\_\+type,  }\item[{const \textbf{ api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t} $\ast$}]{details }\end{DoxyParamCaption})}



Serializa el estado del grupo de ascensores a JSON para el servidor central. 


\begin{DoxyParams}{Parameters}
{\em group} & Puntero al estado del grupo de ascensores \\
\hline
{\em request\+\_\+type} & El tipo de la solicitud original que motiva este payload \\
\hline
{\em details} & Puntero a estructura con detalles específicos de la solicitud (puede ser NULL) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero a objeto c\+JSON que representa el payload, o NULL en caso de error
\end{DoxyReturn}
Esta función convierte el estado completo del grupo de ascensores y los detalles de la solicitud específica a un objeto JSON formateado como espera el servidor central para procesamiento de asignaciones.

El llamador es responsable de liberar el objeto c\+JSON con c\+JSON\+\_\+\+Delete().

\begin{DoxySeeAlso}{See also}
\doxyref{gw\+\_\+request\+\_\+type\+\_\+t}{p.}{elevator__state__manager_8h_a17e4539046553af2ffabda67ff75cbb0} 

\doxyref{api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t}{p.}{structapi__request__details__for__json__t} 
\end{DoxySeeAlso}
\label{elevator__state__manager_8c_ad1f96394c1b8256e78409c71a912eea1} 
\index{elevator\_state\_manager.c@{elevator\_state\_manager.c}!init\_elevator\_group@{init\_elevator\_group}}
\index{init\_elevator\_group@{init\_elevator\_group}!elevator\_state\_manager.c@{elevator\_state\_manager.c}}
\doxysubsubsection{init\_elevator\_group()}
{\footnotesize\ttfamily void init\+\_\+elevator\+\_\+group (\begin{DoxyParamCaption}\item[{\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group,  }\item[{const char $\ast$}]{edificio\+\_\+id\+\_\+str,  }\item[{int}]{num\+\_\+elevadores,  }\item[{int}]{num\+\_\+pisos }\end{DoxyParamCaption})}



Inicializa un grupo de ascensores con configuración específica. 

Inicializa el estado de un grupo de ascensores.


\begin{DoxyParams}{Parameters}
{\em group} & Puntero al grupo de ascensores a inicializar \\
\hline
{\em edificio\+\_\+id\+\_\+str} & ID del edificio al que pertenece el grupo \\
\hline
{\em num\+\_\+elevadores} & Número de ascensores en el grupo \\
\hline
{\em num\+\_\+pisos} & Número de pisos del edificio\\
\hline
\end{DoxyParams}
Esta función inicializa completamente un grupo de ascensores con la configuración especificada. Realiza las siguientes operaciones\+:


\begin{DoxyEnumerate}
\item {\bfseries{Validación}}\+: Verifica parámetros de entrada válidos
\item {\bfseries{Limpieza}}\+: Inicializa la estructura a cero
\item {\bfseries{Configuración del grupo}}\+: Establece ID del edificio y número de ascensores
\item {\bfseries{Inicialización individual}}\+: Configura cada ascensor con\+:
\begin{DoxyItemize}
\item ID único (formato\+: \{edificio\+\_\+id\}A\{numero\})
\item Piso inicial\+: 0 (planta baja)
\item Puertas cerradas
\item Sin tarea asignada
\item Estado parado y disponible
\end{DoxyItemize}
\end{DoxyEnumerate}

\begin{DoxyNote}{Note}
El número de ascensores debe estar entre 1 y MAX\+\_\+\+ELEVATORS\+\_\+\+PER\+\_\+\+GATEWAY 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+status\+\_\+t}{p.}{structelevator__status__t} 
\end{DoxySeeAlso}
\label{elevator__state__manager_8c_a9f8c127c735277e87e71a52ba68d2e56} 
\index{elevator\_state\_manager.c@{elevator\_state\_manager.c}!movement\_direction\_to\_string@{movement\_direction\_to\_string}}
\index{movement\_direction\_to\_string@{movement\_direction\_to\_string}!elevator\_state\_manager.c@{elevator\_state\_manager.c}}
\doxysubsubsection{movement\_direction\_to\_string()}
{\footnotesize\ttfamily const char $\ast$ movement\+\_\+direction\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t}}]{direction }\end{DoxyParamCaption})}



Convierte una dirección de movimiento a su representación en string. 


\begin{DoxyParams}{Parameters}
{\em direction} & Dirección de movimiento a convertir \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String representando la dirección de movimiento
\end{DoxyReturn}
Esta función proporciona una representación legible de la dirección de movimiento del ascensor para logging y serialización JSON.

Direcciones soportadas\+:
\begin{DoxyItemize}
\item MOVING\+\_\+\+UP\+: "{}\+SUBIENDO"{}
\item MOVING\+\_\+\+DOWN\+: "{}\+BAJANDO"{}
\item STOPPED\+: "{}\+PARADO"{}
\item Otros\+: "{}\+DESCONOCIDO"{} 
\end{DoxyItemize}
\subsection{execution\_logger}
\doxysection{src/execution\+\_\+logger.c File Reference}
\label{execution__logger_8c}\index{src/execution\_logger.c@{src/execution\_logger.c}}


Implementación del Sistema de Logging de Ejecuciones.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static bool \textbf{ create\+\_\+directory} (const char $\ast$path)
\begin{DoxyCompactList}\small\item\em Crea un directorio recursivamente. \end{DoxyCompactList}\item 
static void \textbf{ get\+\_\+formatted\+\_\+timestamp} (char $\ast$buffer, size\+\_\+t buffer\+\_\+size, const char $\ast$format)
\begin{DoxyCompactList}\small\item\em Obtiene el timestamp actual formateado. \end{DoxyCompactList}\item 
static void \textbf{ write\+\_\+markdown\+\_\+header} (void)
\begin{DoxyCompactList}\small\item\em Escribe el header del archivo Markdown. \end{DoxyCompactList}\item 
static void \textbf{ write\+\_\+markdown\+\_\+footer} (void)
\begin{DoxyCompactList}\small\item\em Escribe el footer del archivo Markdown con estadísticas finales. \end{DoxyCompactList}\item 
static const char $\ast$ \textbf{ get\+\_\+event\+\_\+label} (\textbf{ log\+\_\+event\+\_\+type\+\_\+t} type)
\begin{DoxyCompactList}\small\item\em Convierte el tipo de evento a etiqueta de texto profesional. \end{DoxyCompactList}\item 
bool \textbf{ exec\+\_\+logger\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Inicializa el sistema de logging de ejecuciones. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+finish} (void)
\begin{DoxyCompactList}\small\item\em Finaliza el sistema de logging y cierra el archivo. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+event} (\textbf{ log\+\_\+event\+\_\+type\+\_\+t} type, const char $\ast$description, const char $\ast$details)
\begin{DoxyCompactList}\small\item\em Registra un evento en el log. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+start} (const char $\ast$building\+\_\+id, int num\+\_\+requests)
\begin{DoxyCompactList}\small\item\em Registra el inicio de la simulación. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+end} (int successful\+\_\+requests, int total\+\_\+requests)
\begin{DoxyCompactList}\small\item\em Registra el fin de la simulación. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+sent} (unsigned int can\+\_\+id, int dlc, const unsigned char $\ast$data, const char $\ast$description)
\begin{DoxyCompactList}\small\item\em Registra un frame CAN enviado. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+received} (unsigned int can\+\_\+id, int dlc, const unsigned char $\ast$data, const char $\ast$description)
\begin{DoxyCompactList}\small\item\em Registra un frame CAN recibido. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+sent} (const char $\ast$method, const char $\ast$uri, const char $\ast$payload)
\begin{DoxyCompactList}\small\item\em Registra una petición Co\+AP enviada. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+received} (const char $\ast$code, const char $\ast$payload)
\begin{DoxyCompactList}\small\item\em Registra una respuesta Co\+AP recibida. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+assigned} (const char $\ast$task\+\_\+id, const char $\ast$elevator\+\_\+id, int target\+\_\+floor)
\begin{DoxyCompactList}\small\item\em Registra la asignación de una tarea. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+elevator\+\_\+moved} (const char $\ast$elevator\+\_\+id, int from\+\_\+floor, int to\+\_\+floor, const char $\ast$direction)
\begin{DoxyCompactList}\small\item\em Registra el movimiento de un ascensor. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+completed} (const char $\ast$task\+\_\+id, const char $\ast$elevator\+\_\+id, int final\+\_\+floor)
\begin{DoxyCompactList}\small\item\em Registra la completación de una tarea. \end{DoxyCompactList}\item 
void \textbf{ exec\+\_\+logger\+\_\+log\+\_\+error} (const char $\ast$error\+\_\+code, const char $\ast$error\+\_\+message)
\begin{DoxyCompactList}\small\item\em Registra un error del sistema. \end{DoxyCompactList}\item 
const \textbf{ execution\+\_\+stats\+\_\+t} $\ast$ \textbf{ exec\+\_\+logger\+\_\+get\+\_\+stats} (void)
\begin{DoxyCompactList}\small\item\em Obtiene las estadísticas actuales de ejecución. \end{DoxyCompactList}\item 
bool \textbf{ exec\+\_\+logger\+\_\+is\+\_\+active} (void)
\begin{DoxyCompactList}\small\item\em Verifica si el logger está activo. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static FILE $\ast$ \textbf{ log\+\_\+file} = NULL
\begin{DoxyCompactList}\small\item\em Archivo de log actual. \end{DoxyCompactList}\item 
static \textbf{ execution\+\_\+stats\+\_\+t} \textbf{ stats}
\begin{DoxyCompactList}\small\item\em Estadísticas de ejecución. \end{DoxyCompactList}\item 
static time\+\_\+t \textbf{ start\+\_\+time}
\begin{DoxyCompactList}\small\item\em Tiempo de inicio de ejecución. \end{DoxyCompactList}\item 
static bool \textbf{ logger\+\_\+active} = false
\begin{DoxyCompactList}\small\item\em Estado del logger. \end{DoxyCompactList}\item 
static char \textbf{ current\+\_\+log\+\_\+path} [MAX\+\_\+\+LOG\+\_\+\+PATH]
\begin{DoxyCompactList}\small\item\em Ruta del archivo actual. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementación del Sistema de Logging de Ejecuciones. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}


\doxysubsection{Function Documentation}
\label{execution__logger_8c_afe09e09b085938028ae7cd93dea9f27e} 
\index{execution\_logger.c@{execution\_logger.c}!create\_directory@{create\_directory}}
\index{create\_directory@{create\_directory}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{create\_directory()}
{\footnotesize\ttfamily static bool create\+\_\+directory (\begin{DoxyParamCaption}\item[{const char $\ast$}]{path }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Crea un directorio recursivamente. 


\begin{DoxyParams}{Parameters}
{\em path} & Ruta del directorio a crear \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true si se creó exitosamente, false en caso de error 
\end{DoxyReturn}
\label{execution__logger_8c_ae0868cf99c3976e5054e296a99a865a8} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_finish@{exec\_logger\_finish}}
\index{exec\_logger\_finish@{exec\_logger\_finish}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_finish()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+finish (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Finaliza el sistema de logging y cierra el archivo. 

Esta función\+:
\begin{DoxyItemize}
\item Calcula estadísticas finales
\item Escribe el resumen de ejecución
\item Cierra el archivo de log
\item Limpia recursos 
\end{DoxyItemize}\label{execution__logger_8c_a5fdd5443b630dc1afbbc2c528b6eae89} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_get\_stats@{exec\_logger\_get\_stats}}
\index{exec\_logger\_get\_stats@{exec\_logger\_get\_stats}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_get\_stats()}
{\footnotesize\ttfamily const \textbf{ execution\+\_\+stats\+\_\+t} $\ast$ exec\+\_\+logger\+\_\+get\+\_\+stats (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Obtiene las estadísticas actuales de ejecución. 

\begin{DoxyReturn}{Returns}
Puntero a las estadísticas (solo lectura) 
\end{DoxyReturn}
\label{execution__logger_8c_a8f17ab3d08e18defbc6bc3894b87ad57} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_init@{exec\_logger\_init}}
\index{exec\_logger\_init@{exec\_logger\_init}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_init()}
{\footnotesize\ttfamily bool exec\+\_\+logger\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Inicializa el sistema de logging de ejecuciones. 

\begin{DoxyReturn}{Returns}
true si se inicializó correctamente, false en caso de error
\end{DoxyReturn}
Esta función\+:
\begin{DoxyItemize}
\item Crea las carpetas necesarias por fecha
\item Genera el nombre del archivo de log
\item Inicializa las estructuras de estadísticas
\item Escribe el header del archivo Markdown 
\end{DoxyItemize}\label{execution__logger_8c_a5ce893b0367275087161fc41ee3ea01b} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_is\_active@{exec\_logger\_is\_active}}
\index{exec\_logger\_is\_active@{exec\_logger\_is\_active}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_is\_active()}
{\footnotesize\ttfamily bool exec\+\_\+logger\+\_\+is\+\_\+active (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Verifica si el logger está activo. 

\begin{DoxyReturn}{Returns}
true si está activo, false si no 
\end{DoxyReturn}
\label{execution__logger_8c_ae52f012f4fc98b850c48a36881f5ef4b} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_can\_received@{exec\_logger\_log\_can\_received}}
\index{exec\_logger\_log\_can\_received@{exec\_logger\_log\_can\_received}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_can\_received()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+received (\begin{DoxyParamCaption}\item[{unsigned int}]{can\+\_\+id,  }\item[{int}]{dlc,  }\item[{const unsigned char $\ast$}]{data,  }\item[{const char $\ast$}]{description }\end{DoxyParamCaption})}



Registra un frame CAN recibido. 


\begin{DoxyParams}{Parameters}
{\em can\+\_\+id} & ID del frame CAN \\
\hline
{\em dlc} & Longitud de datos \\
\hline
{\em data} & Datos del frame \\
\hline
{\em description} & Descripción del evento \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_aa27056e265d9a0470c136c31fbb3e9d0} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_can\_sent@{exec\_logger\_log\_can\_sent}}
\index{exec\_logger\_log\_can\_sent@{exec\_logger\_log\_can\_sent}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_can\_sent()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+can\+\_\+sent (\begin{DoxyParamCaption}\item[{unsigned int}]{can\+\_\+id,  }\item[{int}]{dlc,  }\item[{const unsigned char $\ast$}]{data,  }\item[{const char $\ast$}]{description }\end{DoxyParamCaption})}



Registra un frame CAN enviado. 


\begin{DoxyParams}{Parameters}
{\em can\+\_\+id} & ID del frame CAN \\
\hline
{\em dlc} & Longitud de datos \\
\hline
{\em data} & Datos del frame \\
\hline
{\em description} & Descripción del evento \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_ad0470fcf53f9a93e9c78e3f663b6606a} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_coap\_received@{exec\_logger\_log\_coap\_received}}
\index{exec\_logger\_log\_coap\_received@{exec\_logger\_log\_coap\_received}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_coap\_received()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+received (\begin{DoxyParamCaption}\item[{const char $\ast$}]{code,  }\item[{const char $\ast$}]{payload }\end{DoxyParamCaption})}



Registra una respuesta Co\+AP recibida. 


\begin{DoxyParams}{Parameters}
{\em code} & Código de respuesta Co\+AP \\
\hline
{\em payload} & Payload de la respuesta (puede ser NULL) \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_a529e2cea53c04d196f94d5165ce2f2da} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_coap\_sent@{exec\_logger\_log\_coap\_sent}}
\index{exec\_logger\_log\_coap\_sent@{exec\_logger\_log\_coap\_sent}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_coap\_sent()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+coap\+\_\+sent (\begin{DoxyParamCaption}\item[{const char $\ast$}]{method,  }\item[{const char $\ast$}]{uri,  }\item[{const char $\ast$}]{payload }\end{DoxyParamCaption})}



Registra una petición Co\+AP enviada. 


\begin{DoxyParams}{Parameters}
{\em method} & Método Co\+AP (GET, POST, etc.) \\
\hline
{\em uri} & URI del recurso \\
\hline
{\em payload} & Payload de la petición (puede ser NULL) \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_ac0d70f4be37b4af70a10aba97fd4f448} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_elevator\_moved@{exec\_logger\_log\_elevator\_moved}}
\index{exec\_logger\_log\_elevator\_moved@{exec\_logger\_log\_elevator\_moved}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_elevator\_moved()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+elevator\+\_\+moved (\begin{DoxyParamCaption}\item[{const char $\ast$}]{elevator\+\_\+id,  }\item[{int}]{from\+\_\+floor,  }\item[{int}]{to\+\_\+floor,  }\item[{const char $\ast$}]{direction }\end{DoxyParamCaption})}



Registra el movimiento de un ascensor. 


\begin{DoxyParams}{Parameters}
{\em elevator\+\_\+id} & ID del ascensor \\
\hline
{\em from\+\_\+floor} & Piso origen \\
\hline
{\em to\+\_\+floor} & Piso destino \\
\hline
{\em direction} & Dirección del movimiento \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_af6629562e75625c3758a34ef00d93f34} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_error@{exec\_logger\_log\_error}}
\index{exec\_logger\_log\_error@{exec\_logger\_log\_error}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_error()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+error (\begin{DoxyParamCaption}\item[{const char $\ast$}]{error\+\_\+code,  }\item[{const char $\ast$}]{error\+\_\+message }\end{DoxyParamCaption})}



Registra un error del sistema. 


\begin{DoxyParams}{Parameters}
{\em error\+\_\+code} & Código de error \\
\hline
{\em error\+\_\+message} & Mensaje de error \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_a0d26263b498931ad084d10c45b1e2280} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_event@{exec\_logger\_log\_event}}
\index{exec\_logger\_log\_event@{exec\_logger\_log\_event}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_event()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+event (\begin{DoxyParamCaption}\item[{\textbf{ log\+\_\+event\+\_\+type\+\_\+t}}]{type,  }\item[{const char $\ast$}]{description,  }\item[{const char $\ast$}]{details }\end{DoxyParamCaption})}



Registra un evento en el log. 


\begin{DoxyParams}{Parameters}
{\em type} & Tipo de evento \\
\hline
{\em description} & Descripción breve del evento \\
\hline
{\em details} & Detalles adicionales (puede ser NULL) \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_a502b75cee9921726287da66a1973d0c0} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_simulation\_end@{exec\_logger\_log\_simulation\_end}}
\index{exec\_logger\_log\_simulation\_end@{exec\_logger\_log\_simulation\_end}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_simulation\_end()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+end (\begin{DoxyParamCaption}\item[{int}]{successful\+\_\+requests,  }\item[{int}]{total\+\_\+requests }\end{DoxyParamCaption})}



Registra el fin de la simulación. 


\begin{DoxyParams}{Parameters}
{\em successful\+\_\+requests} & Número de peticiones exitosas \\
\hline
{\em total\+\_\+requests} & Número total de peticiones \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_afe36ef96b0a0346e8f389ddd550d1d62} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_simulation\_start@{exec\_logger\_log\_simulation\_start}}
\index{exec\_logger\_log\_simulation\_start@{exec\_logger\_log\_simulation\_start}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_simulation\_start()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+simulation\+\_\+start (\begin{DoxyParamCaption}\item[{const char $\ast$}]{building\+\_\+id,  }\item[{int}]{num\+\_\+requests }\end{DoxyParamCaption})}



Registra el inicio de la simulación. 


\begin{DoxyParams}{Parameters}
{\em building\+\_\+id} & ID del edificio seleccionado \\
\hline
{\em num\+\_\+requests} & Número de peticiones a ejecutar \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_ac545eb869f25dc8a259c8cc8d79012be} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_task\_assigned@{exec\_logger\_log\_task\_assigned}}
\index{exec\_logger\_log\_task\_assigned@{exec\_logger\_log\_task\_assigned}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_task\_assigned()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+assigned (\begin{DoxyParamCaption}\item[{const char $\ast$}]{task\+\_\+id,  }\item[{const char $\ast$}]{elevator\+\_\+id,  }\item[{int}]{target\+\_\+floor }\end{DoxyParamCaption})}



Registra la asignación de una tarea. 


\begin{DoxyParams}{Parameters}
{\em task\+\_\+id} & ID de la tarea \\
\hline
{\em elevator\+\_\+id} & ID del ascensor asignado \\
\hline
{\em target\+\_\+floor} & Piso destino \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_a22e3151602bf4070c2c7ffa9fe505487} 
\index{execution\_logger.c@{execution\_logger.c}!exec\_logger\_log\_task\_completed@{exec\_logger\_log\_task\_completed}}
\index{exec\_logger\_log\_task\_completed@{exec\_logger\_log\_task\_completed}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{exec\_logger\_log\_task\_completed()}
{\footnotesize\ttfamily void exec\+\_\+logger\+\_\+log\+\_\+task\+\_\+completed (\begin{DoxyParamCaption}\item[{const char $\ast$}]{task\+\_\+id,  }\item[{const char $\ast$}]{elevator\+\_\+id,  }\item[{int}]{final\+\_\+floor }\end{DoxyParamCaption})}



Registra la completación de una tarea. 


\begin{DoxyParams}{Parameters}
{\em task\+\_\+id} & ID de la tarea completada \\
\hline
{\em elevator\+\_\+id} & ID del ascensor que completó la tarea \\
\hline
{\em final\+\_\+floor} & Piso final donde se completó \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_a8ed1ff24f2950362e7a8addbef456421} 
\index{execution\_logger.c@{execution\_logger.c}!get\_event\_label@{get\_event\_label}}
\index{get\_event\_label@{get\_event\_label}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{get\_event\_label()}
{\footnotesize\ttfamily static const char $\ast$ get\+\_\+event\+\_\+label (\begin{DoxyParamCaption}\item[{\textbf{ log\+\_\+event\+\_\+type\+\_\+t}}]{type }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Convierte el tipo de evento a etiqueta de texto profesional. 

\label{execution__logger_8c_a2cea881b6cfedf5948d651a0cf39567c} 
\index{execution\_logger.c@{execution\_logger.c}!get\_formatted\_timestamp@{get\_formatted\_timestamp}}
\index{get\_formatted\_timestamp@{get\_formatted\_timestamp}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{get\_formatted\_timestamp()}
{\footnotesize\ttfamily static void get\+\_\+formatted\+\_\+timestamp (\begin{DoxyParamCaption}\item[{char $\ast$}]{buffer,  }\item[{size\+\_\+t}]{buffer\+\_\+size,  }\item[{const char $\ast$}]{format }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Obtiene el timestamp actual formateado. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer donde escribir el timestamp \\
\hline
{\em buffer\+\_\+size} & Tamaño del buffer \\
\hline
{\em format} & Formato del timestamp \\
\hline
\end{DoxyParams}
\label{execution__logger_8c_a589fa614f2a4645b9193922031cfea0c} 
\index{execution\_logger.c@{execution\_logger.c}!write\_markdown\_footer@{write\_markdown\_footer}}
\index{write\_markdown\_footer@{write\_markdown\_footer}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{write\_markdown\_footer()}
{\footnotesize\ttfamily static void write\+\_\+markdown\+\_\+footer (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Escribe el footer del archivo Markdown con estadísticas finales. 

\label{execution__logger_8c_aa13afab7b82daed8a9456e2cbf63418d} 
\index{execution\_logger.c@{execution\_logger.c}!write\_markdown\_header@{write\_markdown\_header}}
\index{write\_markdown\_header@{write\_markdown\_header}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{write\_markdown\_header()}
{\footnotesize\ttfamily static void write\+\_\+markdown\+\_\+header (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Escribe el header del archivo Markdown. 



\doxysubsection{Variable Documentation}
\label{execution__logger_8c_a244aff6fb3109dbf30823dbca39ceeca} 
\index{execution\_logger.c@{execution\_logger.c}!current\_log\_path@{current\_log\_path}}
\index{current\_log\_path@{current\_log\_path}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{current\_log\_path}
{\footnotesize\ttfamily char current\+\_\+log\+\_\+path[MAX\+\_\+\+LOG\+\_\+\+PATH]\hspace{0.3cm}{\ttfamily [static]}}



Ruta del archivo actual. 

\label{execution__logger_8c_ab936051f5aaca44c6c3c41dee0d19c36} 
\index{execution\_logger.c@{execution\_logger.c}!log\_file@{log\_file}}
\index{log\_file@{log\_file}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{log\_file}
{\footnotesize\ttfamily FILE$\ast$ log\+\_\+file = NULL\hspace{0.3cm}{\ttfamily [static]}}



Archivo de log actual. 

\label{execution__logger_8c_abe140c99a0b3244a642869db54f6b540} 
\index{execution\_logger.c@{execution\_logger.c}!logger\_active@{logger\_active}}
\index{logger\_active@{logger\_active}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{logger\_active}
{\footnotesize\ttfamily bool logger\+\_\+active = false\hspace{0.3cm}{\ttfamily [static]}}



Estado del logger. 

\label{execution__logger_8c_ad20e89e0c86aa812dc3a8e2fb7b5777b} 
\index{execution\_logger.c@{execution\_logger.c}!start\_time@{start\_time}}
\index{start\_time@{start\_time}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{start\_time}
{\footnotesize\ttfamily time\+\_\+t start\+\_\+time\hspace{0.3cm}{\ttfamily [static]}}



Tiempo de inicio de ejecución. 

\label{execution__logger_8c_a1e38e8d813986acea3047c173bdca7b5} 
\index{execution\_logger.c@{execution\_logger.c}!stats@{stats}}
\index{stats@{stats}!execution\_logger.c@{execution\_logger.c}}
\doxysubsubsection{stats}
{\footnotesize\ttfamily \textbf{ execution\+\_\+stats\+\_\+t} stats\hspace{0.3cm}{\ttfamily [static]}}



Estadísticas de ejecución. 


\subsection{main}
\doxysection{src/main.c File Reference}
\label{main_8c}\index{src/main.c@{src/main.c}}


Punto de entrada principal del API Gateway del Sistema de Control de Ascensores.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static char $\ast$ \textbf{ generate\+\_\+unique\+\_\+identity} ()
\item 
static char $\ast$ \textbf{ generate\+\_\+unique\+\_\+psk\+\_\+key} ()
\item 
static void \textbf{ simulate\+\_\+elevator\+\_\+group\+\_\+step} (coap\+\_\+context\+\_\+t $\ast$ctx, \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group)
\begin{DoxyCompactList}\small\item\em Simula un paso de movimiento para todos los ascensores del grupo. \end{DoxyCompactList}\item 
void \textbf{ inicializar\+\_\+mi\+\_\+simulacion\+\_\+ascensor} (void)
\begin{DoxyCompactList}\small\item\em Inicializa el simulador de ascensores. \end{DoxyCompactList}\item 
void \textbf{ simular\+\_\+eventos\+\_\+ascensor} (void)
\begin{DoxyCompactList}\small\item\em Ejecuta una secuencia de eventos simulados de ascensor desde JSON. \end{DoxyCompactList}\item 
static int \textbf{ event\+\_\+handler\+\_\+gw} (coap\+\_\+session\+\_\+t $\ast$session, coap\+\_\+event\+\_\+t event)
\begin{DoxyCompactList}\small\item\em Manejador de eventos Co\+AP para sesiones DTLS. \end{DoxyCompactList}\item 
coap\+\_\+session\+\_\+t $\ast$ \textbf{ get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session} (coap\+\_\+context\+\_\+t $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Obtiene o crea una sesión DTLS con el servidor central. \end{DoxyCompactList}\item 
int \textbf{ main} (int argc, char $\ast$argv[$\,$])
\begin{DoxyCompactList}\small\item\em Main function for the API Gateway. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile sig\+\_\+atomic\+\_\+t \textbf{ quit\+\_\+main\+\_\+loop} = 0
\begin{DoxyCompactList}\small\item\em Bandera global para controlar el bucle principal de la aplicación. \end{DoxyCompactList}\item 
\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} \textbf{ managed\+\_\+elevator\+\_\+group}
\begin{DoxyCompactList}\small\item\em Estado global del grupo de ascensores gestionado por este gateway. \end{DoxyCompactList}\item 
coap\+\_\+context\+\_\+t $\ast$ \textbf{ g\+\_\+coap\+\_\+context} = NULL
\begin{DoxyCompactList}\small\item\em Contexto Co\+AP global para la simulación y gestión de sesiones. \end{DoxyCompactList}\item 
coap\+\_\+session\+\_\+t $\ast$ \textbf{ g\+\_\+dtls\+\_\+session\+\_\+to\+\_\+central\+\_\+server} = NULL
\begin{DoxyCompactList}\small\item\em Sesión DTLS global con el servidor central. \end{DoxyCompactList}\item 
static coap\+\_\+context\+\_\+t $\ast$ \textbf{ g\+\_\+coap\+\_\+context\+\_\+for\+\_\+session\+\_\+mgnt} = NULL
\begin{DoxyCompactList}\small\item\em Contexto Co\+AP para la gestión de sesiones DTLS. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Punto de entrada principal del API Gateway del Sistema de Control de Ascensores. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo implementa el API Gateway que actúa como intermediario entre los controladores CAN de ascensores y el servidor central. Sus funciones principales\+:


\begin{DoxyItemize}
\item {\bfseries{Inicialización Co\+AP}}\+: Configuración del contexto Co\+AP con soporte DTLS-\/\+PSK
\item {\bfseries{Gestión de Recursos}}\+: Registro de endpoints Co\+AP para recibir solicitudes
\item {\bfseries{Puente CAN-\/\+Co\+AP}}\+: Transformación de mensajes CAN a solicitudes Co\+AP
\item {\bfseries{Gestión de Estado}}\+: Mantenimiento del estado local de ascensores
\item {\bfseries{Comunicación Segura}}\+: Establecimiento de sesiones DTLS con servidor central
\item {\bfseries{Simulación}}\+: Simulación de movimiento de ascensores para testing
\item {\bfseries{Manejo de Señales}}\+: Terminación elegante con SIGINT
\end{DoxyItemize}

El gateway procesa dos tipos principales de solicitudes\+:
\begin{DoxyItemize}
\item Llamadas de piso (floor calls) desde botones externos
\item Solicitudes de cabina (cabin requests) desde interior del ascensor
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
api\+\_\+handlers.\+h 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 

\doxyref{can\+\_\+bridge.\+h}{p.}{can__bridge_8h} 

\doxyref{coap\+\_\+config.\+h}{p.}{coap__config_8h} 
\end{DoxySeeAlso}


\doxysubsection{Function Documentation}
\label{main_8c_a4d72c24b61707ff5f39a4123ca8cd833} 
\index{main.c@{main.c}!event\_handler\_gw@{event\_handler\_gw}}
\index{event\_handler\_gw@{event\_handler\_gw}!main.c@{main.c}}
\doxysubsubsection{event\_handler\_gw()}
{\footnotesize\ttfamily static int event\+\_\+handler\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+session\+\_\+t $\ast$}]{session,  }\item[{coap\+\_\+event\+\_\+t}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Manejador de eventos Co\+AP para sesiones DTLS. 


\begin{DoxyParams}{Parameters}
{\em session} & Sesión Co\+AP que generó el evento \\
\hline
{\em event} & Tipo de evento ocurrido \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si el evento se procesó correctamente
\end{DoxyReturn}
Esta función maneja eventos relacionados con sesiones DTLS, especialmente cierres de conexión y errores. Limpia automáticamente la sesión global cuando se detecta que se ha cerrado o ha fallado.

Eventos manejados\+:
\begin{DoxyItemize}
\item COAP\+\_\+\+EVENT\+\_\+\+DTLS\+\_\+\+CLOSED\+: Sesión DTLS cerrada
\item COAP\+\_\+\+EVENT\+\_\+\+DTLS\+\_\+\+ERROR\+: Error en sesión DTLS
\item COAP\+\_\+\+EVENT\+\_\+\+SESSION\+\_\+\+CLOSED\+: Sesión cerrada
\item COAP\+\_\+\+EVENT\+\_\+\+SESSION\+\_\+\+FAILED\+: Sesión falló 
\end{DoxyItemize}\label{main_8c_aaab19c59907fdd4643b33b5056420f9b} 
\index{main.c@{main.c}!generate\_unique\_identity@{generate\_unique\_identity}}
\index{generate\_unique\_identity@{generate\_unique\_identity}!main.c@{main.c}}
\doxysubsubsection{generate\_unique\_identity()}
{\footnotesize\ttfamily static char $\ast$ generate\+\_\+unique\+\_\+identity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\label{main_8c_a7deba370f74d01d89ecd93cb376b1873} 
\index{main.c@{main.c}!generate\_unique\_psk\_key@{generate\_unique\_psk\_key}}
\index{generate\_unique\_psk\_key@{generate\_unique\_psk\_key}!main.c@{main.c}}
\doxysubsubsection{generate\_unique\_psk\_key()}
{\footnotesize\ttfamily static char $\ast$ generate\+\_\+unique\+\_\+psk\+\_\+key (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\label{main_8c_a7910799dc4997ea7ff42bb0339134d94} 
\index{main.c@{main.c}!get\_or\_create\_central\_server\_dtls\_session@{get\_or\_create\_central\_server\_dtls\_session}}
\index{get\_or\_create\_central\_server\_dtls\_session@{get\_or\_create\_central\_server\_dtls\_session}!main.c@{main.c}}
\doxysubsubsection{get\_or\_create\_central\_server\_dtls\_session()}
{\footnotesize\ttfamily coap\+\_\+session\+\_\+t $\ast$ get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session (\begin{DoxyParamCaption}\item[{coap\+\_\+context\+\_\+t $\ast$}]{ctx }\end{DoxyParamCaption})}



Obtiene o crea una sesión DTLS con el servidor central. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Contexto Co\+AP a utilizar para la sesión \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero a la sesión DTLS establecida, o NULL en caso de error
\end{DoxyReturn}
Esta función implementa un patrón singleton para la gestión de sesiones DTLS con el servidor central. Reutiliza sesiones existentes cuando están activas y crea nuevas sesiones cuando es necesario.

Comportamiento\+:
\begin{DoxyEnumerate}
\item Si existe una sesión activa y establecida, la reutiliza
\item Si la sesión existe pero no está establecida, la libera y crea una nueva
\item Si no existe sesión, crea una nueva con configuración DTLS-\/\+PSK
\item Registra el manejador de eventos para gestión automática de la sesión
\end{DoxyEnumerate}

La función utiliza las siguientes configuraciones\+:
\begin{DoxyItemize}
\item IP del servidor\+: CENTRAL\+\_\+\+SERVER\+\_\+\+IP
\item Puerto del servidor\+: CENTRAL\+\_\+\+SERVER\+\_\+\+PORT ~\newline

\item Identidad PSK\+: IDENTITY\+\_\+\+TO\+\_\+\+PRESENT\+\_\+\+TO\+\_\+\+SERVER
\item Clave PSK\+: KEY\+\_\+\+FOR\+\_\+\+SERVER
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{event\+\_\+handler\+\_\+gw()}{p.}{main_8c_a4d72c24b61707ff5f39a4123ca8cd833} 

\doxyref{coap\+\_\+config.\+h}{p.}{coap__config_8h} 
\end{DoxySeeAlso}
\label{main_8c_acfc4758bf8842f413c4d9e1c5ce6053d} 
\index{main.c@{main.c}!inicializar\_mi\_simulacion\_ascensor@{inicializar\_mi\_simulacion\_ascensor}}
\index{inicializar\_mi\_simulacion\_ascensor@{inicializar\_mi\_simulacion\_ascensor}!main.c@{main.c}}
\doxysubsubsection{inicializar\_mi\_simulacion\_ascensor()}
{\footnotesize\ttfamily void inicializar\+\_\+mi\+\_\+simulacion\+\_\+ascensor (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Inicializa el simulador de ascensores. 

Esta función configura el simulador registrando el callback de respuesta CAN en el puente CAN-\/\+Co\+AP del API Gateway y cargando los datos de simulación desde el archivo JSON.

{\bfseries{Operaciones realizadas\+:}}
\begin{DoxyItemize}
\item Registro del callback de respuesta CAN
\item Carga de datos de simulación desde JSON
\item Inicialización de estructuras internas
\item Configuración de logging del simulador
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8c_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{cargar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 

\doxyref{mi\+\_\+simulador\+\_\+recibe\+\_\+can\+\_\+gw()}{p.}{mi__simulador__ascensor_8c_adfcf33ff0806b77c246bbd870b029566} 
\end{DoxySeeAlso}
\label{main_8c_a0ddf1224851353fc92bfbff6f499fa97} 
\index{main.c@{main.c}!main@{main}}
\index{main@{main}!main.c@{main.c}}
\doxysubsubsection{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv[$\,$] }\end{DoxyParamCaption})}



Main function for the API Gateway. 

Initializes libcoap, sets up the Co\+AP server endpoint for listening to elevator clients, registers Co\+AP resource handlers, and enters the main I/O processing loop. The gateway listens for client requests, forwards them to a central server, and relays responses back to the clients.


\begin{DoxyParams}{Parameters}
{\em argc} & Número de argumentos de línea de comandos \\
\hline
{\em argv} & Array de argumentos de línea de comandos argv[1] (opcional)\+: Puerto de escucha (por defecto usa GW\+\_\+\+LISTEN\+\_\+\+PORT)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
EXIT\+\_\+\+SUCCESS on successful execution and shutdown, EXIT\+\_\+\+FAILURE on error. 
\end{DoxyReturn}
\label{main_8c_a5c86f739de835826e9fa6dd607c52ec9} 
\index{main.c@{main.c}!simular\_eventos\_ascensor@{simular\_eventos\_ascensor}}
\index{simular\_eventos\_ascensor@{simular\_eventos\_ascensor}!main.c@{main.c}}
\doxysubsubsection{simular\_eventos\_ascensor()}
{\footnotesize\ttfamily void simular\+\_\+eventos\+\_\+ascensor (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Ejecuta una secuencia de eventos simulados de ascensor desde JSON. 

Esta función reemplaza la simulación hardcodeada anterior. Ahora carga datos de simulación desde un archivo JSON, selecciona un edificio aleatorio y ejecuta todas sus peticiones secuencialmente.

{\bfseries{Proceso de simulación\+:}}
\begin{DoxyEnumerate}
\item Verifica si hay datos de simulación cargados
\item Selecciona un edificio aleatorio de los 100 disponibles
\item Configura el ID del edificio en el sistema
\item Ejecuta las 10 peticiones del edificio secuencialmente
\item Procesa I/O Co\+AP entre cada petición
\end{DoxyEnumerate}

{\bfseries{Fallback\+:}} Si no se pueden cargar los datos JSON, ejecuta la simulación básica de 2 peticiones hardcodeadas como antes.

{\bfseries{Características\+:}}
\begin{DoxyItemize}
\item Procesamiento de I/O Co\+AP entre eventos
\item Logging detallado de cada paso
\item Sincronización para evitar condiciones de carrera
\item Configuración automática del ID de edificio
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{cargar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 

\doxyref{seleccionar\+\_\+edificio\+\_\+aleatorio()}{p.}{group__simulation__functions_ga87620ad51d06f241a3106a36c40ac787} 

\doxyref{simular\+\_\+llamada\+\_\+de\+\_\+piso\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_ad2f8184c447385d5155da6a8d87e6c16} 

\doxyref{simular\+\_\+solicitud\+\_\+cabina\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_a75bd27a88662d9e2ac061e5285fc7ecb} 

coap\+\_\+io\+\_\+process() 
\end{DoxySeeAlso}
\label{main_8c_af318206d98c90d1ed8b33a0f564ad219} 
\index{main.c@{main.c}!simulate\_elevator\_group\_step@{simulate\_elevator\_group\_step}}
\index{simulate\_elevator\_group\_step@{simulate\_elevator\_group\_step}!main.c@{main.c}}
\doxysubsubsection{simulate\_elevator\_group\_step()}
{\footnotesize\ttfamily static void simulate\+\_\+elevator\+\_\+group\+\_\+step (\begin{DoxyParamCaption}\item[{coap\+\_\+context\+\_\+t $\ast$}]{ctx,  }\item[{\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Simula un paso de movimiento para todos los ascensores del grupo. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Contexto Co\+AP para logging y operaciones \\
\hline
{\em group} & Grupo de ascensores a simular\\
\hline
\end{DoxyParams}
Esta función implementa la lógica de simulación de movimiento de ascensores. Se ejecuta periódicamente para actualizar el estado de todos los ascensores que tienen tareas asignadas.

Funcionalidades implementadas\+:
\begin{DoxyItemize}
\item {\bfseries{Cierre de puertas}}\+: Cierra puertas antes del movimiento
\item {\bfseries{Determinación de dirección}}\+: Calcula dirección basada en destino
\item {\bfseries{Simulación de movimiento}}\+: Mueve ascensores piso por piso
\item {\bfseries{Detección de llegada}}\+: Detecta cuando un ascensor llega a su destino
\item {\bfseries{Completado de tareas}}\+: Notifica llegadas y libera ascensores
\end{DoxyItemize}

La simulación maneja los siguientes estados\+:
\begin{DoxyItemize}
\item Ascensores ocupados con destino válido
\item Movimiento hacia arriba (MOVING\+\_\+\+UP)
\item Movimiento hacia abajo (MOVING\+\_\+\+DOWN)
\item Llegada a destino y liberación
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+status\+\_\+t}{p.}{structelevator__status__t} 
\end{DoxySeeAlso}


\doxysubsection{Variable Documentation}
\label{main_8c_abc8b9aeba00fbf6aeb7c811c034f383c} 
\index{main.c@{main.c}!g\_coap\_context@{g\_coap\_context}}
\index{g\_coap\_context@{g\_coap\_context}!main.c@{main.c}}
\doxysubsubsection{g\_coap\_context}
{\footnotesize\ttfamily coap\+\_\+context\+\_\+t$\ast$ g\+\_\+coap\+\_\+context = NULL}



Contexto Co\+AP global para la simulación y gestión de sesiones. 

Contexto Co\+AP global del API Gateway.

Contexto principal utilizado para todas las operaciones Co\+AP, incluyendo la simulación de ascensores y la gestión de sesiones DTLS. \label{main_8c_a003791cd6468260e13e2f2fd719e9fe4} 
\index{main.c@{main.c}!g\_coap\_context\_for\_session\_mgnt@{g\_coap\_context\_for\_session\_mgnt}}
\index{g\_coap\_context\_for\_session\_mgnt@{g\_coap\_context\_for\_session\_mgnt}!main.c@{main.c}}
\doxysubsubsection{g\_coap\_context\_for\_session\_mgnt}
{\footnotesize\ttfamily coap\+\_\+context\+\_\+t$\ast$ g\+\_\+coap\+\_\+context\+\_\+for\+\_\+session\+\_\+mgnt = NULL\hspace{0.3cm}{\ttfamily [static]}}



Contexto Co\+AP para la gestión de sesiones DTLS. 

Contexto específico utilizado para el manejo de eventos de sesiones DTLS con el servidor central. \label{main_8c_abe546e2cc7517fb0f6e0218ca1e3ff10} 
\index{main.c@{main.c}!g\_dtls\_session\_to\_central\_server@{g\_dtls\_session\_to\_central\_server}}
\index{g\_dtls\_session\_to\_central\_server@{g\_dtls\_session\_to\_central\_server}!main.c@{main.c}}
\doxysubsubsection{g\_dtls\_session\_to\_central\_server}
{\footnotesize\ttfamily coap\+\_\+session\+\_\+t$\ast$ g\+\_\+dtls\+\_\+session\+\_\+to\+\_\+central\+\_\+server = NULL}



Sesión DTLS global con el servidor central. 

Mantiene la conexión segura DTLS-\/\+PSK con el servidor central para el envío de solicitudes de asignación de ascensores. Se reutiliza para múltiples solicitudes para eficiencia. \label{main_8c_a2e69b946477ed035db425886fe261a13} 
\index{main.c@{main.c}!managed\_elevator\_group@{managed\_elevator\_group}}
\index{managed\_elevator\_group@{managed\_elevator\_group}!main.c@{main.c}}
\doxysubsubsection{managed\_elevator\_group}
{\footnotesize\ttfamily \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} managed\+\_\+elevator\+\_\+group}



Estado global del grupo de ascensores gestionado por este gateway. 

Grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 
\end{DoxySeeAlso}
\label{main_8c_a8a485bed3bbf69f7556aa3167043d7e2} 
\index{main.c@{main.c}!quit\_main\_loop@{quit\_main\_loop}}
\index{quit\_main\_loop@{quit\_main\_loop}!main.c@{main.c}}
\doxysubsubsection{quit\_main\_loop}
{\footnotesize\ttfamily volatile sig\+\_\+atomic\+\_\+t quit\+\_\+main\+\_\+loop = 0}



Bandera global para controlar el bucle principal de la aplicación. 

Bandera para indicar si el bucle principal debe terminar.

Esta bandera se establece a 1 por el manejador de señal SIGINT (handle\+\_\+sigint\+\_\+gw) para indicar que la aplicación debe terminar de manera elegante.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b} 
\end{DoxySeeAlso}

\subsection{main\_dynamic\_port}
\doxysection{src/main\+\_\+dynamic\+\_\+port.c File Reference}
\label{main__dynamic__port_8c}\index{src/main\_dynamic\_port.c@{src/main\_dynamic\_port.c}}


Versión del API Gateway que acepta puerto como parámetro.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static char $\ast$ \textbf{ generate\+\_\+unique\+\_\+identity} ()
\item 
static char $\ast$ \textbf{ generate\+\_\+unique\+\_\+psk\+\_\+key} ()
\item 
static void \textbf{ simulate\+\_\+elevator\+\_\+group\+\_\+step} (coap\+\_\+context\+\_\+t $\ast$ctx, \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$group)
\item 
void \textbf{ inicializar\+\_\+mi\+\_\+simulacion\+\_\+ascensor} (void)
\begin{DoxyCompactList}\small\item\em Inicializa el simulador de ascensores. \end{DoxyCompactList}\item 
void \textbf{ simular\+\_\+eventos\+\_\+ascensor} (void)
\begin{DoxyCompactList}\small\item\em Ejecuta una secuencia de eventos simulados de ascensor desde JSON. \end{DoxyCompactList}\item 
static int \textbf{ event\+\_\+handler\+\_\+gw} (coap\+\_\+session\+\_\+t $\ast$session, coap\+\_\+event\+\_\+t event)
\item 
coap\+\_\+session\+\_\+t $\ast$ \textbf{ get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session} (coap\+\_\+context\+\_\+t $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Obtiene o crea una sesión DTLS con el servidor central. \end{DoxyCompactList}\item 
int \textbf{ main} (int argc, char $\ast$argv[$\,$])
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
volatile sig\+\_\+atomic\+\_\+t \textbf{ quit\+\_\+main\+\_\+loop} = 0
\begin{DoxyCompactList}\small\item\em Bandera para indicar si el bucle principal debe terminar. \end{DoxyCompactList}\item 
\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} \textbf{ managed\+\_\+elevator\+\_\+group}
\begin{DoxyCompactList}\small\item\em Estado del grupo de ascensores gestionado por este gateway. \end{DoxyCompactList}\item 
coap\+\_\+context\+\_\+t $\ast$ \textbf{ g\+\_\+coap\+\_\+context} = NULL
\begin{DoxyCompactList}\small\item\em Contexto Co\+AP global del API Gateway. \end{DoxyCompactList}\item 
coap\+\_\+session\+\_\+t $\ast$ \textbf{ g\+\_\+dtls\+\_\+session\+\_\+to\+\_\+central\+\_\+server} = NULL
\begin{DoxyCompactList}\small\item\em Sesión DTLS global con el servidor central. \end{DoxyCompactList}\item 
static coap\+\_\+context\+\_\+t $\ast$ \textbf{ g\+\_\+coap\+\_\+context\+\_\+for\+\_\+session\+\_\+mgnt} = NULL
\item 
static int \textbf{ dynamic\+\_\+listen\+\_\+port} = 5683
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Versión del API Gateway que acepta puerto como parámetro. 

Esta versión permite ejecutar múltiples instancias del API Gateway cada una escuchando en un puerto diferente para pruebas de carga.

Uso\+: ./api\+\_\+gateway\+\_\+dynamic [puerto\+\_\+escucha] Si no se especifica puerto, usa 5683 por defecto. 

\doxysubsection{Function Documentation}
\label{main__dynamic__port_8c_a4d72c24b61707ff5f39a4123ca8cd833} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!event\_handler\_gw@{event\_handler\_gw}}
\index{event\_handler\_gw@{event\_handler\_gw}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{event\_handler\_gw()}
{\footnotesize\ttfamily static int event\+\_\+handler\+\_\+gw (\begin{DoxyParamCaption}\item[{coap\+\_\+session\+\_\+t $\ast$}]{session,  }\item[{coap\+\_\+event\+\_\+t}]{event }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\label{main__dynamic__port_8c_aaab19c59907fdd4643b33b5056420f9b} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!generate\_unique\_identity@{generate\_unique\_identity}}
\index{generate\_unique\_identity@{generate\_unique\_identity}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{generate\_unique\_identity()}
{\footnotesize\ttfamily static char $\ast$ generate\+\_\+unique\+\_\+identity (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\label{main__dynamic__port_8c_a7deba370f74d01d89ecd93cb376b1873} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!generate\_unique\_psk\_key@{generate\_unique\_psk\_key}}
\index{generate\_unique\_psk\_key@{generate\_unique\_psk\_key}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{generate\_unique\_psk\_key()}
{\footnotesize\ttfamily static char $\ast$ generate\+\_\+unique\+\_\+psk\+\_\+key (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\label{main__dynamic__port_8c_a7910799dc4997ea7ff42bb0339134d94} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!get\_or\_create\_central\_server\_dtls\_session@{get\_or\_create\_central\_server\_dtls\_session}}
\index{get\_or\_create\_central\_server\_dtls\_session@{get\_or\_create\_central\_server\_dtls\_session}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{get\_or\_create\_central\_server\_dtls\_session()}
{\footnotesize\ttfamily coap\+\_\+session\+\_\+t $\ast$ get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session (\begin{DoxyParamCaption}\item[{coap\+\_\+context\+\_\+t $\ast$}]{ctx }\end{DoxyParamCaption})}



Obtiene o crea una sesión DTLS con el servidor central. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Contexto Co\+AP a utilizar para la sesión \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero a la sesión DTLS establecida, o NULL en caso de error
\end{DoxyReturn}
Esta función implementa un patrón singleton para la gestión de sesiones DTLS con el servidor central. Reutiliza sesiones existentes cuando están activas y crea nuevas sesiones cuando es necesario.

Comportamiento\+:
\begin{DoxyEnumerate}
\item Si existe una sesión activa y establecida, la reutiliza
\item Si la sesión existe pero no está establecida, la libera y crea una nueva
\item Si no existe sesión, crea una nueva con configuración DTLS-\/\+PSK
\item Registra el manejador de eventos para gestión automática de la sesión
\end{DoxyEnumerate}

La función utiliza las siguientes configuraciones\+:
\begin{DoxyItemize}
\item IP del servidor\+: CENTRAL\+\_\+\+SERVER\+\_\+\+IP
\item Puerto del servidor\+: CENTRAL\+\_\+\+SERVER\+\_\+\+PORT ~\newline

\item Identidad PSK\+: IDENTITY\+\_\+\+TO\+\_\+\+PRESENT\+\_\+\+TO\+\_\+\+SERVER
\item Clave PSK\+: KEY\+\_\+\+FOR\+\_\+\+SERVER
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{event\+\_\+handler\+\_\+gw()}{p.}{main_8c_a4d72c24b61707ff5f39a4123ca8cd833} 

\doxyref{coap\+\_\+config.\+h}{p.}{coap__config_8h} 
\end{DoxySeeAlso}
\label{main__dynamic__port_8c_acfc4758bf8842f413c4d9e1c5ce6053d} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!inicializar\_mi\_simulacion\_ascensor@{inicializar\_mi\_simulacion\_ascensor}}
\index{inicializar\_mi\_simulacion\_ascensor@{inicializar\_mi\_simulacion\_ascensor}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{inicializar\_mi\_simulacion\_ascensor()}
{\footnotesize\ttfamily void inicializar\+\_\+mi\+\_\+simulacion\+\_\+ascensor (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Inicializa el simulador de ascensores. 

Esta función configura el simulador registrando el callback de respuesta CAN en el puente CAN-\/\+Co\+AP del API Gateway y cargando los datos de simulación desde el archivo JSON.

{\bfseries{Operaciones realizadas\+:}}
\begin{DoxyItemize}
\item Registro del callback de respuesta CAN
\item Carga de datos de simulación desde JSON
\item Inicialización de estructuras internas
\item Configuración de logging del simulador
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8c_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{cargar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 

\doxyref{mi\+\_\+simulador\+\_\+recibe\+\_\+can\+\_\+gw()}{p.}{mi__simulador__ascensor_8c_adfcf33ff0806b77c246bbd870b029566} 
\end{DoxySeeAlso}
\label{main__dynamic__port_8c_a0ddf1224851353fc92bfbff6f499fa97} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!main@{main}}
\index{main@{main}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv[$\,$] }\end{DoxyParamCaption})}

\label{main__dynamic__port_8c_a5c86f739de835826e9fa6dd607c52ec9} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!simular\_eventos\_ascensor@{simular\_eventos\_ascensor}}
\index{simular\_eventos\_ascensor@{simular\_eventos\_ascensor}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{simular\_eventos\_ascensor()}
{\footnotesize\ttfamily void simular\+\_\+eventos\+\_\+ascensor (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Ejecuta una secuencia de eventos simulados de ascensor desde JSON. 

Esta función reemplaza la simulación hardcodeada anterior. Ahora carga datos de simulación desde un archivo JSON, selecciona un edificio aleatorio y ejecuta todas sus peticiones secuencialmente.

{\bfseries{Proceso de simulación\+:}}
\begin{DoxyEnumerate}
\item Verifica si hay datos de simulación cargados
\item Selecciona un edificio aleatorio de los 100 disponibles
\item Configura el ID del edificio en el sistema
\item Ejecuta las 10 peticiones del edificio secuencialmente
\item Procesa I/O Co\+AP entre cada petición
\end{DoxyEnumerate}

{\bfseries{Fallback\+:}} Si no se pueden cargar los datos JSON, ejecuta la simulación básica de 2 peticiones hardcodeadas como antes.

{\bfseries{Características\+:}}
\begin{DoxyItemize}
\item Procesamiento de I/O Co\+AP entre eventos
\item Logging detallado de cada paso
\item Sincronización para evitar condiciones de carrera
\item Configuración automática del ID de edificio
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{cargar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 

\doxyref{seleccionar\+\_\+edificio\+\_\+aleatorio()}{p.}{group__simulation__functions_ga87620ad51d06f241a3106a36c40ac787} 

\doxyref{simular\+\_\+llamada\+\_\+de\+\_\+piso\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_ad2f8184c447385d5155da6a8d87e6c16} 

\doxyref{simular\+\_\+solicitud\+\_\+cabina\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_a75bd27a88662d9e2ac061e5285fc7ecb} 

coap\+\_\+io\+\_\+process() 
\end{DoxySeeAlso}
\label{main__dynamic__port_8c_af318206d98c90d1ed8b33a0f564ad219} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!simulate\_elevator\_group\_step@{simulate\_elevator\_group\_step}}
\index{simulate\_elevator\_group\_step@{simulate\_elevator\_group\_step}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{simulate\_elevator\_group\_step()}
{\footnotesize\ttfamily static void simulate\+\_\+elevator\+\_\+group\+\_\+step (\begin{DoxyParamCaption}\item[{coap\+\_\+context\+\_\+t $\ast$}]{ctx,  }\item[{\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} $\ast$}]{group }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



\doxysubsection{Variable Documentation}
\label{main__dynamic__port_8c_ab6cd46cca3fa91be58b4b7488c899731} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!dynamic\_listen\_port@{dynamic\_listen\_port}}
\index{dynamic\_listen\_port@{dynamic\_listen\_port}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{dynamic\_listen\_port}
{\footnotesize\ttfamily int dynamic\+\_\+listen\+\_\+port = 5683\hspace{0.3cm}{\ttfamily [static]}}

\label{main__dynamic__port_8c_abc8b9aeba00fbf6aeb7c811c034f383c} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!g\_coap\_context@{g\_coap\_context}}
\index{g\_coap\_context@{g\_coap\_context}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{g\_coap\_context}
{\footnotesize\ttfamily coap\+\_\+context\+\_\+t$\ast$ g\+\_\+coap\+\_\+context = NULL}



Contexto Co\+AP global del API Gateway. 

Referencia externa al contexto Co\+AP principal definido en \doxyref{main.\+c}{p.}{main_8c} del API Gateway. Utilizado para procesar eventos Co\+AP y enviar solicitudes al servidor central.

\begin{DoxySeeAlso}{See also}
api\+\_\+gateway/main.\+c
\end{DoxySeeAlso}
Contexto Co\+AP global del API Gateway.

Contexto principal utilizado para todas las operaciones Co\+AP, incluyendo la simulación de ascensores y la gestión de sesiones DTLS. \label{main__dynamic__port_8c_a003791cd6468260e13e2f2fd719e9fe4} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!g\_coap\_context\_for\_session\_mgnt@{g\_coap\_context\_for\_session\_mgnt}}
\index{g\_coap\_context\_for\_session\_mgnt@{g\_coap\_context\_for\_session\_mgnt}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{g\_coap\_context\_for\_session\_mgnt}
{\footnotesize\ttfamily coap\+\_\+context\+\_\+t$\ast$ g\+\_\+coap\+\_\+context\+\_\+for\+\_\+session\+\_\+mgnt = NULL\hspace{0.3cm}{\ttfamily [static]}}

\label{main__dynamic__port_8c_abe546e2cc7517fb0f6e0218ca1e3ff10} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!g\_dtls\_session\_to\_central\_server@{g\_dtls\_session\_to\_central\_server}}
\index{g\_dtls\_session\_to\_central\_server@{g\_dtls\_session\_to\_central\_server}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{g\_dtls\_session\_to\_central\_server}
{\footnotesize\ttfamily coap\+\_\+session\+\_\+t$\ast$ g\+\_\+dtls\+\_\+session\+\_\+to\+\_\+central\+\_\+server = NULL}



Sesión DTLS global con el servidor central. 

Declaración externa de la sesión DTLS definida en \doxyref{main.\+c}{p.}{main_8c}. Se utiliza para enviar solicitudes al servidor central de manera eficiente reutilizando la misma conexión segura.

\begin{DoxySeeAlso}{See also}
\doxyref{main.\+c}{p.}{main_8c} 

\doxyref{get\+\_\+or\+\_\+create\+\_\+central\+\_\+server\+\_\+dtls\+\_\+session()}{p.}{main_8c_a7910799dc4997ea7ff42bb0339134d94}
\end{DoxySeeAlso}
Mantiene la conexión segura DTLS-\/\+PSK con el servidor central para el envío de solicitudes de asignación de ascensores. Se reutiliza para múltiples solicitudes para eficiencia. \label{main__dynamic__port_8c_a2e69b946477ed035db425886fe261a13} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!managed\_elevator\_group@{managed\_elevator\_group}}
\index{managed\_elevator\_group@{managed\_elevator\_group}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{managed\_elevator\_group}
{\footnotesize\ttfamily \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} managed\+\_\+elevator\+\_\+group}



Estado del grupo de ascensores gestionado por este gateway. 

Estado global del grupo de ascensores gestionado por este gateway.

Grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado.

Declaración externa para acceder al estado del grupo de ascensores gestionado en \doxyref{main.\+c}{p.}{main_8c}. Contiene información completa de todos los ascensores del edificio.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{main.\+c}{p.}{main_8c}
\end{DoxySeeAlso}
Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 
\end{DoxySeeAlso}
\label{main__dynamic__port_8c_a8a485bed3bbf69f7556aa3167043d7e2} 
\index{main\_dynamic\_port.c@{main\_dynamic\_port.c}!quit\_main\_loop@{quit\_main\_loop}}
\index{quit\_main\_loop@{quit\_main\_loop}!main\_dynamic\_port.c@{main\_dynamic\_port.c}}
\doxysubsubsection{quit\_main\_loop}
{\footnotesize\ttfamily volatile sig\+\_\+atomic\+\_\+t quit\+\_\+main\+\_\+loop = 0}



Bandera para indicar si el bucle principal debe terminar. 

Bandera global para controlar el bucle principal de la aplicación.

Esta variable se declara como extern en api\+\_\+handlers.\+h y se define en \doxyref{main.\+c}{p.}{main_8c}. Es establecida por el manejador de señal (handle\+\_\+sigint\+\_\+gw) para detener el bucle principal de eventos.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b}
\end{DoxySeeAlso}
Bandera para indicar si el bucle principal debe terminar.

Esta bandera se establece a 1 por el manejador de señal SIGINT (handle\+\_\+sigint\+\_\+gw) para indicar que la aplicación debe terminar de manera elegante.

\begin{DoxySeeAlso}{See also}
\doxyref{handle\+\_\+sigint\+\_\+gw()}{p.}{api__handlers_8c_a7fd01dcda5b603f45f20d97c84d9260b} 
\end{DoxySeeAlso}

\subsection{mi\_simulador\_ascensor}
\doxysection{src/mi\+\_\+simulador\+\_\+ascensor.c File Reference}
\label{mi__simulador__ascensor_8c}\index{src/mi\_simulador\_ascensor.c@{src/mi\_simulador\_ascensor.c}}


Simulador de Ascensores para Testing del API Gateway.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ mi\+\_\+simulador\+\_\+recibe\+\_\+can\+\_\+gw} (\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$frame)
\begin{DoxyCompactList}\small\item\em Callback para recibir frames CAN de respuesta del gateway. \end{DoxyCompactList}\item 
void \textbf{ inicializar\+\_\+mi\+\_\+simulacion\+\_\+ascensor} (void)
\begin{DoxyCompactList}\small\item\em Inicializa el simulador de ascensores. \end{DoxyCompactList}\item 
void \textbf{ simular\+\_\+llamada\+\_\+de\+\_\+piso\+\_\+via\+\_\+can} (int piso\+\_\+origen, \textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t} direccion)
\begin{DoxyCompactList}\small\item\em Simula una llamada de piso vía CAN. \end{DoxyCompactList}\item 
void \textbf{ simular\+\_\+solicitud\+\_\+cabina\+\_\+via\+\_\+can} (int indice\+\_\+ascensor, int piso\+\_\+destino)
\begin{DoxyCompactList}\small\item\em Simula una solicitud de cabina vía CAN. \end{DoxyCompactList}\item 
void \textbf{ simular\+\_\+eventos\+\_\+ascensor} (void)
\begin{DoxyCompactList}\small\item\em Ejecuta una secuencia de eventos simulados de ascensor desde JSON. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
coap\+\_\+context\+\_\+t $\ast$ \textbf{ g\+\_\+coap\+\_\+context}
\begin{DoxyCompactList}\small\item\em Contexto Co\+AP global del API Gateway. \end{DoxyCompactList}\item 
\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} \textbf{ managed\+\_\+elevator\+\_\+group}
\begin{DoxyCompactList}\small\item\em Grupo de ascensores gestionado. \end{DoxyCompactList}\item 
static \textbf{ datos\+\_\+simulacion\+\_\+t} \textbf{ datos\+\_\+simulacion\+\_\+global}
\begin{DoxyCompactList}\small\item\em Datos de simulación cargados desde JSON. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Simulador de Ascensores para Testing del API Gateway. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
2.\+0
\end{DoxyVersion}
Este archivo implementa un simulador de ascensores que genera eventos CAN simulados para probar la funcionalidad del API Gateway. Sus funciones principales\+:


\begin{DoxyItemize}
\item {\bfseries{Simulación de eventos CAN}}\+: Generación de frames CAN simulados
\item {\bfseries{Callback de respuesta}}\+: Procesamiento de respuestas del gateway
\item {\bfseries{Integración con puente CAN}}\+: Interfaz con el sistema CAN-\/\+Co\+AP
\item {\bfseries{Testing automatizado}}\+: Secuencias de prueba predefinidas
\item {\bfseries{Carga desde JSON}}\+: Sistema de simulación basado en archivos de datos
\end{DoxyItemize}

{\bfseries{Tipos de eventos simulados\+:}}
\begin{DoxyItemize}
\item Llamadas de piso (floor calls) desde botones externos
\item Solicitudes de cabina (cabin requests) desde interior del ascensor
\item Notificaciones de llegada a destinos
\end{DoxyItemize}

El simulador utiliza el contexto Co\+AP global del API Gateway para procesar eventos y recibir respuestas del servidor central.

{\bfseries{Sistema de simulación JSON\+:}} Cada ejecución del API Gateway carga un archivo JSON con 100 edificios, selecciona uno aleatoriamente y ejecuta sus 10 peticiones secuencialmente.

\begin{DoxySeeAlso}{See also}
\doxyref{can\+\_\+bridge.\+h}{p.}{can__bridge_8h} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 

\doxyref{simulation\+\_\+loader.\+h}{p.}{simulation__loader_8h} 

\doxyref{api\+\_\+common\+\_\+defs.\+h}{p.}{api__common__defs_8h} 
\end{DoxySeeAlso}


\doxysubsection{Function Documentation}
\label{mi__simulador__ascensor_8c_acfc4758bf8842f413c4d9e1c5ce6053d} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!inicializar\_mi\_simulacion\_ascensor@{inicializar\_mi\_simulacion\_ascensor}}
\index{inicializar\_mi\_simulacion\_ascensor@{inicializar\_mi\_simulacion\_ascensor}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{inicializar\_mi\_simulacion\_ascensor()}
{\footnotesize\ttfamily void inicializar\+\_\+mi\+\_\+simulacion\+\_\+ascensor (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Inicializa el simulador de ascensores. 

Esta función configura el simulador registrando el callback de respuesta CAN en el puente CAN-\/\+Co\+AP del API Gateway y cargando los datos de simulación desde el archivo JSON.

{\bfseries{Operaciones realizadas\+:}}
\begin{DoxyItemize}
\item Registro del callback de respuesta CAN
\item Carga de datos de simulación desde JSON
\item Inicialización de estructuras internas
\item Configuración de logging del simulador
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8c_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{cargar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 

\doxyref{mi\+\_\+simulador\+\_\+recibe\+\_\+can\+\_\+gw()}{p.}{mi__simulador__ascensor_8c_adfcf33ff0806b77c246bbd870b029566} 
\end{DoxySeeAlso}
\label{mi__simulador__ascensor_8c_adfcf33ff0806b77c246bbd870b029566} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!mi\_simulador\_recibe\_can\_gw@{mi\_simulador\_recibe\_can\_gw}}
\index{mi\_simulador\_recibe\_can\_gw@{mi\_simulador\_recibe\_can\_gw}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{mi\_simulador\_recibe\_can\_gw()}
{\footnotesize\ttfamily void mi\+\_\+simulador\+\_\+recibe\+\_\+can\+\_\+gw (\begin{DoxyParamCaption}\item[{\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} $\ast$}]{frame }\end{DoxyParamCaption})}



Callback para recibir frames CAN de respuesta del gateway. 


\begin{DoxyParams}{Parameters}
{\em frame} & Puntero al frame CAN simulado recibido del gateway\\
\hline
\end{DoxyParams}
Esta función actúa como callback registrado en el puente CAN para recibir y procesar las respuestas del API Gateway. Interpreta diferentes tipos de frames CAN de respuesta\+:

{\bfseries{Tipos de frames procesados\+:}}
\begin{DoxyItemize}
\item 0x101\+: Respuesta a llamada de piso (0x100)
\item 0x201\+: Respuesta a solicitud de cabina (0x200)
\item 0x\+FE\+: Error genérico del gateway
\end{DoxyItemize}

{\bfseries{Información extraída\+:}}
\begin{DoxyItemize}
\item Índice del ascensor asignado
\item ID de tarea (parcial, limitado por tamaño CAN)
\item Códigos de error y diagnóstico
\end{DoxyItemize}

La función proporciona logging detallado para debugging y verificación del comportamiento del sistema.

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+register\+\_\+send\+\_\+callback()}{p.}{can__bridge_8c_a82b3383904e65573e79b59f4b7c5ef15} 

\doxyref{simulated\+\_\+can\+\_\+frame\+\_\+t}{p.}{structsimulated__can__frame__t} 
\end{DoxySeeAlso}
\label{mi__simulador__ascensor_8c_a5c86f739de835826e9fa6dd607c52ec9} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!simular\_eventos\_ascensor@{simular\_eventos\_ascensor}}
\index{simular\_eventos\_ascensor@{simular\_eventos\_ascensor}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{simular\_eventos\_ascensor()}
{\footnotesize\ttfamily void simular\+\_\+eventos\+\_\+ascensor (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Ejecuta una secuencia de eventos simulados de ascensor desde JSON. 

Esta función reemplaza la simulación hardcodeada anterior. Ahora carga datos de simulación desde un archivo JSON, selecciona un edificio aleatorio y ejecuta todas sus peticiones secuencialmente.

{\bfseries{Proceso de simulación\+:}}
\begin{DoxyEnumerate}
\item Verifica si hay datos de simulación cargados
\item Selecciona un edificio aleatorio de los 100 disponibles
\item Configura el ID del edificio en el sistema
\item Ejecuta las 10 peticiones del edificio secuencialmente
\item Procesa I/O Co\+AP entre cada petición
\end{DoxyEnumerate}

{\bfseries{Fallback\+:}} Si no se pueden cargar los datos JSON, ejecuta la simulación básica de 2 peticiones hardcodeadas como antes.

{\bfseries{Características\+:}}
\begin{DoxyItemize}
\item Procesamiento de I/O Co\+AP entre eventos
\item Logging detallado de cada paso
\item Sincronización para evitar condiciones de carrera
\item Configuración automática del ID de edificio
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{cargar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 

\doxyref{seleccionar\+\_\+edificio\+\_\+aleatorio()}{p.}{group__simulation__functions_ga87620ad51d06f241a3106a36c40ac787} 

\doxyref{simular\+\_\+llamada\+\_\+de\+\_\+piso\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_ad2f8184c447385d5155da6a8d87e6c16} 

\doxyref{simular\+\_\+solicitud\+\_\+cabina\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_a75bd27a88662d9e2ac061e5285fc7ecb} 

coap\+\_\+io\+\_\+process() 
\end{DoxySeeAlso}
\label{mi__simulador__ascensor_8c_ad2f8184c447385d5155da6a8d87e6c16} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!simular\_llamada\_de\_piso\_via\_can@{simular\_llamada\_de\_piso\_via\_can}}
\index{simular\_llamada\_de\_piso\_via\_can@{simular\_llamada\_de\_piso\_via\_can}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{simular\_llamada\_de\_piso\_via\_can()}
{\footnotesize\ttfamily void simular\+\_\+llamada\+\_\+de\+\_\+piso\+\_\+via\+\_\+can (\begin{DoxyParamCaption}\item[{int}]{piso\+\_\+origen,  }\item[{\textbf{ movement\+\_\+direction\+\_\+enum\+\_\+t}}]{direccion }\end{DoxyParamCaption})}



Simula una llamada de piso vía CAN. 


\begin{DoxyParams}{Parameters}
{\em piso\+\_\+origen} & Piso desde el cual se realiza la llamada \\
\hline
{\em direccion} & Dirección solicitada (MOVING\+\_\+\+UP o MOVING\+\_\+\+DOWN)\\
\hline
\end{DoxyParams}
Esta función genera un frame CAN simulado que representa una llamada de piso desde un botón externo. El frame se envía al puente CAN-\/\+Co\+AP del API Gateway para su procesamiento.

{\bfseries{Formato del frame CAN\+:}}
\begin{DoxyItemize}
\item ID\+: 0x100 (identificador para llamadas de piso)
\item data[0]\+: Piso origen (0-\/255)
\item data[1]\+: Dirección (0=UP, 1=DOWN)
\item DLC\+: 2 bytes
\end{DoxyItemize}

{\bfseries{Validaciones\+:}}
\begin{DoxyItemize}
\item Verifica disponibilidad del contexto Co\+AP
\item Valida parámetros de entrada
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame()}{p.}{can__bridge_8c_aacea58e11d63ec4a2601d1b225af2af7} 

\doxyref{movement\+\_\+direction\+\_\+enum\+\_\+t}{p.}{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01} 
\end{DoxySeeAlso}
\label{mi__simulador__ascensor_8c_a75bd27a88662d9e2ac061e5285fc7ecb} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!simular\_solicitud\_cabina\_via\_can@{simular\_solicitud\_cabina\_via\_can}}
\index{simular\_solicitud\_cabina\_via\_can@{simular\_solicitud\_cabina\_via\_can}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{simular\_solicitud\_cabina\_via\_can()}
{\footnotesize\ttfamily void simular\+\_\+solicitud\+\_\+cabina\+\_\+via\+\_\+can (\begin{DoxyParamCaption}\item[{int}]{indice\+\_\+ascensor,  }\item[{int}]{piso\+\_\+destino }\end{DoxyParamCaption})}



Simula una solicitud de cabina vía CAN. 


\begin{DoxyParams}{Parameters}
{\em indice\+\_\+ascensor} & Índice del ascensor que realiza la solicitud (0-\/based) \\
\hline
{\em piso\+\_\+destino} & Piso destino solicitado\\
\hline
\end{DoxyParams}
Esta función genera un frame CAN simulado que representa una solicitud de cabina desde el interior de un ascensor. El frame se envía al puente CAN-\/\+Co\+AP del API Gateway para su procesamiento.

{\bfseries{Formato del frame CAN\+:}}
\begin{DoxyItemize}
\item ID\+: 0x200 (identificador para solicitudes de cabina)
\item data[0]\+: Índice del ascensor (0-\/based, ej\+: 0 para E1\+A1)
\item data[1]\+: Piso destino (0-\/255)
\item DLC\+: 2 bytes
\end{DoxyItemize}

{\bfseries{Validaciones\+:}}
\begin{DoxyItemize}
\item Verifica disponibilidad del contexto Co\+AP
\item Valida parámetros de entrada
\end{DoxyItemize}

\begin{DoxyNote}{Note}
El índice del ascensor se mapea a IDs como E1\+A1, E1\+A2, etc.
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\doxyref{ag\+\_\+can\+\_\+bridge\+\_\+process\+\_\+incoming\+\_\+frame()}{p.}{can__bridge_8c_aacea58e11d63ec4a2601d1b225af2af7} 

\doxyref{simulated\+\_\+can\+\_\+frame\+\_\+t}{p.}{structsimulated__can__frame__t} 
\end{DoxySeeAlso}


\doxysubsection{Variable Documentation}
\label{mi__simulador__ascensor_8c_a2df9aa33421dd0ff2059a47a9c0f7877} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!datos\_simulacion\_global@{datos\_simulacion\_global}}
\index{datos\_simulacion\_global@{datos\_simulacion\_global}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{datos\_simulacion\_global}
{\footnotesize\ttfamily \textbf{ datos\+\_\+simulacion\+\_\+t} datos\+\_\+simulacion\+\_\+global\hspace{0.3cm}{\ttfamily [static]}}



Datos de simulación cargados desde JSON. 

Variable global que almacena todos los edificios y peticiones cargados desde el archivo de simulación JSON. \label{mi__simulador__ascensor_8c_abc8b9aeba00fbf6aeb7c811c034f383c} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!g\_coap\_context@{g\_coap\_context}}
\index{g\_coap\_context@{g\_coap\_context}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{g\_coap\_context}
{\footnotesize\ttfamily coap\+\_\+context\+\_\+t$\ast$ g\+\_\+coap\+\_\+context\hspace{0.3cm}{\ttfamily [extern]}}



Contexto Co\+AP global del API Gateway. 

Referencia externa al contexto Co\+AP principal definido en \doxyref{main.\+c}{p.}{main_8c} del API Gateway. Utilizado para procesar eventos Co\+AP y enviar solicitudes al servidor central.

\begin{DoxySeeAlso}{See also}
api\+\_\+gateway/main.\+c
\end{DoxySeeAlso}
Contexto Co\+AP global del API Gateway.

Contexto principal utilizado para todas las operaciones Co\+AP, incluyendo la simulación de ascensores y la gestión de sesiones DTLS. \label{mi__simulador__ascensor_8c_a2e69b946477ed035db425886fe261a13} 
\index{mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}!managed\_elevator\_group@{managed\_elevator\_group}}
\index{managed\_elevator\_group@{managed\_elevator\_group}!mi\_simulador\_ascensor.c@{mi\_simulador\_ascensor.c}}
\doxysubsubsection{managed\_elevator\_group}
{\footnotesize\ttfamily \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} managed\+\_\+elevator\+\_\+group\hspace{0.3cm}{\ttfamily [extern]}}



Grupo de ascensores gestionado. 

Referencia externa al grupo de ascensores principal definido en \doxyref{main.\+c}{p.}{main_8c}. Se utiliza para configurar el ID del edificio durante la simulación.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t}
\end{DoxySeeAlso}
Grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h}
\end{DoxySeeAlso}
Grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado.

Declaración externa para acceder al estado del grupo de ascensores gestionado en \doxyref{main.\+c}{p.}{main_8c}. Contiene información completa de todos los ascensores del edificio.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{main.\+c}{p.}{main_8c}
\end{DoxySeeAlso}
Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 
\end{DoxySeeAlso}

\subsection{psk\_manager}
\doxysection{src/psk\+\_\+manager.c File Reference}
\label{psk__manager_8c}\index{src/psk\_manager.c@{src/psk\_manager.c}}


Implementación del gestor de claves PSK.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ psk\+\_\+keys\+\_\+t}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ psk\+\_\+manager\+\_\+init} (const char $\ast$keys\+\_\+file\+\_\+path)
\begin{DoxyCompactList}\small\item\em Inicializa el gestor de claves PSK. \end{DoxyCompactList}\item 
int \textbf{ psk\+\_\+manager\+\_\+get\+\_\+random\+\_\+key} (char $\ast$key\+\_\+buffer, size\+\_\+t buffer\+\_\+size)
\begin{DoxyCompactList}\small\item\em Obtiene una clave PSK aleatoria del archivo. \end{DoxyCompactList}\item 
int \textbf{ psk\+\_\+manager\+\_\+get\+\_\+first\+\_\+key} (char $\ast$key\+\_\+buffer, size\+\_\+t buffer\+\_\+size)
\begin{DoxyCompactList}\small\item\em Obtiene la primera clave PSK del archivo como fallback. \end{DoxyCompactList}\item 
int \textbf{ psk\+\_\+manager\+\_\+get\+\_\+deterministic\+\_\+key} (const char $\ast$identity, char $\ast$key\+\_\+buffer, size\+\_\+t buffer\+\_\+size)
\begin{DoxyCompactList}\small\item\em Obtiene una clave PSK determinística basada en la identidad. \end{DoxyCompactList}\item 
void \textbf{ psk\+\_\+manager\+\_\+cleanup} (void)
\begin{DoxyCompactList}\small\item\em Libera los recursos del gestor de claves PSK. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \textbf{ psk\+\_\+keys\+\_\+t} \textbf{ g\+\_\+psk\+\_\+keys} = \{NULL, 0, 0\}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementación del gestor de claves PSK. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}


\doxysubsection{Function Documentation}
\label{psk__manager_8c_ad35ff5f3bbc4390b787ccd3cc84789fd} 
\index{psk\_manager.c@{psk\_manager.c}!psk\_manager\_cleanup@{psk\_manager\_cleanup}}
\index{psk\_manager\_cleanup@{psk\_manager\_cleanup}!psk\_manager.c@{psk\_manager.c}}
\doxysubsubsection{psk\_manager\_cleanup()}
{\footnotesize\ttfamily void psk\+\_\+manager\+\_\+cleanup (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Libera los recursos del gestor de claves PSK. 

\label{psk__manager_8c_ae935da22c745fa1661bb66f846e67caf} 
\index{psk\_manager.c@{psk\_manager.c}!psk\_manager\_get\_deterministic\_key@{psk\_manager\_get\_deterministic\_key}}
\index{psk\_manager\_get\_deterministic\_key@{psk\_manager\_get\_deterministic\_key}!psk\_manager.c@{psk\_manager.c}}
\doxysubsubsection{psk\_manager\_get\_deterministic\_key()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+get\+\_\+deterministic\+\_\+key (\begin{DoxyParamCaption}\item[{const char $\ast$}]{identity,  }\item[{char $\ast$}]{key\+\_\+buffer,  }\item[{size\+\_\+t}]{buffer\+\_\+size }\end{DoxyParamCaption})}



Obtiene una clave PSK determinística basada en la identidad. 


\begin{DoxyParams}{Parameters}
{\em identity} & Identidad del cliente \\
\hline
{\em key\+\_\+buffer} & Buffer donde se almacenará la clave \\
\hline
{\em buffer\+\_\+size} & Tamaño del buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se obtuvo correctamente, -\/1 en caso de error 
\end{DoxyReturn}
\label{psk__manager_8c_ae0d0cd73b05236bb4bfbbf26420ddcb1} 
\index{psk\_manager.c@{psk\_manager.c}!psk\_manager\_get\_first\_key@{psk\_manager\_get\_first\_key}}
\index{psk\_manager\_get\_first\_key@{psk\_manager\_get\_first\_key}!psk\_manager.c@{psk\_manager.c}}
\doxysubsubsection{psk\_manager\_get\_first\_key()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+get\+\_\+first\+\_\+key (\begin{DoxyParamCaption}\item[{char $\ast$}]{key\+\_\+buffer,  }\item[{size\+\_\+t}]{buffer\+\_\+size }\end{DoxyParamCaption})}



Obtiene la primera clave PSK del archivo como fallback. 


\begin{DoxyParams}{Parameters}
{\em key\+\_\+buffer} & Buffer donde se almacenará la clave \\
\hline
{\em buffer\+\_\+size} & Tamaño del buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se obtuvo correctamente, -\/1 en caso de error 
\end{DoxyReturn}
\label{psk__manager_8c_a5663ed8700e380919e18e9d9ae752621} 
\index{psk\_manager.c@{psk\_manager.c}!psk\_manager\_get\_random\_key@{psk\_manager\_get\_random\_key}}
\index{psk\_manager\_get\_random\_key@{psk\_manager\_get\_random\_key}!psk\_manager.c@{psk\_manager.c}}
\doxysubsubsection{psk\_manager\_get\_random\_key()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+get\+\_\+random\+\_\+key (\begin{DoxyParamCaption}\item[{char $\ast$}]{key\+\_\+buffer,  }\item[{size\+\_\+t}]{buffer\+\_\+size }\end{DoxyParamCaption})}



Obtiene una clave PSK aleatoria del archivo. 


\begin{DoxyParams}{Parameters}
{\em key\+\_\+buffer} & Buffer donde se almacenará la clave \\
\hline
{\em buffer\+\_\+size} & Tamaño del buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se obtuvo correctamente, -\/1 en caso de error 
\end{DoxyReturn}
\label{psk__manager_8c_a47c0404c2287b0964a03a03f5843dd7e} 
\index{psk\_manager.c@{psk\_manager.c}!psk\_manager\_init@{psk\_manager\_init}}
\index{psk\_manager\_init@{psk\_manager\_init}!psk\_manager.c@{psk\_manager.c}}
\doxysubsubsection{psk\_manager\_init()}
{\footnotesize\ttfamily int psk\+\_\+manager\+\_\+init (\begin{DoxyParamCaption}\item[{const char $\ast$}]{keys\+\_\+file\+\_\+path }\end{DoxyParamCaption})}



Inicializa el gestor de claves PSK. 


\begin{DoxyParams}{Parameters}
{\em keys\+\_\+file\+\_\+path} & Ruta al archivo de claves PSK \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 si se inicializó correctamente, -\/1 en caso de error 
\end{DoxyReturn}


\doxysubsection{Variable Documentation}
\label{psk__manager_8c_a2ee28b152051feb93d10e07417e41f1e} 
\index{psk\_manager.c@{psk\_manager.c}!g\_psk\_keys@{g\_psk\_keys}}
\index{g\_psk\_keys@{g\_psk\_keys}!psk\_manager.c@{psk\_manager.c}}
\doxysubsubsection{g\_psk\_keys}
{\footnotesize\ttfamily \textbf{ psk\+\_\+keys\+\_\+t} g\+\_\+psk\+\_\+keys = \{NULL, 0, 0\}\hspace{0.3cm}{\ttfamily [static]}}


\subsection{simulation\_loader}
\doxysection{src/simulation\+\_\+loader.c File Reference}
\label{simulation__loader_8c}\index{src/simulation\_loader.c@{src/simulation\_loader.c}}


Implementación del Sistema de Carga y Ejecución de Simulaciones.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \textbf{ cargar\+\_\+datos\+\_\+simulacion} (const char $\ast$archivo\+\_\+json, \textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Carga los datos de simulación desde un archivo JSON. \end{DoxyCompactList}\item 
void \textbf{ liberar\+\_\+datos\+\_\+simulacion} (\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Libera la memoria utilizada por los datos de simulación. \end{DoxyCompactList}\item 
\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$ \textbf{ seleccionar\+\_\+edificio\+\_\+aleatorio} (\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Selecciona un edificio aleatorio de los datos cargados. \end{DoxyCompactList}\item 
int \textbf{ convertir\+\_\+direccion\+\_\+string} (const char $\ast$direccion\+\_\+str)
\begin{DoxyCompactList}\small\item\em Convierte una cadena de dirección a enum. \end{DoxyCompactList}\item 
int \textbf{ ejecutar\+\_\+peticiones\+\_\+edificio} (\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$edificio, coap\+\_\+context\+\_\+t $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Ejecuta todas las peticiones de un edificio. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} \textbf{ managed\+\_\+elevator\+\_\+group}
\begin{DoxyCompactList}\small\item\em Estado global del grupo de ascensores gestionado por este gateway. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementación del Sistema de Carga y Ejecución de Simulaciones. 

\begin{DoxyAuthor}{Author}
Sistema de Control de Ascensores 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2025 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}


\doxysubsection{Variable Documentation}
\label{simulation__loader_8c_a2e69b946477ed035db425886fe261a13} 
\index{simulation\_loader.c@{simulation\_loader.c}!managed\_elevator\_group@{managed\_elevator\_group}}
\index{managed\_elevator\_group@{managed\_elevator\_group}!simulation\_loader.c@{simulation\_loader.c}}
\doxysubsubsection{managed\_elevator\_group}
{\footnotesize\ttfamily \textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} managed\+\_\+elevator\+\_\+group\hspace{0.3cm}{\ttfamily [extern]}}



Estado global del grupo de ascensores gestionado por este gateway. 

Grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h}
\end{DoxySeeAlso}
Estado global del grupo de ascensores gestionado por este gateway.

Grupo de ascensores gestionado.

Estado del grupo de ascensores gestionado.

Declaración externa para acceder al estado del grupo de ascensores gestionado en \doxyref{main.\+c}{p.}{main_8c}. Contiene información completa de todos los ascensores del edificio.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{main.\+c}{p.}{main_8c}
\end{DoxySeeAlso}
Estado del grupo de ascensores gestionado por este gateway.

Contiene el estado completo de todos los ascensores del edificio gestionado por este API Gateway, incluyendo posiciones actuales, tareas asignadas, estados de puertas y disponibilidad.

\begin{DoxySeeAlso}{See also}
\doxyref{elevator\+\_\+group\+\_\+state\+\_\+t}{p.}{structelevator__group__state__t} 

\doxyref{elevator\+\_\+state\+\_\+manager.\+h}{p.}{elevator__state__manager_8h} 
\end{DoxySeeAlso}

\subsection{annotated}
\doxysection{Data Structures}
Here are the data structures with brief descriptions\+:\begin{DoxyCompactList}
\item\contentsline{section}{\textbf{ api\+\_\+request\+\_\+details\+\_\+for\+\_\+json\+\_\+t} \\*Detalles específicos de solicitud para serialización JSON }{\pageref{structapi__request__details__for__json__t}}{}
\item\contentsline{section}{\textbf{ api\+\_\+request\+\_\+tracker\+\_\+t} \\*Tracks information from an original client (elevator) request OR a gateway-\/originated request }{\pageref{structapi__request__tracker__t}}{}
\item\contentsline{section}{\textbf{ can\+\_\+origin\+\_\+tracker\+\_\+t} \\*Tracker para correlacionar solicitudes CAN con respuestas Co\+AP }{\pageref{structcan__origin__tracker__t}}{}
\item\contentsline{section}{\textbf{ central\+\_\+request\+\_\+entry\+\_\+t} \\*Entrada de tracker para solicitudes al servidor central }{\pageref{structcentral__request__entry__t}}{}
\item\contentsline{section}{\textbf{ datos\+\_\+simulacion\+\_\+t} \\*Estructura principal de datos de simulación }{\pageref{structdatos__simulacion__t}}{}
\item\contentsline{section}{\textbf{ edificio\+\_\+simulacion\+\_\+t} \\*Estructura para un edificio de simulación }{\pageref{structedificio__simulacion__t}}{}
\item\contentsline{section}{\textbf{ elevator\+\_\+group\+\_\+state\+\_\+t} \\*Estado del grupo de ascensores gestionado por el gateway }{\pageref{structelevator__group__state__t}}{}
\item\contentsline{section}{\textbf{ elevator\+\_\+status\+\_\+t} \\*Estado de un ascensor individual }{\pageref{structelevator__status__t}}{}
\item\contentsline{section}{\textbf{ execution\+\_\+stats\+\_\+t} \\*Estadísticas de ejecución }{\pageref{structexecution__stats__t}}{}
\item\contentsline{section}{\textbf{ log\+\_\+event\+\_\+t} \\*Estructura de un evento de log }{\pageref{structlog__event__t}}{}
\item\contentsline{section}{\textbf{ peticion\+\_\+simulacion\+\_\+t} \\*Estructura para una petición individual }{\pageref{structpeticion__simulacion__t}}{}
\item\contentsline{section}{\textbf{ psk\+\_\+keys\+\_\+t} }{\pageref{structpsk__keys__t}}{}
\item\contentsline{section}{\textbf{ simulated\+\_\+can\+\_\+frame\+\_\+t} \\*Estructura para un frame CAN simulado }{\pageref{structsimulated__can__frame__t}}{}
\end{DoxyCompactList}

\subsection{api\_\_common\_\_defs\_8h\_source}
\doxysection{api\+\_\+common\+\_\+defs.\+h}
\label{api__common__defs_8h_source}\index{include/api\_gateway/api\_common\_defs.h@{include/api\_gateway/api\_common\_defs.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ API\_COMMON\_DEFS\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ API\_COMMON\_DEFS\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}api\_gateway/logging\_gw.h"{}}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Common\ ID\ and\ String\ Lengths}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ ID\_STRING\_MAX\_LEN\ 25}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ TASK\_ID\_MAX\_LEN\ 32}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ STATUS\_STRING\_MAX\_LEN\ 16}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{comment}{//\ ANSI\ Color\ Codes\ y\ Logging\ Macros\ ahora\ están\ en\ logging\_gw.h}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ API\_COMMON\_DEFS\_H\ }}

\end{DoxyCode}

\subsection{can\_\_bridge\_8h\_source}
\doxysection{can\+\_\+bridge.\+h}
\label{can__bridge_8h_source}\index{include/api\_gateway/can\_bridge.h@{include/api\_gateway/can\_bridge.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#ifndef\ CAN\_BRIDGE\_H}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ CAN\_BRIDGE\_H}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ <stdbool.h>}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ <coap3/coap.h>}\ \textcolor{comment}{//\ Para\ coap\_bin\_const\_t\ y\ otros\ tipos\ CoAP}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ <cjson/cJSON.h>}\ \ \textcolor{comment}{//\ Para\ cJSON\ tipo}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}api\_gateway/elevator\_state\_manager.h"{}}\ \textcolor{comment}{//\ Para\ gw\_request\_type\_t}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}api\_gateway/api\_common\_defs.h"{}}\ \ \ \ \textcolor{comment}{//\ Para\ ID\_STRING\_MAX\_LEN}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00048\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00049\ \ \ \ \ uint32\_t\ id;\ \ \ \ \ \ }
\DoxyCodeLine{00050\ \ \ \ \ uint8\_t\ data[8];\ }
\DoxyCodeLine{00051\ \ \ \ \ uint8\_t\ dlc;\ \ \ \ \ }
\DoxyCodeLine{00052\ \}\ simulated\_can\_frame\_t;}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00062\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00063\ \ \ \ \ coap\_binary\_t\ coap\_token;\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00064\ \ \ \ \ uint32\_t\ original\_can\_id;\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00065\ \ \ \ \ gw\_request\_type\_t\ request\_type;\ \ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{int}\ target\_floor\_for\_task;\ \ \ \ \ \ \ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordtype}{int}\ call\_reference\_floor;\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{char}\ requesting\_elevator\_id\_if\_cabin[ID\_STRING\_MAX\_LEN];\ }
\DoxyCodeLine{00069\ \}\ can\_origin\_tracker\_t;}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00088\ \textcolor{keyword}{typedef}\ void\ (*can\_send\_callback\_t)(simulated\_can\_frame\_t*\ frame);}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00108\ \textcolor{keywordtype}{void}\ ag\_can\_bridge\_init(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00131\ \textcolor{keywordtype}{void}\ ag\_can\_bridge\_register\_send\_callback(can\_send\_callback\_t\ callback);}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00167\ \textcolor{keywordtype}{void}\ ag\_can\_bridge\_process\_incoming\_frame(simulated\_can\_frame\_t*\ frame,\ \textcolor{keyword}{struct}\ coap\_context\_t\ *coap\_context);}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00194\ can\_origin\_tracker\_t*\ find\_can\_tracker(coap\_bin\_const\_t\ token);}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00229\ \textcolor{keywordtype}{void}\ ag\_can\_bridge\_send\_response\_frame(uint32\_t\ original\_can\_id,\ coap\_pdu\_code\_t\ response\_code,\ cJSON*\ server\_response\_json);}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ CAN\_BRIDGE\_H\ }}

\end{DoxyCode}

\subsection{coap\_\_config\_8h\_source}
\doxysection{coap\+\_\+config.\+h}
\label{coap__config_8h_source}\index{include/api\_gateway/coap\_config.h@{include/api\_gateway/coap\_config.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#ifndef\ COAP\_CONFIG\_H}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ COAP\_CONFIG\_H}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#define\ GW\_LISTEN\_IP\ "{}0.0.0.0"{}}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#define\ GW\_LISTEN\_PORT\ "{}5683"{}}}
\DoxyCodeLine{00053\ }
 \textcolor{comment}{// end of gateway\_listen group}\DoxyCodeLine{00055\ }
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#define\ CENTRAL\_SERVER\_IP\ "{}192.168.49.2"{}}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#define\ CENTRAL\_SERVER\_PORT\ "{}5684"{}}}
\DoxyCodeLine{00082\ }
 \textcolor{comment}{// end of central\_server group}\DoxyCodeLine{00084\ }
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#define\ FLOOR\_CALL\_RESOURCE\ "{}peticion\_piso"{}}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#define\ CABIN\_REQUEST\_RESOURCE\ "{}peticion\_cabina"{}}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#define\ CENTRAL\_SERVER\_FLOOR\_CALL\_PATH\ "{}/"{}\ FLOOR\_CALL\_RESOURCE}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#define\ CENTRAL\_SERVER\_CABIN\_REQUEST\_PATH\ "{}/"{}\ CABIN\_REQUEST\_RESOURCE}}
\DoxyCodeLine{00144\ }
 \textcolor{comment}{// end of coap\_resources group}\DoxyCodeLine{00146\ }
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\#define\ COAP\_REQUEST\_TIMEOUT\_MS\ 5000}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00171\ \textcolor{preprocessor}{\#define\ COAP\_MAX\_RETRIES\ 3}}
\DoxyCodeLine{00172\ }
 \textcolor{comment}{// end of coap\_timeouts group}\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ COAP\_CONFIG\_H\ }}

\end{DoxyCode}

\subsection{dir\_68267d1309a1af8e8297ef4c3efbcdba}
\doxysection{src Directory Reference}
\label{dir_68267d1309a1af8e8297ef4c3efbcdba}\index{src Directory Reference@{src Directory Reference}}
\doxysubsubsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \textbf{ api\+\_\+handlers.\+c}
\begin{DoxyCompactList}\small\item\em Implementación de manejadores Co\+AP para el API Gateway. \end{DoxyCompactList}\item 
file \textbf{ api\+\_\+handlers.\+h}
\begin{DoxyCompactList}\small\item\em Declares Co\+AP handler functions and related data structures for the API Gateway. \end{DoxyCompactList}\item 
file \textbf{ can\+\_\+bridge.\+c}
\begin{DoxyCompactList}\small\item\em Implementación del Puente CAN-\/\+Co\+AP para el API Gateway. \end{DoxyCompactList}\item 
file \textbf{ elevator\+\_\+state\+\_\+manager.\+c}
\begin{DoxyCompactList}\small\item\em Implementación del Gestor de Estado de Ascensores del API Gateway. \end{DoxyCompactList}\item 
file \textbf{ execution\+\_\+logger.\+c}
\begin{DoxyCompactList}\small\item\em Implementación del Sistema de Logging de Ejecuciones. \end{DoxyCompactList}\item 
file \textbf{ main.\+c}
\begin{DoxyCompactList}\small\item\em Punto de entrada principal del API Gateway del Sistema de Control de Ascensores. \end{DoxyCompactList}\item 
file \textbf{ main\+\_\+dynamic\+\_\+port.\+c}
\begin{DoxyCompactList}\small\item\em Versión del API Gateway que acepta puerto como parámetro. \end{DoxyCompactList}\item 
file \textbf{ mi\+\_\+simulador\+\_\+ascensor.\+c}
\begin{DoxyCompactList}\small\item\em Simulador de Ascensores para Testing del API Gateway. \end{DoxyCompactList}\item 
file \textbf{ psk\+\_\+manager.\+c}
\begin{DoxyCompactList}\small\item\em Implementación del gestor de claves PSK. \end{DoxyCompactList}\item 
file \textbf{ psk\+\_\+manager.\+h}
\begin{DoxyCompactList}\small\item\em Gestor de claves PSK para API Gateway. \end{DoxyCompactList}\item 
file \textbf{ simulation\+\_\+loader.\+c}
\begin{DoxyCompactList}\small\item\em Implementación del Sistema de Carga y Ejecución de Simulaciones. \end{DoxyCompactList}\end{DoxyCompactItemize}

\subsection{dir\_a71814f687eac4a66afe8ed2754aae92}
\doxysection{include/api\+\_\+gateway Directory Reference}
\label{dir_a71814f687eac4a66afe8ed2754aae92}\index{include/api\_gateway Directory Reference@{include/api\_gateway Directory Reference}}
\doxysubsubsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \textbf{ api\+\_\+common\+\_\+defs.\+h}
\item 
file \textbf{ api\+\_\+handlers.\+h}
\item 
file \textbf{ can\+\_\+bridge.\+h}
\begin{DoxyCompactList}\small\item\em Puente CAN-\/\+Co\+AP para el API Gateway. \end{DoxyCompactList}\item 
file \textbf{ coap\+\_\+config.\+h}
\begin{DoxyCompactList}\small\item\em Configuraciones Co\+AP para el API Gateway. \end{DoxyCompactList}\item 
file \textbf{ elevator\+\_\+state\+\_\+manager.\+h}
\begin{DoxyCompactList}\small\item\em Gestor de Estado de Ascensores para el API Gateway. \end{DoxyCompactList}\item 
file \textbf{ execution\+\_\+logger.\+h}
\begin{DoxyCompactList}\small\item\em Sistema de Logging de Ejecuciones para Resultados de TFG. \end{DoxyCompactList}\item 
file \textbf{ logging\+\_\+gw.\+h}
\begin{DoxyCompactList}\small\item\em Sistema de Logging para el API Gateway. \end{DoxyCompactList}\item 
file \textbf{ simulation\+\_\+loader.\+h}
\begin{DoxyCompactList}\small\item\em Sistema de Carga y Ejecución de Simulaciones de Ascensores. \end{DoxyCompactList}\end{DoxyCompactItemize}

\subsection{dir\_d44c64559bbebec7f509842c48db8b23}
\doxysection{include Directory Reference}
\label{dir_d44c64559bbebec7f509842c48db8b23}\index{include Directory Reference@{include Directory Reference}}
\doxysubsubsection*{Directories}
\begin{DoxyCompactItemize}
\item 
directory \textbf{ api\+\_\+gateway}
\end{DoxyCompactItemize}

\subsection{elevator\_\_state\_\_manager\_8h\_source}
\doxysection{elevator\+\_\+state\+\_\+manager.\+h}
\label{elevator__state__manager_8h_source}\index{include/api\_gateway/elevator\_state\_manager.h@{include/api\_gateway/elevator\_state\_manager.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#ifndef\ ELEVATOR\_STATE\_MANAGER\_H}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ ELEVATOR\_STATE\_MANAGER\_H}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ <cJSON.h>}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ <stdbool.h>}\ \textcolor{comment}{//\ Para\ bool}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#define\ MAX\_ELEVATORS\_PER\_GATEWAY\ 6}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#define\ ID\_STRING\_MAX\_LEN\ 25}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#define\ TASK\_ID\_MAX\_LEN\ 32}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#define\ STATUS\_STRING\_MAX\_LEN\ 16}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00072\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00073\ \ \ \ \ DOOR\_CLOSED,\ \ \ \ }
\DoxyCodeLine{00074\ \ \ \ \ DOOR\_OPEN,\ \ \ \ \ \ }
\DoxyCodeLine{00075\ \ \ \ \ DOOR\_OPENING,\ \ \ }
\DoxyCodeLine{00076\ \ \ \ \ DOOR\_CLOSING,\ \ \ }
\DoxyCodeLine{00077\ \ \ \ \ DOOR\_UNKNOWN\ \ \ \ }
\DoxyCodeLine{00078\ \}\ door\_state\_enum\_t;}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00086\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00087\ \ \ \ \ MOVING\_UP,\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00088\ \ \ \ \ MOVING\_DOWN,\ \ \ \ \ \ }
\DoxyCodeLine{00089\ \ \ \ \ STOPPED,\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00090\ \ \ \ \ DIRECTION\_UNKNOWN\ }
\DoxyCodeLine{00091\ \}\ movement\_direction\_enum\_t;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00100\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00101\ \ \ \ \ GW\_REQUEST\_TYPE\_UNKNOWN\ =\ 0,\ \ \ \ }
\DoxyCodeLine{00102\ \ \ \ \ GW\_REQUEST\_TYPE\_FLOOR\_CALL,\ \ \ \ \ }
\DoxyCodeLine{00103\ \ \ \ \ GW\_REQUEST\_TYPE\_CABIN\_REQUEST\ \ \ }
\DoxyCodeLine{00104\ \}\ gw\_request\_type\_t;}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00112\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{char}\ ascensor\_id[ID\_STRING\_MAX\_LEN];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordtype}{char}\ id\_edificio\_str[ID\_STRING\_MAX\_LEN];\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordtype}{int}\ piso\_actual;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00116\ \ \ \ \ door\_state\_enum\_t\ estado\_puerta\_enum;\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{char}\ tarea\_actual\_id[TASK\_ID\_MAX\_LEN];\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordtype}{int}\ destino\_actual;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00119\ \ \ \ \ movement\_direction\_enum\_t\ direccion\_movimiento\_enum;\ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keywordtype}{bool}\ ocupado;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00121\ \}\ elevator\_status\_t;}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00129\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00130\ \ \ \ \ elevator\_status\_t\ ascensores[MAX\_ELEVATORS\_PER\_GATEWAY];\ }
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_elevadores\_en\_grupo;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordtype}{char}\ edificio\_id\_str\_grupo[ID\_STRING\_MAX\_LEN];\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00133\ \}\ elevator\_group\_state\_t;}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00141\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ Para\ Floor\ Call\ (GW\_REQUEST\_TYPE\_FLOOR\_CALL)}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keywordtype}{int}\ origin\_floor\_fc;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00144\ \ \ \ \ movement\_direction\_enum\_t\ direction\_fc;\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//\ Para\ Cabin\ Request\ (GW\_REQUEST\_TYPE\_CABIN\_REQUEST)}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{char}\ requesting\_elevator\_id\_cr[ID\_STRING\_MAX\_LEN];\ \ }
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordtype}{int}\ target\_floor\_cr;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//\ Otros\ tipos\ de\ solicitud\ pueden\ añadir\ sus\ campos\ aquí\ si\ es\ necesario.}}
\DoxyCodeLine{00151\ \}\ api\_request\_details\_for\_json\_t;}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \textcolor{comment}{//\ -\/-\/-\/\ Prototipos\ de\ Funciones\ -\/-\/-\/}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00169\ \textcolor{keywordtype}{void}\ init\_elevator\_group(elevator\_group\_state\_t\ *group,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ edificio\_id\_str,\ \textcolor{keywordtype}{int}\ num\_elevadores,\ \textcolor{keywordtype}{int}\ num\_pisos);}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00187\ cJSON*\ elevator\_group\_to\_json\_for\_server(\textcolor{keyword}{const}\ elevator\_group\_state\_t\ *group,\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gw\_request\_type\_t\ request\_type,\ }
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ api\_request\_details\_for\_json\_t*\ details);}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00205\ \textcolor{keywordtype}{void}\ assign\_task\_to\_elevator(elevator\_group\_state\_t\ *group,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ elevator\_id\_to\_update,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ task\_id,\ \textcolor{keywordtype}{int}\ target\_floor,\ \textcolor{keywordtype}{int}\ current\_request\_floor);}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00217\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ door\_state\_to\_string(door\_state\_enum\_t\ state);}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00229\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ movement\_direction\_to\_string(movement\_direction\_enum\_t\ direction);}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ ELEVATOR\_STATE\_MANAGER\_H\ }}

\end{DoxyCode}

\subsection{execution\_\_logger\_8h\_source}
\doxysection{execution\+\_\+logger.\+h}
\label{execution__logger_8h_source}\index{include/api\_gateway/execution\_logger.h@{include/api\_gateway/execution\_logger.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#ifndef\ EXECUTION\_LOGGER\_H}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#define\ EXECUTION\_LOGGER\_H}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <stdbool.h>}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ <time.h>}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00032\ \textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \{}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{comment}{//\ ============================================================================}}
\DoxyCodeLine{00036\ \textcolor{comment}{//\ CONSTANTES\ Y\ CONFIGURACIÓN}}
\DoxyCodeLine{00037\ \textcolor{comment}{//\ ============================================================================}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ MAX\_LOG\_PATH\ 512\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#define\ MAX\_LOG\_MESSAGE\ 1024\ \ \ \ }}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#define\ MAX\_EVENT\_DESCRIPTION\ 256\ }}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{comment}{//\ ============================================================================}}
\DoxyCodeLine{00044\ \textcolor{comment}{//\ TIPOS\ DE\ EVENTOS}}
\DoxyCodeLine{00045\ \textcolor{comment}{//\ ============================================================================}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00050\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00051\ \ \ \ \ LOG\_EVENT\_SYSTEM\_START,\ \ \ \ \ }
\DoxyCodeLine{00052\ \ \ \ \ LOG\_EVENT\_SYSTEM\_END,\ \ \ \ \ \ \ }
\DoxyCodeLine{00053\ \ \ \ \ LOG\_EVENT\_SIMULATION\_START,\ }
\DoxyCodeLine{00054\ \ \ \ \ LOG\_EVENT\_SIMULATION\_END,\ \ \ }
\DoxyCodeLine{00055\ \ \ \ \ LOG\_EVENT\_BUILDING\_SELECTED,}
\DoxyCodeLine{00056\ \ \ \ \ LOG\_EVENT\_CAN\_SENT,\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00057\ \ \ \ \ LOG\_EVENT\_CAN\_RECEIVED,\ \ \ \ \ }
\DoxyCodeLine{00058\ \ \ \ \ LOG\_EVENT\_COAP\_SENT,\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00059\ \ \ \ \ LOG\_EVENT\_COAP\_RECEIVED,\ \ \ \ }
\DoxyCodeLine{00060\ \ \ \ \ LOG\_EVENT\_TASK\_ASSIGNED,\ \ \ \ }
\DoxyCodeLine{00061\ \ \ \ \ LOG\_EVENT\_ELEVATOR\_MOVED,\ \ \ }
\DoxyCodeLine{00062\ \ \ \ \ LOG\_EVENT\_TASK\_COMPLETED,\ \ \ }
\DoxyCodeLine{00063\ \ \ \ \ LOG\_EVENT\_ERROR\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00064\ \}\ log\_event\_type\_t;}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00069\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00070\ \ \ \ \ log\_event\_type\_t\ type;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00071\ \ \ \ \ time\_t\ timestamp;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{char}\ description[MAX\_EVENT\_DESCRIPTION];\ \ \ \ \ \ \ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordtype}{char}\ details[MAX\_LOG\_MESSAGE];\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00074\ \}\ log\_event\_t;}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00079\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_can\_frames\_sent;\ \ \ \ \ \ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_can\_frames\_received;\ \ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_coap\_requests;\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_coap\_responses;\ \ \ \ \ \ \ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_tasks\_assigned;\ \ \ \ \ \ \ }
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_tasks\_completed;\ \ \ \ \ \ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_elevator\_movements;\ \ \ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{int}\ total\_errors;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordtype}{double}\ execution\_duration\_sec;\ \ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordtype}{char}\ building\_id[32];\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{int}\ building\_requests;\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00091\ \}\ execution\_stats\_t;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \textcolor{comment}{//\ ============================================================================}}
\DoxyCodeLine{00094\ \textcolor{comment}{//\ FUNCIONES\ PÚBLICAS}}
\DoxyCodeLine{00095\ \textcolor{comment}{//\ ============================================================================}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00107\ \textcolor{keywordtype}{bool}\ exec\_logger\_init(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00118\ \textcolor{keywordtype}{void}\ exec\_logger\_finish(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00126\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_event(log\_event\_type\_t\ type,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ description,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ details);}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00133\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_simulation\_start(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ building\_id,\ \textcolor{keywordtype}{int}\ num\_requests);}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00140\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_simulation\_end(\textcolor{keywordtype}{int}\ successful\_requests,\ \textcolor{keywordtype}{int}\ total\_requests);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00149\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_can\_sent(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ can\_id,\ \textcolor{keywordtype}{int}\ dlc,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ data,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ description);}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00158\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_can\_received(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ can\_id,\ \textcolor{keywordtype}{int}\ dlc,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*\ data,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ description);}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00166\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_coap\_sent(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ method,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ uri,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ payload);}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00173\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_coap\_received(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ code,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ payload);}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00181\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_task\_assigned(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ task\_id,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ elevator\_id,\ \textcolor{keywordtype}{int}\ target\_floor);}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00190\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_elevator\_moved(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ elevator\_id,\ \textcolor{keywordtype}{int}\ from\_floor,\ \textcolor{keywordtype}{int}\ to\_floor,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ direction);}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00198\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_task\_completed(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ task\_id,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ elevator\_id,\ \textcolor{keywordtype}{int}\ final\_floor);}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00205\ \textcolor{keywordtype}{void}\ exec\_logger\_log\_error(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ error\_code,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ error\_message);}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00211\ \textcolor{keyword}{const}\ execution\_stats\_t*\ exec\_logger\_get\_stats(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00217\ \textcolor{keywordtype}{bool}\ exec\_logger\_is\_active(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \textcolor{preprocessor}{\#ifdef\ \_\_cplusplus}}
\DoxyCodeLine{00220\ \}}
\DoxyCodeLine{00221\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EXECUTION\_LOGGER\_H\ }}

\end{DoxyCode}

\subsection{files}
\doxysection{File List}
Here is a list of all files with brief descriptions\+:\begin{DoxyCompactList}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ api\+\_\+common\+\_\+defs.\+h} }{\pageref{api__common__defs_8h}}{}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ api\+\_\+handlers.\+h} }{\pageref{include_2api__gateway_2api__handlers_8h}}{}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ can\+\_\+bridge.\+h} \\*Puente CAN-\/\+Co\+AP para el API Gateway }{\pageref{can__bridge_8h}}{}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ coap\+\_\+config.\+h} \\*Configuraciones Co\+AP para el API Gateway }{\pageref{coap__config_8h}}{}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ elevator\+\_\+state\+\_\+manager.\+h} \\*Gestor de Estado de Ascensores para el API Gateway }{\pageref{elevator__state__manager_8h}}{}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ execution\+\_\+logger.\+h} \\*Sistema de Logging de Ejecuciones para Resultados de TFG }{\pageref{execution__logger_8h}}{}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ logging\+\_\+gw.\+h} \\*Sistema de Logging para el API Gateway }{\pageref{logging__gw_8h}}{}
\item\contentsline{section}{include/api\+\_\+gateway/\textbf{ simulation\+\_\+loader.\+h} \\*Sistema de Carga y Ejecución de Simulaciones de Ascensores }{\pageref{simulation__loader_8h}}{}
\item\contentsline{section}{src/\textbf{ api\+\_\+handlers.\+c} \\*Implementación de manejadores Co\+AP para el API Gateway }{\pageref{api__handlers_8c}}{}
\item\contentsline{section}{src/\textbf{ api\+\_\+handlers.\+h} \\*Declares Co\+AP handler functions and related data structures for the API Gateway }{\pageref{src_2api__handlers_8h}}{}
\item\contentsline{section}{src/\textbf{ can\+\_\+bridge.\+c} \\*Implementación del Puente CAN-\/\+Co\+AP para el API Gateway }{\pageref{can__bridge_8c}}{}
\item\contentsline{section}{src/\textbf{ elevator\+\_\+state\+\_\+manager.\+c} \\*Implementación del Gestor de Estado de Ascensores del API Gateway }{\pageref{elevator__state__manager_8c}}{}
\item\contentsline{section}{src/\textbf{ execution\+\_\+logger.\+c} \\*Implementación del Sistema de Logging de Ejecuciones }{\pageref{execution__logger_8c}}{}
\item\contentsline{section}{src/\textbf{ main.\+c} \\*Punto de entrada principal del API Gateway del Sistema de Control de Ascensores }{\pageref{main_8c}}{}
\item\contentsline{section}{src/\textbf{ main\+\_\+dynamic\+\_\+port.\+c} \\*Versión del API Gateway que acepta puerto como parámetro }{\pageref{main__dynamic__port_8c}}{}
\item\contentsline{section}{src/\textbf{ mi\+\_\+simulador\+\_\+ascensor.\+c} \\*Simulador de Ascensores para Testing del API Gateway }{\pageref{mi__simulador__ascensor_8c}}{}
\item\contentsline{section}{src/\textbf{ psk\+\_\+manager.\+c} \\*Implementación del gestor de claves PSK }{\pageref{psk__manager_8c}}{}
\item\contentsline{section}{src/\textbf{ psk\+\_\+manager.\+h} \\*Gestor de claves PSK para API Gateway }{\pageref{psk__manager_8h}}{}
\item\contentsline{section}{src/\textbf{ simulation\+\_\+loader.\+c} \\*Implementación del Sistema de Carga y Ejecución de Simulaciones }{\pageref{simulation__loader_8c}}{}
\end{DoxyCompactList}

\subsection{group\_\_ansi\_\_colors\_\_gw}
\doxysection{Códigos de Color ANSI para Gateway}
\label{group__ansi__colors__gw}\index{Códigos de Color ANSI para Gateway@{Códigos de Color ANSI para Gateway}}


Definiciones de códigos de escape ANSI para colorear la salida del gateway.  


Definiciones de códigos de escape ANSI para colorear la salida del gateway. 


\subsection{group\_\_central\_\_server}
\doxysection{Configuración del Servidor Central}
\label{group__central__server}\index{Configuración del Servidor Central@{Configuración del Servidor Central}}


Configuraciones para conectar con el servidor central.  


Configuraciones para conectar con el servidor central. 


\subsection{group\_\_coap\_\_resources}
\doxysection{Recursos Co\+AP}
\label{group__coap__resources}\index{Recursos CoAP@{Recursos CoAP}}


Definiciones de rutas de recursos Co\+AP.  


Definiciones de rutas de recursos Co\+AP. 


\subsection{group\_\_coap\_\_timeouts}
\doxysection{Configuraciones de Timeout}
\label{group__coap__timeouts}\index{Configuraciones de Timeout@{Configuraciones de Timeout}}


Configuraciones de tiempo para solicitudes Co\+AP.  


Configuraciones de tiempo para solicitudes Co\+AP. 


\subsection{group\_\_gateway\_\_listen}
\doxysection{Configuración de Escucha del Gateway}
\label{group__gateway__listen}\index{Configuración de Escucha del Gateway@{Configuración de Escucha del Gateway}}


Configuraciones para el servidor Co\+AP del API Gateway.  


Configuraciones para el servidor Co\+AP del API Gateway. 


\subsection{group\_\_logging\_\_macros\_\_gw}
\doxysection{Macros de Logging del Gateway}
\label{group__logging__macros__gw}\index{Macros de Logging del Gateway@{Macros de Logging del Gateway}}


Macros para generar mensajes de log con formato específico del gateway.  


Macros para generar mensajes de log con formato específico del gateway. 


\subsection{group\_\_simulation\_\_data}
\doxysection{Estructuras de Datos de Simulación}
\label{group__simulation__data}\index{Estructuras de Datos de Simulación@{Estructuras de Datos de Simulación}}


Estructuras para almacenar datos de simulación.  


\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ peticion\+\_\+simulacion\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura para una petición individual. \end{DoxyCompactList}\item 
struct \textbf{ edificio\+\_\+simulacion\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura para un edificio de simulación. \end{DoxyCompactList}\item 
struct \textbf{ datos\+\_\+simulacion\+\_\+t}
\begin{DoxyCompactList}\small\item\em Estructura principal de datos de simulación. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ tipo\+\_\+peticion\+\_\+t} \{ \textbf{ PETICION\+\_\+\+LLAMADA\+\_\+\+PISO}
, \textbf{ PETICION\+\_\+\+SOLICITUD\+\_\+\+CABINA}
 \}
\begin{DoxyCompactList}\small\item\em Tipos de peticiones de simulación. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Estructuras para almacenar datos de simulación. 



\doxysubsection{Enumeration Type Documentation}
\label{group__simulation__data_ga3ca9553bd7d4fcac8ebbcf4a42cdd5fd} 
\index{Estructuras de Datos de Simulación@{Estructuras de Datos de Simulación}!tipo\_peticion\_t@{tipo\_peticion\_t}}
\index{tipo\_peticion\_t@{tipo\_peticion\_t}!Estructuras de Datos de Simulación@{Estructuras de Datos de Simulación}}
\doxysubsubsection{tipo\_peticion\_t}
{\footnotesize\ttfamily enum \textbf{ tipo\+\_\+peticion\+\_\+t}}



Tipos de peticiones de simulación. 

Enumeración que define los tipos de peticiones que pueden ser ejecutadas durante la simulación de ascensores. \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{PETICION\_LLAMADA\_PISO@{PETICION\_LLAMADA\_PISO}!Estructuras de Datos de Simulación@{Estructuras de Datos de Simulación}}\index{Estructuras de Datos de Simulación@{Estructuras de Datos de Simulación}!PETICION\_LLAMADA\_PISO@{PETICION\_LLAMADA\_PISO}}}\label{group__simulation__data_gga3ca9553bd7d4fcac8ebbcf4a42cdd5fdaa8a594f4a4eb65f5273deecca2aa912e} 
PETICION\+\_\+\+LLAMADA\+\_\+\+PISO&Llamada de piso desde botón externo \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{PETICION\_SOLICITUD\_CABINA@{PETICION\_SOLICITUD\_CABINA}!Estructuras de Datos de Simulación@{Estructuras de Datos de Simulación}}\index{Estructuras de Datos de Simulación@{Estructuras de Datos de Simulación}!PETICION\_SOLICITUD\_CABINA@{PETICION\_SOLICITUD\_CABINA}}}\label{group__simulation__data_gga3ca9553bd7d4fcac8ebbcf4a42cdd5fda7c8e25b202d66c0733090045d9fe093f} 
PETICION\+\_\+\+SOLICITUD\+\_\+\+CABINA&Solicitud desde interior de cabina \\
\hline

\end{DoxyEnumFields}

\subsection{group\_\_simulation\_\_functions}
\doxysection{Funciones de Simulación}
\label{group__simulation__functions}\index{Funciones de Simulación@{Funciones de Simulación}}


Funciones para cargar y ejecutar simulaciones.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \textbf{ cargar\+\_\+datos\+\_\+simulacion} (const char $\ast$archivo\+\_\+json, \textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Carga los datos de simulación desde un archivo JSON. \end{DoxyCompactList}\item 
void \textbf{ liberar\+\_\+datos\+\_\+simulacion} (\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Libera la memoria utilizada por los datos de simulación. \end{DoxyCompactList}\item 
\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$ \textbf{ seleccionar\+\_\+edificio\+\_\+aleatorio} (\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$datos)
\begin{DoxyCompactList}\small\item\em Selecciona un edificio aleatorio de los datos cargados. \end{DoxyCompactList}\item 
int \textbf{ ejecutar\+\_\+peticiones\+\_\+edificio} (\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$edificio, coap\+\_\+context\+\_\+t $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Ejecuta todas las peticiones de un edificio. \end{DoxyCompactList}\item 
int \textbf{ convertir\+\_\+direccion\+\_\+string} (const char $\ast$direccion\+\_\+str)
\begin{DoxyCompactList}\small\item\em Convierte una cadena de dirección a enum. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Funciones para cargar y ejecutar simulaciones. 



\doxysubsection{Function Documentation}
\label{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 
\index{Funciones de Simulación@{Funciones de Simulación}!cargar\_datos\_simulacion@{cargar\_datos\_simulacion}}
\index{cargar\_datos\_simulacion@{cargar\_datos\_simulacion}!Funciones de Simulación@{Funciones de Simulación}}
\doxysubsubsection{cargar\_datos\_simulacion()}
{\footnotesize\ttfamily bool cargar\+\_\+datos\+\_\+simulacion (\begin{DoxyParamCaption}\item[{const char $\ast$}]{archivo\+\_\+json,  }\item[{\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$}]{datos }\end{DoxyParamCaption})}



Carga los datos de simulación desde un archivo JSON. 


\begin{DoxyParams}{Parameters}
{\em archivo\+\_\+json} & Ruta al archivo JSON con los datos de simulación \\
\hline
{\em datos} & Puntero a la estructura donde almacenar los datos cargados \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true si la carga fue exitosa, false en caso de error
\end{DoxyReturn}
Esta función lee un archivo JSON que contiene edificios y sus peticiones asociadas, parseando la información y almacenándola en estructuras C para su posterior ejecución.

{\bfseries{Formato JSON esperado\+:}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}edificios"{}:\ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ "{}id\_edificio"{}:\ "{}E001"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}peticiones"{}:\ [}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{"{}tipo"{}:\ "{}llamada\_piso"{},\ "{}piso\_origen"{}:\ 0,\ "{}direccion"{}:\ "{}up"{}\},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{"{}tipo"{}:\ "{}solicitud\_cabina"{},\ "{}indice\_ascensor"{}:\ 0,\ "{}piso\_destino"{}:\ 5\}}
\DoxyCodeLine{\ \ \ \ \ \ ]}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ ]}
\DoxyCodeLine{\}}

\end{DoxyCode}


\begin{DoxySeeAlso}{See also}
\doxyref{liberar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_gac117e5c59e59401d320840125a9d6e1a} 

c\+JSON\+\_\+\+Parse() 
\end{DoxySeeAlso}
\label{group__simulation__functions_ga044d62cee9ad0a09b369ba217a3f04cc} 
\index{Funciones de Simulación@{Funciones de Simulación}!convertir\_direccion\_string@{convertir\_direccion\_string}}
\index{convertir\_direccion\_string@{convertir\_direccion\_string}!Funciones de Simulación@{Funciones de Simulación}}
\doxysubsubsection{convertir\_direccion\_string()}
{\footnotesize\ttfamily int convertir\+\_\+direccion\+\_\+string (\begin{DoxyParamCaption}\item[{const char $\ast$}]{direccion\+\_\+str }\end{DoxyParamCaption})}



Convierte una cadena de dirección a enum. 


\begin{DoxyParams}{Parameters}
{\em direccion\+\_\+str} & Cadena con la dirección ("{}up"{} o "{}down"{}) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Valor del enum correspondiente
\end{DoxyReturn}
Función auxiliar para convertir las direcciones en formato texto del JSON a los valores enum utilizados por el simulador.

\begin{DoxySeeAlso}{See also}
\doxyref{movement\+\_\+direction\+\_\+enum\+\_\+t}{p.}{elevator__state__manager_8h_a1a5ec99e71d6b5e93656ae922276bf01} 
\end{DoxySeeAlso}
\label{group__simulation__functions_ga5d1879571222c772ec4e7346f2f930df} 
\index{Funciones de Simulación@{Funciones de Simulación}!ejecutar\_peticiones\_edificio@{ejecutar\_peticiones\_edificio}}
\index{ejecutar\_peticiones\_edificio@{ejecutar\_peticiones\_edificio}!Funciones de Simulación@{Funciones de Simulación}}
\doxysubsubsection{ejecutar\_peticiones\_edificio()}
{\footnotesize\ttfamily int ejecutar\+\_\+peticiones\+\_\+edificio (\begin{DoxyParamCaption}\item[{\textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$}]{edificio,  }\item[{coap\+\_\+context\+\_\+t $\ast$}]{ctx }\end{DoxyParamCaption})}



Ejecuta todas las peticiones de un edificio. 


\begin{DoxyParams}{Parameters}
{\em edificio} & Puntero al edificio cuyas peticiones ejecutar \\
\hline
{\em ctx} & Contexto Co\+AP para el procesamiento de peticiones \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Número de peticiones ejecutadas exitosamente
\end{DoxyReturn}
Esta función ejecuta secuencialmente todas las peticiones de un edificio específico, con pausas entre peticiones para permitir el procesamiento de respuestas Co\+AP.

{\bfseries{Proceso de ejecución\+:}}
\begin{DoxyEnumerate}
\item Configura el ID del edificio en el sistema
\item Ejecuta cada petición según su tipo
\item Procesa I/O Co\+AP entre peticiones
\item Proporciona logging detallado del progreso
\end{DoxyEnumerate}

\begin{DoxySeeAlso}{See also}
\doxyref{simular\+\_\+llamada\+\_\+de\+\_\+piso\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_ad2f8184c447385d5155da6a8d87e6c16} 

\doxyref{simular\+\_\+solicitud\+\_\+cabina\+\_\+via\+\_\+can()}{p.}{mi__simulador__ascensor_8c_a75bd27a88662d9e2ac061e5285fc7ecb} 

coap\+\_\+io\+\_\+process() 
\end{DoxySeeAlso}
\label{group__simulation__functions_gac117e5c59e59401d320840125a9d6e1a} 
\index{Funciones de Simulación@{Funciones de Simulación}!liberar\_datos\_simulacion@{liberar\_datos\_simulacion}}
\index{liberar\_datos\_simulacion@{liberar\_datos\_simulacion}!Funciones de Simulación@{Funciones de Simulación}}
\doxysubsubsection{liberar\_datos\_simulacion()}
{\footnotesize\ttfamily void liberar\+\_\+datos\+\_\+simulacion (\begin{DoxyParamCaption}\item[{\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$}]{datos }\end{DoxyParamCaption})}



Libera la memoria utilizada por los datos de simulación. 


\begin{DoxyParams}{Parameters}
{\em datos} & Puntero a la estructura de datos a liberar\\
\hline
\end{DoxyParams}
Esta función libera toda la memoria dinámica asignada durante la carga de datos de simulación, incluyendo arrays de edificios y peticiones.

\begin{DoxySeeAlso}{See also}
\doxyref{cargar\+\_\+datos\+\_\+simulacion()}{p.}{group__simulation__functions_ga189a79642cdf0001b3a29062e4180af3} 
\end{DoxySeeAlso}
\label{group__simulation__functions_ga87620ad51d06f241a3106a36c40ac787} 
\index{Funciones de Simulación@{Funciones de Simulación}!seleccionar\_edificio\_aleatorio@{seleccionar\_edificio\_aleatorio}}
\index{seleccionar\_edificio\_aleatorio@{seleccionar\_edificio\_aleatorio}!Funciones de Simulación@{Funciones de Simulación}}
\doxysubsubsection{seleccionar\_edificio\_aleatorio()}
{\footnotesize\ttfamily \textbf{ edificio\+\_\+simulacion\+\_\+t} $\ast$ seleccionar\+\_\+edificio\+\_\+aleatorio (\begin{DoxyParamCaption}\item[{\textbf{ datos\+\_\+simulacion\+\_\+t} $\ast$}]{datos }\end{DoxyParamCaption})}



Selecciona un edificio aleatorio de los datos cargados. 


\begin{DoxyParams}{Parameters}
{\em datos} & Puntero a los datos de simulación cargados \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Puntero al edificio seleccionado, NULL si no hay datos
\end{DoxyReturn}
Esta función utiliza un generador de números aleatorios para seleccionar un edificio de la lista cargada. La selección es uniforme entre todos los edificios disponibles.

\begin{DoxyNote}{Note}
Inicializa el generador aleatorio con el tiempo actual 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
srand() 

rand() 
\end{DoxySeeAlso}

\subsection{include\_2api\_\_gateway\_2api\_\_handlers\_8h\_source}
\doxysection{api\+\_\+handlers.\+h}
\label{include_2api__gateway_2api__handlers_8h_source}\index{include/api\_gateway/api\_handlers.h@{include/api\_gateway/api\_handlers.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ API\_HANDLERS\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ API\_HANDLERS\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <coap3/coap.h>}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ coap\_session\_t,\ coap\_pdu\_t,\ etc.}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <signal.h>}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ sig\_atomic\_t}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}api\_common\_defs.h"{}}\ \textcolor{comment}{//\ Ensuring\ this\ is\ just\ the\ filename}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}elevator\_state\_manager.h"{}}\ \textcolor{comment}{//\ For\ movement\_direction\_enum\_t,\ and\ gw\_request\_type\_t\ now\ moved\ here}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{comment}{//\ typedef\ enum\ gw\_request\_type\_t\ is\ MOVED\ to\ elevator\_state\_manager.h}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }api\_request\_tracker\_t\ \{}
\DoxyCodeLine{00019\ \ \ \ \ coap\_session\_t\ *original\_elevator\_session;\ \ }
\DoxyCodeLine{00020\ \ \ \ \ coap\_mid\_t\ original\_mid;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00021\ \ \ \ \ coap\_binary\_t\ original\_token;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordtype}{char}\ *log\_tag;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{//\ New\ fields\ for\ detailed\ request\ tracking}}
\DoxyCodeLine{00025\ \ \ \ \ gw\_request\_type\_t\ request\_type;\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keywordtype}{int}\ origin\_floor;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{int}\ target\_floor\_for\_task;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{char}\ requesting\_elevator\_id\_cabin[ID\_STRING\_MAX\_LEN];\ }
\DoxyCodeLine{00029\ \ \ \ \ movement\_direction\_enum\_t\ requested\_direction\_floor;\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{//\ Potentially\ other\ fields\ like\ timestamp,\ retry\ count,\ etc.}}
\DoxyCodeLine{00032\ \}\ api\_request\_tracker\_t;}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{comment}{//\ Forward\ declaration\ de\ coap\_session\_t\ y\ coap\_context\_t\ para\ la\ función\ helper}}
\DoxyCodeLine{00035\ \textcolor{comment}{//\ Esto\ evita\ tener\ que\ incluir\ coap\_session.h\ y\ coap\_net.h\ aquí\ si\ no\ son\ necesarios\ para\ otras\ declaraciones.}}
\DoxyCodeLine{00036\ \textcolor{keyword}{struct\ }coap\_session\_t;}
\DoxyCodeLine{00037\ \textcolor{keyword}{struct\ }coap\_context\_t;}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{comment}{//\ Declaración\ de\ la\ función\ helper\ para\ la\ gestión\ de\ sesiones\ DTLS\ (definida\ en\ main.c)}}
\DoxyCodeLine{00040\ coap\_session\_t*\ get\_or\_create\_central\_server\_dtls\_session(\textcolor{keyword}{struct}\ coap\_context\_t\ *ctx);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{comment}{//\ -\/-\/-\/\ Signal\ Handler\ -\/-\/-\/}}
\DoxyCodeLine{00043\ \textcolor{keywordtype}{void}\ handle\_sigint\_gw(\textcolor{keywordtype}{int}\ signum);}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{comment}{//\ -\/-\/-\/\ Response\ Handler\ (for\ responses\ FROM\ Central\ Server\ TO\ Gateway)\ -\/-\/-\/}}
\DoxyCodeLine{00046\ coap\_response\_t\ hnd\_central\_server\_response\_gw(coap\_session\_t\ *session\_to\_central,}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_pdu\_t\ *sent\_to\_central,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_pdu\_t\ *received\_from\_central,}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_mid\_t\ mid\_to\_central);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{comment}{//\ -\/-\/-\/\ Resource\ Handlers\ (for\ requests\ FROM\ Clients\ TO\ Gateway)\ -\/-\/-\/}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00057\ \textcolor{keywordtype}{void}\ hnd\_elevator\_api\_request\_gw(coap\_resource\_t\ *resource,}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_session\_t\ *elevator\_session,}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_pdu\_t\ *elevator\_request\_pdu,}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_string\_t\ *query,}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_pdu\_t\ *response\_placeholder);}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00068\ \textcolor{keywordtype}{void}\ hnd\_cabin\_request\_from\_elevator\_gw(coap\_resource\_t\ *resource,}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_session\_t\ *elevator\_session,}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_pdu\_t\ *elevator\_request\_pdu,}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_string\_t\ *query,}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_pdu\_t\ *response\_placeholder);}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00079\ \textcolor{keywordtype}{void}\ hnd\_floor\_call\_from\_elevator\_gw(coap\_resource\_t\ *resource,}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_session\_t\ *elevator\_session,\ }
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_pdu\_t\ *elevator\_request\_pdu,\ }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_string\_t\ *query,\ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_pdu\_t\ *response\_placeholder);}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \textcolor{comment}{//\ Note:\ hnd\_arrival\_notification\_from\_elevator\_gw\ has\ been\ removed\ as\ the\ gateway}}
\DoxyCodeLine{00086\ \textcolor{comment}{//\ now\ simulates\ arrivals\ and\ sends\ its\ own\ notifications\ to\ the\ central\ server.}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{keyword}{extern}\ \textcolor{keyword}{volatile}\ sig\_atomic\_t\ quit\_main\_loop;\ \textcolor{comment}{//\ Defined\ in\ main.c}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ API\_HANDLERS\_H\ }}

\end{DoxyCode}

\subsection{logging\_\_gw\_8h\_source}
\doxysection{logging\+\_\+gw.\+h}
\label{logging__gw_8h_source}\index{include/api\_gateway/logging\_gw.h@{include/api\_gateway/logging\_gw.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifndef\ LOGGING\_GW\_H}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ LOGGING\_GW\_H}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \textcolor{comment}{//\ Para\ printf}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#define\ ANSI\_COLOR\_RED\ \ \ \ \ "{}\(\backslash\)x1b[31m"{}}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#define\ ANSI\_COLOR\_GREEN\ \ \ "{}\(\backslash\)x1b[32m"{}}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#define\ ANSI\_COLOR\_YELLOW\ \ "{}\(\backslash\)x1b[33m"{}}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#define\ ANSI\_COLOR\_BLUE\ \ \ \ "{}\(\backslash\)x1b[34m"{}}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#define\ ANSI\_COLOR\_MAGENTA\ "{}\(\backslash\)x1b[35m"{}}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#define\ ANSI\_COLOR\_CYAN\ \ \ \ "{}\(\backslash\)x1b[36m"{}}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#define\ ANSI\_COLOR\_RESET\ \ \ "{}\(\backslash\)x1b[0m"{}}}
\DoxyCodeLine{00060\ }
 \textcolor{comment}{// end of ansi\_colors\_gw group}\DoxyCodeLine{00062\ }
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#define\ LOG\_INFO\_GW(format,\ ...)\ \(\backslash\)}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\ \ \ \ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ printf(ANSI\_COLOR\_GREEN\ "{}[INFO-\/GW]\ "{}\ ANSI\_COLOR\_RESET\ format\ "{}\(\backslash\)n"{},\ \#\#\_\_VA\_ARGS\_\_);\ \(\backslash\)}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fflush(stdout);\ \(\backslash\)}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\ \ \ \ \}\ while\ (0)}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#define\ LOG\_DEBUG\_GW(format,\ ...)\ \(\backslash\)}}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\ \ \ \ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{00097\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ printf(ANSI\_COLOR\_BLUE\ "{}[DEBUG-\/GW]\ "{}\ ANSI\_COLOR\_RESET\ format\ "{}\(\backslash\)n"{},\ \#\#\_\_VA\_ARGS\_\_);\ \(\backslash\)}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fflush(stdout);\ \(\backslash\)}}
\DoxyCodeLine{00099\ \textcolor{preprocessor}{\ \ \ \ \}\ while\ (0)}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\#define\ LOG\_WARN\_GW(format,\ ...)\ \(\backslash\)}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\ \ \ \ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fprintf(stderr,\ ANSI\_COLOR\_YELLOW\ "{}[WARN-\/GW]\ "{}\ ANSI\_COLOR\_RESET\ format\ "{}\(\backslash\)n"{},\ \#\#\_\_VA\_ARGS\_\_);\ \(\backslash\)}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fflush(stderr);\ \(\backslash\)}}
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\ \ \ \ \}\ while\ (0)}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\#define\ LOG\_ERROR\_GW(format,\ ...)\ \(\backslash\)}}
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\ \ \ \ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fprintf(stderr,\ ANSI\_COLOR\_RED\ "{}[ERROR-\/GW]\ "{}\ ANSI\_COLOR\_RESET\ format\ "{}\(\backslash\)n"{},\ \#\#\_\_VA\_ARGS\_\_);\ \(\backslash\)}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fflush(stderr);\ \(\backslash\)}}
\DoxyCodeLine{00129\ \textcolor{preprocessor}{\ \ \ \ \}\ while\ (0)}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\#define\ LOG\_CRIT\_GW(format,\ ...)\ \(\backslash\)}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\ \ \ \ do\ \{\ \(\backslash\)}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fprintf(stderr,\ ANSI\_COLOR\_MAGENTA\ "{}[CRIT-\/GW]\ "{}\ ANSI\_COLOR\_RESET\ format\ "{}\(\backslash\)n"{},\ \#\#\_\_VA\_ARGS\_\_);\ \(\backslash\)}}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ fflush(stderr);\ \(\backslash\)}}
\DoxyCodeLine{00146\ \textcolor{preprocessor}{\ \ \ \ \}\ while\ (0)}}
\DoxyCodeLine{00147\ }
 \textcolor{comment}{// end of logging\_macros\_gw group}\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ LOGGING\_GW\_H\ }}

\end{DoxyCode}

\subsection{psk\_\_manager\_8h\_source}
\doxysection{psk\+\_\+manager.\+h}
\label{psk__manager_8h_source}\index{src/psk\_manager.h@{src/psk\_manager.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#ifndef\ PSK\_MANAGER\_H}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#define\ PSK\_MANAGER\_H}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <stddef.h>}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00022\ \textcolor{keywordtype}{int}\ psk\_manager\_init(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ keys\_file\_path);}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00030\ \textcolor{keywordtype}{int}\ psk\_manager\_get\_random\_key(\textcolor{keywordtype}{char}*\ key\_buffer,\ \textcolor{keywordtype}{size\_t}\ buffer\_size);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00038\ \textcolor{keywordtype}{int}\ psk\_manager\_get\_first\_key(\textcolor{keywordtype}{char}*\ key\_buffer,\ \textcolor{keywordtype}{size\_t}\ buffer\_size);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00047\ \textcolor{keywordtype}{int}\ psk\_manager\_get\_deterministic\_key(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ identity,\ \textcolor{keywordtype}{char}*\ key\_buffer,\ \textcolor{keywordtype}{size\_t}\ buffer\_size);}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00052\ \textcolor{keywordtype}{void}\ psk\_manager\_cleanup(\textcolor{keywordtype}{void});}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ PSK\_MANAGER\_H\ }}

\end{DoxyCode}

\subsection{refman}
  % Handle batch mode
  % to overcome problems with too many open files
  \let\mypdfximage\pdfximage\def\pdfximage{\immediate\mypdfximage}
  \pdfminorversion=7
  % Set document class depending on configuration
  \documentclass[twoside]{book}
  %% moved from doxygen.sty due to workaround for LaTex 2019 version and unmaintained tabu package
  \usepackage{ifthen}
  \ifx\requestedLaTeXdate\undefined
    \usepackage{array}
  \else
    \usepackage{array}[=2016-10-06]
  \fi
  %%
  % Packages required by doxygen
  \makeatletter
  \providecommand\IfFormatAtLeastTF{\@ifl@t@r\fmtversion}
  % suppress package identification of infwarerr as it contains the word "warning"
  \let\@@protected@wlog\protected@wlog
  \def\protected@wlog#1{\wlog{package info suppressed}}
  \RequirePackage{infwarerr}
  \let\protected@wlog\@@protected@wlog
  \makeatother
  \IfFormatAtLeastTF{2016/01/01}{}{\usepackage{fixltx2e}} % for \textsubscript
  \IfFormatAtLeastTF{2015/01/01}{\pdfsuppresswarningpagegroup=1}{}
  \usepackage{doxygen}
  \usepackage{graphicx}
  \usepackage[utf8]{inputenc}
  \usepackage{makeidx}
  \PassOptionsToPackage{warn}{textcomp}
  \usepackage{textcomp}
  \usepackage[nointegrals]{wasysym}
  \usepackage{ifxetex}
  % NLS support packages
  % Define default fonts
  % Font selection
  \usepackage[T1]{fontenc}
  % set main and monospaced font
  \usepackage[scaled=.90]{helvet}
\usepackage{courier}
\renewcommand{\familydefault}{\sfdefault}
  \doxyallsectionsfont{%
    \fontseries{bc}\selectfont%
    \color{darkgray}%
  }
  \renewcommand{\DoxyLabelFont}{%
    \fontseries{bc}\selectfont%
    \color{darkgray}%
  }
  \newcommand{\+}{\discretionary{\mbox{\scriptsize$\hookleftarrow$}}{}{}}
   % Arguments of doxygenemoji:
   % 1) ':<text>:' form of the emoji, already LaTeX-escaped
   % 2) file with the name of the emoji without the .png extension
   % in case image exist use this otherwise use the ':<text>:' form
   \newcommand{\doxygenemoji}[2]{%
     \IfFileExists{./#2.png}{\raisebox{-0.1em}{\includegraphics[height=0.9em]{./#2.png}}}{#1}%
   }
  % Page & text layout
  \usepackage{geometry}
  \geometry{%
    a4paper,%
    top=2.5cm,%
    bottom=2.5cm,%
    left=2.5cm,%
    right=2.5cm%
  }
  \usepackage{changepage}
  % Allow a bit of overflow to go unnoticed by other means
  \tolerance=750
  \hfuzz=15pt
  \hbadness=750
  \setlength{\emergencystretch}{15pt}
  \setlength{\parindent}{0cm}
  \newcommand{\doxynormalparskip}{\setlength{\parskip}{3ex plus 2ex minus 2ex}}
  \newcommand{\doxytocparskip}{\setlength{\parskip}{1ex plus 0ex minus 0ex}}
  \doxynormalparskip
  % Redefine paragraph/subparagraph environments, using sectsty fonts
  \makeatletter
  \renewcommand{\paragraph}{%
    \@startsection{paragraph}{4}{0ex}{-1.0ex}{1.0ex}{%
      \normalfont\normalsize\bfseries\SS@parafont%
    }%
  }
  \renewcommand{\subparagraph}{%
    \@startsection{subparagraph}{5}{0ex}{-1.0ex}{1.0ex}{%
      \normalfont\normalsize\bfseries\SS@subparafont%
    }%
  }
  \makeatother
  \makeatletter
  \newcommand\hrulefilll{\leavevmode\leaders\hrule\hskip 0pt plus 1filll\kern\z@}
  \makeatother
  % Headers & footers
  \usepackage{fancyhdr}
  \pagestyle{fancyplain}
  \renewcommand{\footrulewidth}{0.4pt}
  \fancypagestyle{fancyplain}{
    \fancyhf{}
    \fancyhead[LE, RO]{\bfseries\thepage}
    \fancyhead[LO]{\bfseries\rightmark}
    \fancyhead[RE]{\bfseries\leftmark}
    \fancyfoot[LO, RE]{\bfseries\scriptsize Generated by Doxygen }
  }
  \fancypagestyle{plain}{
    \fancyhf{}
    \fancyfoot[LO, RE]{\bfseries\scriptsize Generated by Doxygen }
    \renewcommand{\headrulewidth}{0pt}
  }
  \pagestyle{fancyplain}
  \renewcommand{\chaptermark}[1]{%
    \markboth{#1}{}%
  }
  \renewcommand{\sectionmark}[1]{%
    \markright{\thesection\ #1}%
  }
  % ToC, LoF, LoT, bibliography, and index
  % Indices & bibliography
  \usepackage{natbib}
  \usepackage[titles]{tocloft}
  \setcounter{tocdepth}{3}
  \setcounter{secnumdepth}{5}
  % creating indexes
  \makeindex
  \usepackage{newunicodechar}
  \makeatletter
    \def\doxynewunicodechar#1#2{%
    \@tempswafalse
    \edef\nuc@tempa{\detokenize{#1}}%
    \if\relax\nuc@tempa\relax
      \nuc@emptyargerr
    \else
      \edef\@tempb{\expandafter\@car\nuc@tempa\@nil}%
      \nuc@check
      \if@tempswa
        \@namedef{u8:\nuc@tempa}{#2}%
      \fi
    \fi
  }
  \makeatother
  \doxynewunicodechar{⁻}{${}^{-}$}% Superscript minus
  \doxynewunicodechar{²}{${}^{2}$}% Superscript two
  \doxynewunicodechar{³}{${}^{3}$}% Superscript three
  % Hyperlinks
  % Custom commands used by the header
  % Custom commands
  \newcommand{\clearemptydoublepage}{%
    \newpage{\pagestyle{empty}\cleardoublepage}%
  }
  % caption style definition
  \usepackage{caption}
  \captionsetup{labelsep=space,justification=centering,font={bf},singlelinecheck=off,skip=4pt,position=top}
  % in page table of contents
  \IfFormatAtLeastTF{2023/05/01}{\usepackage[deeplevels]{etoc}}{\usepackage[deeplevels]{etoc_doxygen}}
  \etocsettocstyle{\doxytocparskip}{\doxynormalparskip}
  \etocsetlevel{subsubsubsection}{4}
  \etocsetlevel{subsubsubsubsection}{5}
  \etocsetlevel{subsubsubsubsubsection}{6}
  \etocsetlevel{subsubsubsubsubsubsection}{7}
  \etocsetlevel{paragraph}{8}
  \etocsetlevel{subparagraph}{9}
  % prevent numbers overlap the titles in toc
  \renewcommand{\numberline}[1]{#1~}
% End of preamble, now comes the document contents
%===== C O N T E N T S =====
\begin{document}
  \raggedbottom
  % Titlepage & ToC
  \pagenumbering{alph}
  \begin{titlepage}
  \vspace*{7cm}
  \begin{center}%
  {\Large API Gateway -\/ Sistema de Control de Ascensores}\\
  [1ex]\large 2.\+0 \\
  \vspace*{1cm}
  {\large Generated by Doxygen 1.9.8}\\
  \end{center}
  \end{titlepage}
  \clearemptydoublepage
  \pagenumbering{roman}
  \tableofcontents
  \clearemptydoublepage
  \pagenumbering{arabic}
%--- Begin generated contents ---
\chapter{Topic Documentation}
\input{group__gateway__listen}
\input{group__central__server}
\input{group__coap__resources}
\input{group__coap__timeouts}
\input{group__ansi__colors__gw}
\input{group__logging__macros__gw}
\input{group__simulation__data}
\input{group__simulation__functions}
\chapter{Data Structure Documentation}
\input{structapi__request__details__for__json__t}
\input{structapi__request__tracker__t}
\input{structcan__origin__tracker__t}
\input{structcentral__request__entry__t}
\input{structdatos__simulacion__t}
\input{structedificio__simulacion__t}
\input{structelevator__group__state__t}
\input{structelevator__status__t}
\input{structexecution__stats__t}
\input{structlog__event__t}
\input{structpeticion__simulacion__t}
\input{structpsk__keys__t}
\input{structsimulated__can__frame__t}
\chapter{File Documentation}
\input{api__common__defs_8h}
\input{api__common__defs_8h_source}
\input{can__bridge_8h}
\input{can__bridge_8h_source}
\input{coap__config_8h}
\input{coap__config_8h_source}
\input{elevator__state__manager_8h}
\input{elevator__state__manager_8h_source}
\input{execution__logger_8h}
\input{execution__logger_8h_source}
\input{logging__gw_8h}
\input{logging__gw_8h_source}
\input{simulation__loader_8h}
\input{simulation__loader_8h_source}
\input{api__handlers_8c}
\input{include_2api__gateway_2api__handlers_8h}
\input{include_2api__gateway_2api__handlers_8h_source}
\input{src_2api__handlers_8h}
\input{src_2api__handlers_8h_source}
\input{can__bridge_8c}
\input{elevator__state__manager_8c}
\input{execution__logger_8c}
\input{main_8c}
\input{main__dynamic__port_8c}
\input{mi__simulador__ascensor_8c}
\input{psk__manager_8c}
\input{psk__manager_8h}
\input{psk__manager_8h_source}
\input{simulation__loader_8c}
%--- End generated contents ---
% Index
  \backmatter
  \newpage
  \phantomsection
  \clearemptydoublepage
  \addcontentsline{toc}{chapter}{\indexname}
  \printindex
% Required for some languages (in combination with latexdocumentpre from the header)
\end{document}

\subsection{simulation\_\_loader\_8h\_source}
\doxysection{simulation\+\_\+loader.\+h}
\label{simulation__loader_8h_source}\index{include/api\_gateway/simulation\_loader.h@{include/api\_gateway/simulation\_loader.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#ifndef\ SIMULATION\_LOADER\_H}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ SIMULATION\_LOADER\_H}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <coap3/coap.h>}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ <cjson/cJSON.h>}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ <stdbool.h>}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00045\ \ \ \ \ PETICION\_LLAMADA\_PISO,\ \ \ \ }
\DoxyCodeLine{00046\ \ \ \ \ PETICION\_SOLICITUD\_CABINA\ }
\DoxyCodeLine{00047\ \}\ tipo\_peticion\_t;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00056\ \ \ \ \ tipo\_peticion\_t\ tipo;\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{comment}{//\ Para\ llamadas\ de\ piso}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordtype}{int}\ piso\_origen;\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{char}\ direccion[8];\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ Para\ solicitudes\ de\ cabina}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{int}\ indice\_ascensor;\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{int}\ piso\_destino;\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00065\ \}\ peticion\_simulacion\_t;}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00073\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordtype}{char}\ id\_edificio[16];\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00075\ \ \ \ \ peticion\_simulacion\_t\ *peticiones;\ }
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_peticiones;\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00077\ \}\ edificio\_simulacion\_t;}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00085\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00086\ \ \ \ \ edificio\_simulacion\_t\ *edificios;\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_edificios;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordtype}{bool}\ datos\_cargados;\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00089\ \}\ datos\_simulacion\_t;}
\DoxyCodeLine{00090\ }
 \textcolor{comment}{// end of simulation\_data group}\DoxyCodeLine{00092\ }
\DoxyCodeLine{00127\ \textcolor{keywordtype}{bool}\ cargar\_datos\_simulacion(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *archivo\_json,\ datos\_simulacion\_t\ *datos);}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00139\ \textcolor{keywordtype}{void}\ liberar\_datos\_simulacion(datos\_simulacion\_t\ *datos);}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00154\ edificio\_simulacion\_t*\ seleccionar\_edificio\_aleatorio(datos\_simulacion\_t\ *datos);}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00176\ \textcolor{keywordtype}{int}\ ejecutar\_peticiones\_edificio(edificio\_simulacion\_t\ *edificio,\ coap\_context\_t\ *ctx);}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00188\ \textcolor{keywordtype}{int}\ convertir\_direccion\_string(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *direccion\_str);}
\DoxyCodeLine{00189\ }
 \textcolor{comment}{// end of simulation\_functions group}\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ SIMULATION\_LOADER\_H\ }}

\end{DoxyCode}

\subsection{src\_2api\_\_handlers\_8h\_source}
\doxysection{api\+\_\+handlers.\+h}
\label{src_2api__handlers_8h_source}\index{src/api\_handlers.h@{src/api\_handlers.h}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifndef\ API\_GATEWAY\_API\_HANDLERS\_H}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ API\_GATEWAY\_API\_HANDLERS\_H}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <coap3/coap.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}api\_gateway/coap\_config.h"{}}\ \textcolor{comment}{//\ Asegurar\ que\ coap\_config.h\ esté\ incluido}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}api\_gateway/elevator\_state\_manager.h"{}}\ \textcolor{comment}{//\ Para\ enums\ y\ ID\_STRING\_MAX\_LEN}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{comment}{//\ Resource\ paths\ the\ API\ Gateway\ would\ listen\ on\ -\/\ REMOVED\ FOR\ SIMPLIFICATION}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ \#define\ GW\_ELEVATOR\_LEGACY\_PATH\ "{}peticion\_ascensor"{}}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ \#define\ GW\_CABIN\_REQUEST\_PATH\ "{}cabin\_request\_gw"{}}}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ \#define\ GW\_FLOOR\_CALL\_PATH\ "{}floor\_call\_gw"{}}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ \#define\ GW\_ARRIVAL\_NOTIFICATION\_PATH\ "{}arrival\_notification\_gw"{}\ //\ Not\ used}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{comment}{//\ Tipo\ de\ solicitud\ originada/procesada\ por\ el\ Gateway}}
\DoxyCodeLine{00021\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00022\ \ \ \ \ GW\_REQUEST\_TYPE\_UNKNOWN,}
\DoxyCodeLine{00023\ \ \ \ \ GW\_REQUEST\_TYPE\_FLOOR\_CALL,}
\DoxyCodeLine{00024\ \ \ \ \ GW\_REQUEST\_TYPE\_CABIN\_REQUEST}
\DoxyCodeLine{00025\ \}\ gw\_request\_type\_t;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00037\ \ \ \ \ coap\_session\_t\ *original\_elevator\_session;\ }
\DoxyCodeLine{00038\ \ \ \ \ coap\_binary\_t\ original\_token;\ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00039\ \ \ \ \ coap\_mid\_t\ original\_mid;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{char}\ *log\_tag;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ Nuevos\ campos\ para\ la\ lógica\ de\ gestión\ de\ estado\ del\ Gateway}}
\DoxyCodeLine{00043\ \ \ \ \ gw\_request\_type\_t\ request\_type;\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordtype}{int}\ origin\_floor;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordtype}{int}\ target\_floor\_for\_task;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{char}\ requesting\_elevator\_id\_cabin[ID\_STRING\_MAX\_LEN];\ }
\DoxyCodeLine{00047\ \ \ \ \ movement\_direction\_enum\_t\ requested\_direction\_floor;\ }
\DoxyCodeLine{00049\ \}\ api\_request\_tracker\_t;}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00056\ \textcolor{keywordtype}{void}\ handle\_sigint\_gw(\textcolor{keywordtype}{int}\ signum);}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00071\ coap\_response\_t}
\DoxyCodeLine{00072\ hnd\_central\_server\_response\_gw(coap\_session\_t\ *session\_to\_central,}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_pdu\_t\ *sent\_to\_central,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_pdu\_t\ *received\_from\_central,}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ coap\_mid\_t\ mid\_to\_central);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{comment}{//\ HANDLERS\ FOR\ GATEWAY'S\ OWN\ RESOURCES\ -\/\ REMOVED\ FOR\ SIMPLIFICATION}}
\DoxyCodeLine{00078\ \textcolor{comment}{/*}}
\DoxyCodeLine{00079\ \textcolor{comment}{void}}
\DoxyCodeLine{00080\ \textcolor{comment}{hnd\_elevator\_api\_request\_gw(coap\_resource\_t\ *resource,}}
\DoxyCodeLine{00081\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_session\_t\ *elevator\_session,}}
\DoxyCodeLine{00082\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_pdu\_t\ *elevator\_request\_pdu,}}
\DoxyCodeLine{00083\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_string\_t\ *query,}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_pdu\_t\ *response\_placeholder);}}
\DoxyCodeLine{00085\ \textcolor{comment}{}}
\DoxyCodeLine{00086\ \textcolor{comment}{void}}
\DoxyCodeLine{00087\ \textcolor{comment}{hnd\_cabin\_request\_from\_elevator\_gw(coap\_resource\_t\ *resource,}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_session\_t\ *elevator\_session,}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_pdu\_t\ *elevator\_request\_pdu,}}
\DoxyCodeLine{00090\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_string\_t\ *query,}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_pdu\_t\ *response\_placeholder);}}
\DoxyCodeLine{00092\ \textcolor{comment}{}}
\DoxyCodeLine{00093\ \textcolor{comment}{void}}
\DoxyCodeLine{00094\ \textcolor{comment}{hnd\_floor\_call\_from\_elevator\_gw(coap\_resource\_t\ *resource,}}
\DoxyCodeLine{00095\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_session\_t\ *elevator\_session,}}
\DoxyCodeLine{00096\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_pdu\_t\ *elevator\_request\_pdu,}}
\DoxyCodeLine{00097\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_string\_t\ *query,}}
\DoxyCodeLine{00098\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_pdu\_t\ *response\_placeholder);}}
\DoxyCodeLine{00099\ \textcolor{comment}{}}
\DoxyCodeLine{00100\ \textcolor{comment}{void}}
\DoxyCodeLine{00101\ \textcolor{comment}{hnd\_arrival\_notification\_from\_elevator\_gw(coap\_resource\_t\ *resource,}}
\DoxyCodeLine{00102\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_session\_t\ *elevator\_session,}}
\DoxyCodeLine{00103\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_pdu\_t\ *elevator\_request\_pdu,}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ coap\_string\_t\ *query,}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coap\_pdu\_t\ *response\_placeholder);}}
\DoxyCodeLine{00106\ \textcolor{comment}{*/}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ API\_GATEWAY\_API\_HANDLERS\_H\ }}

\end{DoxyCode}

\subsection{topics}
\doxysection{Topics}
Here is a list of all topics with brief descriptions\+:\begin{DoxyCompactList}
\item \contentsline{section}{Configuración de Escucha del Gateway}{\pageref{group__gateway__listen}}{}
\item \contentsline{section}{Configuración del Servidor Central}{\pageref{group__central__server}}{}
\item \contentsline{section}{Recursos Co\+AP}{\pageref{group__coap__resources}}{}
\item \contentsline{section}{Configuraciones de Timeout}{\pageref{group__coap__timeouts}}{}
\item \contentsline{section}{Códigos de Color ANSI para Gateway}{\pageref{group__ansi__colors__gw}}{}
\item \contentsline{section}{Macros de Logging del Gateway}{\pageref{group__logging__macros__gw}}{}
\item \contentsline{section}{Estructuras de Datos de Simulación}{\pageref{group__simulation__data}}{}
\item \contentsline{section}{Funciones de Simulación}{\pageref{group__simulation__functions}}{}
\end{DoxyCompactList}


\section{Descripción del API Gateway}

\subsection{Arquitectura}
El API Gateway implementa un sistema CoAP con DTLS-PSK que:

\begin{itemize}
    \item Actúa como puente entre controladores CAN y servidor central
    \item Gestiona estado local de ascensores del edificio
    \item Convierte mensajes CAN a solicitudes CoAP
    \item Implementa simulación de movimiento de ascensores
    \item Mantiene sesiones DTLS con servidor central
\end{itemize}

\subsection{Funcionalidades Principales}
\begin{itemize}
    \item \textbf{Puente CAN-CoAP}: Transformación de protocolos
    \item \textbf{Gestión de Estado}: Estado local de ascensores
    \item \textbf{Simulación}: Movimiento automático de ascensores
    \item \textbf{Comunicación Segura}: DTLS-PSK con servidor central
    \item \textbf{Logging}: Sistema de registro detallado
    \item \textbf{Manejo de Señales}: Terminación elegante
\end{itemize}

\subsection{Endpoints CoAP}
\begin{itemize}
    \item \texttt{POST /peticion\_piso}: Solicitudes de llamada de piso
    \item \texttt{POST /peticion\_cabina}: Solicitudes de cabina
\end{itemize}

\subsection{Seguridad}
\begin{itemize}
    \item Autenticación DTLS-PSK mutua
    \item Claves determinísticas basadas en identidad
    \item Validación de patrones de identidad
    \item Cifrado de todas las comunicaciones
\end{itemize}

\subsection{Simulación}
El API Gateway incluye un sistema de simulación que:
\begin{itemize}
    \item Simula movimiento automático de ascensores
    \item Actualiza posiciones y estados
    \item Genera eventos de llegada a pisos
    \item Mantiene sincronización con estado real
\end{itemize}

\end{document}
